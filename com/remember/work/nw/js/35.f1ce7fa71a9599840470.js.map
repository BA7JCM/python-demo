{"version":3,"file":"static/js/35.f1ce7fa71a9599840470.js","sources":["webpack:///src/components/overview/operators16List.vue"],"sourcesContent":["<template>\r\n\t<div class=\"operators-16-list\" v-loading=\"loading\" element-loading-spinner=\"iconfont icon-loading1\" element-loading-background=\"rgba(0, 0, 0, 0.2)\">\r\n\t\t<div class=\"top-cell\" v-show=\"!loading\">\r\n\t\t\t<div class=\"total\">\r\n\t\t\t\t<span>入网经营主体总数：</span\r\n\t\t\t\t><span\r\n\t\t\t\t\t><i>{{ operatorsTotal }}</i\r\n\t\t\t\t\t>家</span\r\n\t\t\t\t>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"legend\">\r\n\t\t\t\t<div v-for=\"legend in legendList\" :key=\"legend.category\" :class=\"{marginMore: legendList.length <= 4}\" class=\"legend-item\">\r\n\t\t\t\t\t<span :style=\"{backgroundColor: legend.color}\"></span>\r\n\t\t\t\t\t<span>{{ legend.category === '经作' ? legend.category + '/果园' : legend.category }}：</span>\r\n\t\t\t\t\t<span :style=\"{color: legend.color}\">{{ legend.count }}家</span>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div v-show=\"!loading\" class=\"echart-container\" ref=\"EContainer\"></div>\r\n\t</div>\r\n</template>\r\n<script>\r\nimport {areaLevelCorAreaId} from '@/common/fn';\r\nimport {areaData, areaMap} from '@/common/config/filterArea.js';\r\nconst labelOption = {\r\n\tshow: false,\r\n\tposition: 'insideBottom',\r\n\tdistance: 15,\r\n\talign: 'left',\r\n\tverticalAlign: 'middle',\r\n\trotate: 90,\r\n\tformatter: '{c} 家',\r\n\tfontSize: 14,\r\n\tcolor: '#ffffff',\r\n\trich: {\r\n\t\tname: {\r\n\t\t\ttextBorderColor: '#fff',\r\n\t\t},\r\n\t},\r\n};\r\n\r\nconst chartOption = {\r\n\tgrid: {\r\n\t\tshow: false,\r\n\t\ttop: 25,\r\n\t\tleft: '4%',\r\n\t\tright: '3%',\r\n\t\tbottom: 85,\r\n\t},\r\n\ttooltip: {\r\n\t\ttrigger: 'axis',\r\n\t\tbackgroundColor: '#020A10',\r\n\t\tpadding: [12, 20, 12, 20],\r\n\t\ttextStyle: {\r\n\t\t\tcolor: '#ecfeff',\r\n\t\t\tfontSize: 12,\r\n\t\t},\r\n\t\taxisPointer: {\r\n\t\t\ttype: 'shadow',\r\n\t\t\tshadowStyle: {\r\n\t\t\t\tcolor: 'rgba(0,0,0,0.3)',\r\n\t\t\t},\r\n\t\t},\r\n\t\tformatter: function (e) {\r\n\t\t\tconst areaName = e[0].axisValue;\r\n\t\t\tconst arr = e.map(item => {\r\n\t\t\t\tif (item.value !== '') {\r\n\t\t\t\t\treturn `${item.seriesName === '经作' ? item.seriesName + '/果园' : item.seriesName}：${item.value}家<br>`;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn '';\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn `<span style=\"font-weight: bold;\">${areaName}</span>` + '<br>' + arr.join('');\r\n\t\t},\r\n\t},\r\n\txAxis: [\r\n\t\t{\r\n\t\t\ttype: 'category',\r\n\t\t\taxisTick: {show: false},\r\n\t\t\taxisLine: {\r\n\t\t\t\tlineStyle: {\r\n\t\t\t\t\tcolor: 'rgba(50, 206, 187, 0.15)',\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\taxisLabel: {\r\n\t\t\t\tcolor: '#6DC1CB',\r\n\t\t\t\tfontSize: 14,\r\n\t\t\t\tinterval: 0,\r\n\t\t\t\tformatter: function (e) {\r\n\t\t\t\t\treturn e;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tdata: [],\r\n\t\t},\r\n\t],\r\n\tyAxis: [\r\n\t\t{\r\n\t\t\ttype: 'value',\r\n\t\t\taxisLine: {\r\n\t\t\t\tshow: false,\r\n\t\t\t},\r\n\t\t\taxisLabel: {\r\n\t\t\t\tcolor: '#6DC1CB',\r\n\t\t\t\tfontSize: 14,\r\n\t\t\t\tfontWeight: 400,\r\n\t\t\t},\r\n\t\t\tsplitLine: {\r\n\t\t\t\tlineStyle: {\r\n\t\t\t\t\tcolor: 'rgba(50, 206, 187, 0.15)',\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t],\r\n\tseries: [],\r\n};\r\nexport default {\r\n\tprops: {\r\n\t\tfarmAreaInfo: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault() {\r\n\t\t\t\treturn areaLevelCorAreaId();\r\n\t\t\t},\r\n\t\t},\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tchartInstance: null,\r\n\t\t\toperatorsTotal: 0,\r\n\t\t\tloading: false,\r\n\t\t\tlegendList: [],\r\n\t\t};\r\n\t},\r\n\tmounted() {\r\n\t\tthis.$nextTick(() => {\r\n\t\t\tthis.initMoudle();\r\n\t\t});\r\n\t\t// 适配图表l字体大小\r\n\t\twindow.addEventListener('resize', this.adaptationChart);\r\n\t\tthis.$once('hook:beforeDestroy', function () {\r\n\t\t\twindow.removeEventListener('resize', this.adaptationChart);\r\n\t\t});\r\n\t},\r\n\tmethods: {\r\n\t\tasync initMoudle() {\r\n\t\t\tthis.loading = true;\r\n\t\t\tthis.chartInstance = this._initEcharts(this.eContainerRef, chartOption);\r\n\t\t\tconst result = await this.getDataList();\r\n\t\t\tif (!result) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tconst {categoryList, businessEntityByAreaList, sumSnBusinessEntityCount} = result;\r\n\t\t\t// 过滤legend数据\r\n\t\t\tcategoryList.forEach(item => {\r\n\t\t\t\tif (item.count) {\r\n\t\t\t\t\tthis.legendList.push(item);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis.operatorsTotal = sumSnBusinessEntityCount;\r\n\t\t\tthis.refreshChart(this.chartInstance, businessEntityByAreaList, this.legendList);\r\n\t\t\tthis.loading = false;\r\n\t\t},\r\n\t\tasync refreshChart(chartInstance, list, legendList) {\r\n\t\t\t// 注意：始终以 sortNum 这个唯一标识来处理数据\r\n\r\n\t\t\tlet xAxisData = [];\r\n\t\t\tconst sortNumObj = {};\r\n\t\t\tlegendList.forEach(legend => {\r\n\t\t\t\tsortNumObj['sortNum' + legend.sortNum] = {name: '', type: 'bar', barGap: 0, itemStyle: {color: '#000'}, label: labelOption, data: []};\r\n\t\t\t});\r\n\t\t\tconst seriesTotalList = []; // 每个区的总数列表\r\n\t\t\tfunction formatData(obj, key) {\r\n\t\t\t\tif (obj[key]) {\r\n\t\t\t\t\tsortNumObj['sortNum' + key]['name'] = obj[key]['selectName'];\r\n\t\t\t\t\tsortNumObj['sortNum' + key]['itemStyle']['color'] = obj[key]['color'];\r\n\t\t\t\t\tsortNumObj['sortNum' + key]['data'].push(obj[key]['snBusinessCount'] || '');\r\n\t\t\t\t} else if (!obj[key]) {\r\n\t\t\t\t\tsortNumObj['sortNum' + key]['data'].push('');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlist.forEach(item => {\r\n\t\t\t\tif (item.areaId !== '310100') {\r\n\t\t\t\t\txAxisData.push(areaMap[item.areaId]);\r\n\t\t\t\t\tseriesTotalList.push(item.sumBusinessEntityByArea || 0);\r\n\t\t\t\t\tconst obj = {};\r\n\t\t\t\t\titem.detailList.forEach(innerItem => {\r\n\t\t\t\t\t\tobj[innerItem.sortNum] = innerItem;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tlegendList.forEach(legend => {\r\n\t\t\t\t\t\tformatData(obj, legend.sortNum);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tconst seriesData = [];\r\n\t\t\tfor (let k in sortNumObj) {\r\n\t\t\t\tlet idx = parseInt(k.slice(-1)) - 1;\r\n\t\t\t\tseriesData[idx] = sortNumObj[k];\r\n\t\t\t}\r\n\t\t\tconst chartOpts = {\r\n\t\t\t\txAxis: {\r\n\t\t\t\t\tdata: xAxisData,\r\n\t\t\t\t\taxisLabel: {\r\n\t\t\t\t\t\tformatter: function (value, idx) {\r\n\t\t\t\t\t\t\treturn `{t|${value}}` + '\\n' + `{s|}` + '\\n' + `{b|${seriesTotalList[idx]}家}`;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\trich: {\r\n\t\t\t\t\t\t\tt: {\r\n\t\t\t\t\t\t\t\tcolor: '#ecfeff',\r\n\t\t\t\t\t\t\t\tfontSize: 14,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\ts: {\r\n\t\t\t\t\t\t\t\theight: 5,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tb: {\r\n\t\t\t\t\t\t\t\tcolor: '#FEEB48',\r\n\t\t\t\t\t\t\t\tfontSize: 16,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tseries: seriesData,\r\n\t\t\t};\r\n\t\t\tchartInstance.setOption(chartOpts);\r\n\t\t\tthis.adaptationChart();\r\n\t\t},\r\n\t\t// 获取数据\r\n\t\tgetDataList() {\r\n\t\t\tlet ids = areaData.map(item => item.id);\r\n\t\t\treturn this.$ajax\r\n\t\t\t\t.post(this.$api.overview.getStatisticsSnBusinessEntity, {\r\n\t\t\t\t\tfarmAreaId: ids,\r\n\t\t\t\t\tfarmAreaType: this.farmAreaInfo.farmAreaType,\r\n\t\t\t\t})\r\n\t\t\t\t.then(({data}) => {\r\n\t\t\t\t\tif (data.respCode === 0) {\r\n\t\t\t\t\t\treturn data.obj;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.catch(e => {\r\n\t\t\t\t\tconsole.log('operators16List error: ', e);\r\n\t\t\t\t});\r\n\t\t},\r\n\t\t_initEcharts(el, option) {\r\n\t\t\tconst chart = this.$echarts.init(el);\r\n\t\t\tchart.setOption(option);\r\n\t\t\treturn chart;\r\n\t\t},\r\n\t\trefreshRender() {\r\n\t\t\tif (this.chartInstance) {\r\n\t\t\t\tthis.chartInstance.resize();\r\n\t\t\t\tthis.adaptationChart();\r\n\t\t\t}\r\n\t\t},\r\n\t\tadaptationChart() {\r\n\t\t\tconst htmlWidth = document.documentElement.clientWidth || document.body.clientWidth;\r\n\t\t\tlet opts = {\r\n\t\t\t\ttooltip: {\r\n\t\t\t\t\ttextStyle: {\r\n\t\t\t\t\t\tfontSize: 12,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\txAxis: {\r\n\t\t\t\t\taxisLabel: {\r\n\t\t\t\t\t\trich: {\r\n\t\t\t\t\t\t\tt: {\r\n\t\t\t\t\t\t\t\tfontSize: 14,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tb: {\r\n\t\t\t\t\t\t\t\tfontSize: 16,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t};\r\n\t\t\tif (htmlWidth > 3000) {\r\n\t\t\t\topts = {\r\n\t\t\t\t\ttooltip: {\r\n\t\t\t\t\t\ttextStyle: {\r\n\t\t\t\t\t\t\tfontSize: 16,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\txAxis: {\r\n\t\t\t\t\t\taxisLabel: {\r\n\t\t\t\t\t\t\trich: {\r\n\t\t\t\t\t\t\t\tt: {\r\n\t\t\t\t\t\t\t\t\tfontSize: 16,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tb: {\r\n\t\t\t\t\t\t\t\t\tfontSize: 18,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t};\r\n\t\t\t\tif (this.chartInstance) {\r\n\t\t\t\t\tthis.chartInstance.setOption(opts);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\topts = {\r\n\t\t\t\t\ttooltip: {\r\n\t\t\t\t\t\ttextStyle: {\r\n\t\t\t\t\t\t\tfontSize: 12,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\txAxis: {\r\n\t\t\t\t\t\taxisLabel: {\r\n\t\t\t\t\t\t\trich: {\r\n\t\t\t\t\t\t\t\tt: {\r\n\t\t\t\t\t\t\t\t\tfontSize: 14,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tb: {\r\n\t\t\t\t\t\t\t\t\tfontSize: 16,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t};\r\n\t\t\t\tif (this.chartInstance) {\r\n\t\t\t\t\tthis.chartInstance.setOption(opts);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t},\r\n\tcomputed: {\r\n\t\teContainerRef() {\r\n\t\t\treturn this.$refs.EContainer;\r\n\t\t},\r\n\t},\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.operators-16-list {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\t.top-cell {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tmargin-top: 20px;\r\n\t\t.total {\r\n\t\t\tspan:first-child {\r\n\t\t\t\tfont-size: 14px;\r\n\t\t\t\tfont-weight: bold;\r\n\t\t\t\tcolor: #ecfeff;\r\n\t\t\t}\r\n\t\t\tspan:last-child {\r\n\t\t\t\tfont-size: 16px;\r\n\t\t\t\tcolor: #feeb48;\r\n\t\t\t\ti {\r\n\t\t\t\t\tfont-weight: bold;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t.legend {\r\n\t\t\tflex: 1;\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: flex-end;\r\n\t\t\talign-items: center;\r\n\t\t\tpadding: 0 10px;\r\n\t\t\t.legend-item {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\t// padding: 5px 0 10px 0;\r\n\t\t\t\tfont-size: 14px;\r\n\t\t\t\tcolor: #ecfeff;\r\n\t\t\t\tmargin-right: 20px;\r\n\t\t\t\t&.marginMore {\r\n\t\t\t\t\tmargin: 0 20px 0 10px;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tspan:first-child {\r\n\t\t\t\t\tdisplay: inline-block;\r\n\t\t\t\t\twidth: 6px;\r\n\t\t\t\t\theight: 6px;\r\n\t\t\t\t\tmargin-right: 5px;\r\n\t\t\t\t\tborder-radius: 50%;\r\n\t\t\t\t}\r\n\t\t\t\tspan:last-child {\r\n\t\t\t\t\tfont-weight: bold;\r\n\t\t\t\t\tcolor: #f6a82b;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t.echart-container {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t}\r\n}\r\n/deep/ .el-loading-spinner {\r\n\toverflow: hidden;\r\n\t.iconfont {\r\n\t\tdisplay: block;\r\n\t\tfont-size: 40px;\r\n\t\tcolor: #00f6ff;\r\n\t\tanimation: loading 1.25s linear infinite;\r\n\t\tmargin-top: 24px;\r\n\t\tmargin-left: 8px;\r\n\t}\r\n}\r\n\r\n/* 32:9超宽屏幕适配 */\r\n@media screen and (min-width: 3000px) {\r\n\t.operators-16-list .top-cell .legend .legend-item {\r\n\t\tfont-size: 16px;\r\n\t}\r\n\t.operators-16-list .top-cell .total span {\r\n\t\tfont-size: 16px;\r\n\t}\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/overview/operators16List.vue"],"mappings":"AAwBA","sourceRoot":""}