webpackJsonp([74],{XR6P:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("VCTt"),i=a("VKKs"),o=a("+Yef");function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function n(i,o){try{var r=e[i](o),s=r.value}catch(t){return void a(t)}if(!r.done)return Promise.resolve(s).then(function(t){n("next",t)},function(t){n("throw",t)});t(s)}("next")})}}var s={data:function(){return{areaid:"",map:null,allpolygon:[],bigpolygon:null,imageOverlay:null,mapId:"暂无遥感",mapType:0,tulistr:"",updatetime:void 0,polygonready:!1,pointLat:void 0,pointLng:void 0,gisName:"",mapZoom:13}},props:["gisdata","gisget"],mounted:function(){var t=this;this.setAreaId(),this.$nextTick(r(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(i.b)("landSource_mapId"),e.next=3,t._initMap("mapcon");case 3:0!==t.gisdata.length&&(t.mapId=t.gisdata.some(function(t){return t.id===a})?a:t.gisdata[0].id,t.selectChange(t.mapId));case 4:case"end":return e.stop()}},e,t)})))},methods:{_initMap:function(t){var e=this;return r(regeneratorRuntime.mark(function a(){var i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(n.g)({areaId:o.a[e.areaid]||e.areaid,child:!1});case 2:i=a.sent,e.map=L.map(t,{center:[0,0],zoom:9,zoomSnap:.1,layers:[],zoomControl:!1,attributionControl:!1,dragging:!1,touchZoom:!1,scrollWheelZoom:!1,doubleClickZoom:!1,boxZoom:!1,tap:!1,keyboard:!1,maxZoom:21,minZoom:5}).on("click",function(t){var a=t.latlng;e.$router.push({path:"/home/plotlist",query:{lat:e.pointLat||a.lat,lng:e.pointLng||a.lng,mapId:e.mapId,mapType:e.mapType,mapZoom:e.mapZoom}})}).on("resize",function(){e.drawProvinceFn()}),e.drawPolygon(i.features),e.drawProvinceFn();case 6:case"end":return a.stop()}},a,e)}))()},drawPolygon:function(t){var e=this;t.forEach(function(t,a){e.allpolygon[a]=L.geoJSON(t,{style:function(){return{color:"#6fcbdf",fillColor:"#009cba",fillOpacity:.6,fillRule:"evenodd",className:"polygonbox",lineJoin:"miter",weight:1}}}).addTo(e.map)})},drawProvinceFn:function(){var t,e,n=[];this.allpolygon.forEach(function(t){var e=t.getBounds();n.push([e._southWest.lat,e._southWest.lng]),n.push([e._northEast.lat,e._northEast.lng])}),this.bigpolygon=L.polygon(n,{}).getBounds(),t=this.map.getBoundsZoom(this.bigpolygon),e=this.bigpolygon.getCenter(),this.map.setView(e,t),"130529"===this.areaid&&L.imageOverlay(a("s8Nf"),this.bigpolygon,{interactive:!0,zIndex:998}).addTo(this.map)},addRemoteImg:function(t){t?(this.togglePolygon(!1),this.imageOverlay?this.imageOverlay.setUrl(t):(this.imageOverlay=L.imageOverlay(t,this.bigpolygon,{interactive:!0,zIndex:999}),this.imageOverlay.addTo(this.map))):(this.togglePolygon(!0),this.imageOverlay.setUrl(""))},togglePolygon:function(t){this.allpolygon.forEach(function(e){e.setStyle({weight:t?1:0,fillOpacity:t?.3:0})})},setAreaId:function(){var t=Object(i.b)("govGovernmentSubjectVO");if(!t)return this.$router.replace({path:"/login"});switch(t.subjectLevel){case 1:this.areaid=t.provinceId;break;case 2:this.areaid=t.cityId;break;default:this.areaid=t.countyId}},selectChange:function(t){var e=this.gisdata.filter(function(e){return e.id===t})[0];if(!e)return!1;Object(i.c)("landSource_mapId",t),this.gisName=e.gisName,this.mapType=e.mapType,this.mapZoom=e.zoom,this.pointLat=e.pointLat,this.pointLng=e.pointLng,this.tulistr=e.demoImgUrl,this.updatetime=e.dataUpdateTime,this.addRemoteImg(e.gisImgUrl)}},watch:{},computed:{}},l=a("W5g0");var c=function(t){a("ck7X")},u=Object(l.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mapcontain"},[a("el-select",{class:[t.gisdata.length?"":"noopts"],attrs:{placeholder:"",disabled:!(t.gisdata.length>0)},on:{change:t.selectChange},scopedSlots:t._u([{key:"prefix",fn:function(){return[a("div",{staticClass:"select-input"},[t._v(t._s(t.gisName))])]},proxy:!0}]),model:{value:t.mapId,callback:function(e){t.mapId=e},expression:"mapId"}},t._l(t.gisdata,function(t){return a("el-option",{key:t.id,attrs:{label:t.gisName,value:t.id}})}),1),t._v(" "),a("div",{attrs:{id:"mapcon"}}),t._v(" "),a("div",{staticClass:"tuli"},[a("img",{attrs:{src:t.tulistr,alt:""}})]),t._v(" "),t.updatetime?a("div",{staticClass:"updatetime"},[t._v("数据更新时间："+t._s(t._f("znDateFormat")(t.updatetime,"yyyy.MM.dd")))]):t._e()],1)},[],!1,c,"data-v-3e03fca4",null);e.default=u.exports},ck7X:function(t,e){},s8Nf:function(t,e){t.exports="https://snkoudai.oss-cn-hangzhou.aliyuncs.com/goverment/static/img/julu_weixing.d38e03e.png"}});
//# sourceMappingURL=74.fb147a0d2480aa62b483.js.map