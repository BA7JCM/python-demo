webpackJsonp([113],{"1do9":function(t,e){},"24oI":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r("VCTt"),n=r("cmJz"),i=r("c65A"),o=r("o2Qu"),s=r("FVyf"),c=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],a=!0,n=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(a=(o=s.next()).done)&&(r.push(o.value),!e||r.length!==e);a=!0);}catch(t){n=!0,i=t}finally{try{!a&&s.return&&s.return()}finally{if(n)throw i}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function l(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,r){return function a(n,i){try{var o=e[n](i),s=o.value}catch(t){return void r(t)}if(!o.done)return Promise.resolve(s).then(function(t){a("next",t)},function(t){a("throw",t)});t(s)}("next")})}}var m=["#F0C87B","#A6D889","#DD90CB","#9173FE","#4DCBFF","#1DE9B6","#ca8622","#bda29a","#6e7074","#546570","#c4ccd3"],u=["一月","二月","三月","四月","五月","六月"],f=[220,182,191,234,290,330],d=u.map(function(t,e){return{name:t,value:f[e],itemStyle:{color:m[e]}}}),p={tooltip:{show:!0,trigger:"item",textStyle:{fontSize:12,color:"#ffffff"}},title:{text:"近半年销售额",textStyle:{color:"#02E4EE",fontSize:16,fontWeight:"bold"},subtextStyle:{color:"#6DC1CB",fontSize:12,fontWeight:400},left:"center",padding:[17,0,0,0],itemGap:10,textVerticalAlign:"top"},grid:{show:!0,top:66,right:24,height:130,width:270,borderColor:"#0D394A"},color:m,xAxis:{data:u,scale:!0,axisLabel:{textStyle:{color:"#6DC1CB",fontSize:12},align:"center"},axisTick:{show:!1},axisLine:{show:!0,lineStyle:{color:"#0D394A"}},z:10},yAxis:{nameTextStyle:{fontSize:12,color:"#6DC1CB",padding:[0,0,0,0]},axisLine:{show:!1,lineStyle:{color:"#0D394A"}},axisTick:{show:!1},splitLine:{show:!0,lineStyle:{color:"#0D394A"}},axisLabel:{textStyle:{color:"#6DC1CB",fontSize:12}}},series:[{type:"bar",barWidth:24,data:d}]},h=function(){var t={},e=function(e,r){var a={};r.forEach(function(t){a[t.incomeDateStr]=t}),t[e]=a},r=!0,a=!1,n=void 0;try{for(var i,o=Object.entries(s.a)[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var l=i.value,m=c(l,2);e(m[0],m[1])}}catch(t){a=!0,n=t}finally{try{!r&&o.return&&o.return()}finally{if(a)throw n}}return t}(),y={name:"farmDetailsTabs",data:function(){return{sales:null,salesBar:Object(a.d)(p),yield:null,yieldBar:Object(a.d)(p),farmRecordList:[],estimateYield:null,estimateYieldBar:Object(a.d)(p),generateFarmIntro:{farmIntro:{},companyInfo:{},farmIncomeVOS:[],govPickVOList:[],businessCategoryList:[]},farmIntroContainer:null,farmRecordScroll:null,showCompanyIcon:!1,viewPics:[],showViews:!1,goodsSubjectUnit:null,estimateGoodsSubjectUnit:null,goodsSubjectList:[],estimateGoodsSubjectList:[],yieldSubject:"agri",estimateYieldSubject:"agri",estimateYieldSubjectModel:"agri",showEstimateYieldModel:!1,curDate:null}},props:["farminfo","farmId"],computed:{businessCategoryStr:function(){if(this.generateFarmIntro.businessCategoryList.length&&this.generateFarmIntro.farmIntro.businessCategoryIdList&&this.generateFarmIntro.farmIntro.businessCategoryIdList.length){var t=this.generateFarmIntro.farmIntro.businessCategoryIdList,e=[];return this.generateFarmIntro.businessCategoryList.map(function(r){t.includes(r.id)&&e.push(r.bizCategoryName)}),e.join("，")}return""}},created:function(){this.initData()},mounted:function(){var t=this;return l(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getCropSubject();case 2:t.$nextTick(l(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.farmIntroContainer=Object(a.a)(t.$refs.farmIntroContainer,{scrollX:!1,freeScroll:!1,click:!1}),t.farmRecordScroll=Object(a.a)(t.$refs.farmRecordScroll,{scrollX:!1,freeScroll:!1,click:!1});case 2:case"end":return e.stop()}},e,t)})));case 3:case"end":return e.stop()}},e,t)}))()},methods:{initData:function(){this.generateFarmIntro={farmIntro:this.farminfo.farmDetailVO,companyInfo:this.farminfo.companyVO||{},farmIncomeVOS:this.farminfo.farmIncomeVOS,govPickVOList:this.farminfo.govPickVOList,businessCategoryList:this.farminfo.businessCategoryList},this.checkAuthCount=this.farminfo.inspectVOS.length},checkSubjectChangeUnit:function(t){return{agri:!0,forestry:!1,animal:!1,fishery:!0}[t]},yieldXAxis:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy.MM",r=new Date(this.curDate).setDate(1),n=new Date(r).getMonth(),i=[],o=0;o<6;o++)i.push("add"===t?Object(a.c)(new Date(r).setMonth(n++),e):Object(a.c)(new Date(r).setMonth(--n),e));return i},getCropSubject:function(){var t=this;return l(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.$ajax.post(t.$api.public.farmCropSubject,{farmId:t.farmId}).then(function(e){var r=e.data;if(t.curDate=r.curDate,0===r.respCode)return t.goodsSubjectUnit={},0!==r.obj.list.length&&(t.goodsSubjectList=r.obj.list.map(function(e){return t.goodsSubjectUnit[e.cropSubjectIdentifier]="forestry"===e.cropSubjectIdentifier||"animal"===e.cropSubjectIdentifier?e.cropCategoryUnitAll:"吨",{name:e.cropSubjectNickname,id:e.cropSubjectIdentifier}}),t.yieldSubject=r.obj.list[0].cropSubjectIdentifier,!0)}));case 1:case"end":return e.stop()}},e,t)}))()},getEstimateCropSubject:function(){var t=this;return new Promise(function(e,r){t.$ajax.post(t.$api.public.getEstimateFarmCropSubject,{farmId:t.farmId}).then(function(t){var r=t.data;0===r.respCode&&e(r.obj)}).catch(function(t){console.log(t),r(t)})})},processEstimateCropSubject:function(){var t=this;return l(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getEstimateCropSubject();case 2:if(r=e.sent,t.estimateGoodsSubjectUnit={},0!==r.list.length){e.next=6;break}return e.abrupt("return",!1);case 6:t.estimateGoodsSubjectList=r.list.map(function(e){return t.estimateGoodsSubjectUnit[e.cropSubjectIdentifier]="forestry"===e.cropSubjectIdentifier||"animal"===e.cropSubjectIdentifier?e.cropCategoryUnitAll:"吨",{name:e.cropSubjectNickname,id:e.cropSubjectIdentifier}}),t.estimateYieldSubject=r.list[0].cropSubjectIdentifier;case 8:case"end":return e.stop()}},e,t)}))()},getOutput:function(t){return this.$ajax.post(this.$api.farmDetail.getOutputListByFarmId,{dateList:this.yieldXAxis("minus","yyyy-MM-dd").reverse(),farmId:this.farmId,subjectIdentifier:t}).then(function(t){var e=t.data;if(0===e.respCode)return e.obj})},getEstimateYieldEchartsData:function(){var t=this;return new Promise(function(e,r){t.$ajax.post(t.$api.farmDetail.getPickForecastMonthByFarmId,{farmId:t.$route.params.farmid,subjectIdentifier:t.estimateYieldSubject}).then(function(t){var r=t.data;0===r.respCode&&e(r.obj)}).catch(function(t){console.log(t),r(new Error(t))})})},loadSalesBar:function(){var t=h[this.generateFarmIntro.farmIntro.farmId];this.salesBar.title.text="近半年销售额",this.salesBar.title.subtext="单位：万元",this.salesBar.xAxis.data=this.generateFarmIntro.farmIncomeVOS.map(function(t){return Object(a.c)(t.incomeDate,"yyyy.MM")}),this.salesBar.xAxis.axisLabel.formatter=function(t){return t},this.salesBar.series[0].data=this.generateFarmIntro.farmIncomeVOS.map(function(e,r){return{name:Object(a.c)(e.incomeDate,"yyyy.MM"),value:t?t[e.incomeDateStr]?Object(a.j)({value:t[e.incomeDateStr].totalAmount/Math.pow(10,4)}):0:Object(a.j)({value:e.totalAmount/Math.pow(10,4)}),itemStyle:{color:m[r]}}}),this.salesBar.tooltip.formatter=function(t){return t.name+"<br/>"+Object(a.l)({value:t.value,unit:"元",base:1e4}).formatter},this.salesBar.yAxis.axisLabel.formatter=function(t){return Object(a.l)({value:t}).formatter},this.sales=this.$echarts.init(this.$refs.sales),this.sales.setOption(this.salesBar)},loadYieldBar:function(t){var e=this;return l(regeneratorRuntime.mark(function r(){var n,i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.goodsSubjectUnit[t]||"吨",r.next=3,e.getOutput(t);case 3:i=r.sent,e.yieldBar.title.text="近半年实际产量",e.yieldBar.xAxis.data=i.map(function(t){return Object(a.c)(t.pickTime,"yyyy.MM")}),e.yieldBar.yAxis.name="单位："+n,e.yieldBar.xAxis.axisLabel.formatter=function(t){return t},e.yieldBar.series[0].data=i.map(function(r,n){return{name:Object(a.c)(r.pickTime,"yyyy.MM"),value:Object(a.j)({value:e.checkSubjectChangeUnit(t)?r.sumPickOutput/Math.pow(10,3):r.sumPickOutput}),itemStyle:{color:m[n]}}}),e.yieldBar.yAxis.axisLabel.formatter=function(t){return Object(a.l)({value:t}).formatter},e.yieldBar.tooltip.formatter=function(t){return t.name+"<br/>"+Object(a.l)({value:t.value,unit:n}).formatter},e.yield=e.$echarts.init(e.$refs.yield),e.yield.setOption(e.yieldBar);case 13:case"end":return r.stop()}},r,e)}))()},loadEstimateYieldEchart:function(t){var e=this;return l(regeneratorRuntime.mark(function r(){var n,i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.getEstimateYieldEchartsData();case 2:n=r.sent,i=e.estimateGoodsSubjectUnit[t]||"吨",e.estimateYieldBar.title.text="未来预计产量",e.estimateYieldBar.xAxis.data=n.total.map(function(t){return Object(a.c)(new Date(t.pickMonthStr+"-01"),"yyyy.MM")}),e.estimateYieldBar.series[0].data=n.total.map(function(r,n){return{name:Object(a.c)(new Date(r.pickMonthStr+"-01"),"yyyy.MM"),value:Object(a.j)({value:e.checkSubjectChangeUnit(t)?r.sumTotal/Math.pow(10,3):r.sumTotal}),itemStyle:{color:m[n]}}}),e.estimateYieldBar.yAxis.name="单位："+i,e.estimateYieldBar.xAxis.axisLabel.formatter=function(t){return t},e.estimateYieldBar.yAxis.axisLabel.formatter=function(t){return Object(a.l)({value:t}).formatter},e.estimateYieldBar.tooltip.formatter=function(t){return t.name+"<br/>"+Object(a.l)({value:t.value,unit:i}).formatter},e.estimateYield=e.$echarts.init(e.$refs.estimateYield),e.estimateYield.setOption(e.estimateYieldBar),e.estimateYield.on("click",function(t){e.$emit("closeAllDialogEv"),setTimeout(function(){e.estimateYieldSubjectModel=e.estimateYieldSubject,e.showEstimateYieldModel=!0},200)});case 14:case"end":return r.stop()}},r,e)}))()},handleTabs:function(t){var e=this;this.$nextTick(function(){"input"===t.name&&e.farmRecordScroll.refresh()})},openViews:function(t){this.showViews=!0,this.viewPics=t}},components:{farmRecord:n.default,views:i.default,estimateYieldModel:o.default}},b=r("W5g0");var g=function(t){r("1do9")},v=Object(b.a)(y,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"tabs-container"},[r("div",{staticClass:"tabs-wrap"},[r("el-tabs",{attrs:{value:"farmIntro"},on:{"tab-click":t.handleTabs}},[r("el-tab-pane",{attrs:{label:"基地介绍",name:"farmIntro"}},[t.generateFarmIntro?r("div",{staticClass:"farm-intro"},[r("div",{ref:"farmIntroContainer",staticClass:"farm-intro-container"},[r("div",{staticClass:"farm-intro-wrap"},[r("p",{staticClass:"info-item"},[r("b",[t._v("基地简介：")]),t._v(t._s(t.generateFarmIntro.farmIntro.farmDesc))]),t._v(" "),t.businessCategoryStr?r("p",{staticClass:"info-item"},[r("b",[t._v("经营类目：")]),t._v(t._s(t.businessCategoryStr||""))]):t._e(),t._v(" "),r("p",{staticClass:"info-item"},[r("b",[t._v("经营主体：")]),t._v(t._s(t.generateFarmIntro.companyInfo.companyName))]),t._v(" "),r("p",{staticClass:"info-item"},[r("b",[t._v("主体类型：")]),t._v(t._s(t.generateFarmIntro.companyInfo&&t.generateFarmIntro.companyInfo.companyCategoryVO&&t.generateFarmIntro.companyInfo.companyCategoryVO.companyCategoryName)+"\n\t\t\t\t\t\t\t")]),t._v(" "),r("p",{staticClass:"info-item"},[r("b",[t._v("法人代表（负责人）：")]),t._v(t._s(t.generateFarmIntro.companyInfo.legalPerson))]),t._v(" "),r("p",{staticClass:"info-item"},[r("b",[t._v("联系方式：")]),t._v(t._s(t.generateFarmIntro.companyInfo.legalPersonPhone))]),t._v(" "),r("p",{staticClass:"info-item clearfix"},[r("span",[r("b",[t._v("主体唯一标识：")]),r("i",{staticStyle:{"font-style":"normal"}},[t._v(t._s(t.generateFarmIntro.companyInfo.enterpriseCreditCode))])])]),t._v(" "),t.generateFarmIntro.farmIntro.landRightStartDate||t.generateFarmIntro.farmIntro.landRightEndDate?r("p",{staticClass:"info-item clearfix"},[r("span",[r("b",[t._v("土地承包期限：")]),t._v(" "),t.generateFarmIntro.farmIntro.landRightStartDate?r("i",{staticStyle:{"font-style":"normal"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(t._f("dateFormat")(t.generateFarmIntro.farmIntro.landRightStartDate,"yyyy.MM.dd"))+"~"+t._s(t._f("dateFormat")(t.generateFarmIntro.farmIntro.landRightEndDate,"yyyy.MM.dd"))+"\n\t\t\t\t\t\t\t\t\t")]):t._e()]),t._v(" "),t.generateFarmIntro.farmIntro.landRightImgUrl?r("span",{staticClass:"icon-pic-wrap f-right",on:{click:function(e){t.showCompanyIcon=!0}}},[r("i",{staticClass:"iconfont icon-pic"})]):t._e()]):t._e(),t._v(" "),r("p",{staticClass:"info-item"},[r("b",[t._v("基地位置与规模：")]),t._v("基地位于"+t._s(t.generateFarmIntro.farmIntro.cityName)+t._s(t.generateFarmIntro.farmIntro.countyName)+t._s(t.generateFarmIntro.farmIntro.farmAddress)+"\n\t\t\t\t\t\t\t\t"),t.generateFarmIntro.farmIntro.farmAcre?r("span",[t._v("，占地"+t._s(t._f("toFloat")(t.generateFarmIntro.farmIntro.farmAcre))+t._s(t._f("areaUnit")(t.generateFarmIntro.farmIntro.farmAcreUnit))+"。")]):t._e()]),t._v(" "),r("div",{staticClass:"info-item"},[r("div",{staticClass:"head-item"},[r("b",[t._v("检测与认证")]),t._v(" "),t.checkAuthCount?r("i",[t._v("共"+t._s(t.checkAuthCount)+"份")]):r("i",[t._v("无")])]),t._v(" "),t.farminfo.inspectVOS.length?r("div",{staticClass:"content-item"},[r("ul",{staticClass:"content-lists"},t._l(t.farminfo.inspectVOS,function(e,a){return t.farminfo.inspectVOS.length?r("li",{key:a,staticClass:"list"},[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.reportName,placement:"top-start"}},[r("p",{staticClass:"list-name"},[t._v(t._s(e.reportName))])]),t._v(" "),r("span",{staticClass:"list-line"}),t._v(" "),r("p",{staticClass:"list-des",on:{click:function(r){return t.openViews(e.inspectReportImages)}}},[r("i",{staticClass:"iconfont icon-pic"}),t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.inspectReportImages.length)+"张\n\t\t\t\t\t\t\t\t\t\t\t")])],1):t._e()}),0)]):t._e()])])])]):t._e()]),t._v(" "),r("el-tab-pane",{attrs:{label:"农事操作",name:"input"}},[t.generateFarmIntro?r("div",{staticClass:"farmword-container"},[r("div",{ref:"farmRecordScroll",staticClass:"farmword-wrap"},[r("farm-record",{attrs:{companyId:t.farminfo.companyVO.id,farmId:t.farmId}})],1)]):t._e()])],1)],1),t._v(" "),t.showCompanyIcon?r("views",{attrs:{pics:[t.generateFarmIntro.farmIntro.landRightImgUrl||""]},on:{viewerListen:function(e){t.showCompanyIcon=!1}}}):t._e(),t._v(" "),t.showViews?r("views",{attrs:{pics:t.viewPics},on:{viewerListen:function(e){t.showViews=!1}}}):t._e(),t._v(" "),t.showEstimateYieldModel?r("estimate-yield-model",{attrs:{"show-model":t.showEstimateYieldModel,"goods-subject-unit":t.estimateGoodsSubjectUnit,"estimate-yield-subject-model":t.estimateYieldSubjectModel,"goods-subject-list-model":t.estimateGoodsSubjectList},on:{"update:showModel":function(e){t.showEstimateYieldModel=e},"update:show-model":function(e){t.showEstimateYieldModel=e}}}):t._e()],1)},[],!1,g,"data-v-58bda36a",null);e.default=v.exports}});
//# sourceMappingURL=113.b84d91809d4e74e45d25.js.map