{"version":3,"file":"static/js/133.9d0c17b8f7fa0a584ee1.js","sources":["webpack:///src/pages/demo/gis.vue"],"sourcesContent":["<template>\r\n\t<div>\r\n\t\t<div class=\"gis-mapcontainer\" v-title data-title=\"土地资源监管\">\r\n\t\t\t<div id=\"gismap\"></div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n<script>\r\nimport esriLoader from 'esri-loader';\r\nimport GoogleAnnoLayer from './GoogleAnnoLayer';\r\nimport GoogleImageLayer from './GoogleImageLayer';\r\nimport GoogleMapLayer from './GoogleMapLayer';\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tgismap: null,\r\n\t\t\toptions: {url: 'http://gov.snkoudai.com/mapdemo/arcgis3.28/init.js'},\r\n\t\t};\r\n\t},\r\n\tasync mounted() {\r\n\t\t// 动态获取gis服务token\r\n\t\tthis.$nextTick(async () => {\r\n\t\t\twindow.map = this.gismap = await this.init();\r\n\t\t\tdojo.connect(this.gismap, 'onExtentChange', showExtent);\r\n\t\t\tfunction showExtent(extent) {\r\n\t\t\t\tconsole.log(extent.xmin + ',' + extent.ymin + ',' + extent.xmax + ',' + extent.ymax);\r\n\t\t\t}\r\n\t\t\tawait this.initServerLayer(this.gismap);\r\n\t\t});\r\n\t},\r\n\tmethods: {\r\n\t\tasync init() {\r\n\t\t\treturn new Promise(resolve => {\r\n\t\t\t\tesriLoader.loadModules(['esri/map', 'esri/SpatialReference', 'esri/geometry/Extent'], this.options).then(\r\n\t\t\t\t\tasync ([Map, SpatialReference, Extent]) => {\r\n\t\t\t\t\t\tvar map = new Map('gismap', {\r\n\t\t\t\t\t\t\textent: new Extent(...[120.13760521303203, 30.851050770703004, 122.74617149721172, 31.436759388867067], new esri.SpatialReference({wkid: 4326})),\r\n\t\t\t\t\t\t\tlogo: false,\r\n\t\t\t\t\t\t\toptimizePanAnimation: true,\r\n\t\t\t\t\t\t\tforce3DTransforms: false,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar googleMapLayer = new (await GoogleMapLayer())();\r\n\t\t\t\t\t\tmap.addLayer(googleMapLayer);\r\n\t\t\t\t\t\tvar googleImageLayer = new (await GoogleImageLayer())();\r\n\t\t\t\t\t\tmap.addLayer(googleImageLayer);\r\n\t\t\t\t\t\tvar googleAnnoLayer = new (await GoogleAnnoLayer())();\r\n\t\t\t\t\t\tmap.addLayer(googleAnnoLayer);\r\n\t\t\t\t\t\tresolve(map);\r\n\t\t\t\t\t},\r\n\t\t\t\t\treason => {\r\n\t\t\t\t\t\tresolve(false);\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t},\r\n\t\tinitServerLayer(map) {\r\n\t\t\treturn new Promise(resolve => {\r\n\t\t\t\tesriLoader.loadModules(['esri/layers/ArcGISDynamicMapServiceLayer', 'esri/SpatialReference'], this.options).then(\r\n\t\t\t\t\t([ArcGISDynamicMapServiceLayer, SpatialReference]) => {\r\n\t\t\t\t\t\tvar serverLayer = new esri.layers.ArcGISDynamicMapServiceLayer('http://202.111.178.10:34785/arcgis/rest/services/changchunshi/changchunshi2020dapeng/MapServer', {\r\n\t\t\t\t\t\t\tid: 'changchun',\r\n\t\t\t\t\t\t\toutFields: ['*'],\r\n\t\t\t\t\t\t\tspatialReference: new esri.SpatialReference({wkid: 4326}),\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tmap.addLayer(serverLayer);\r\n\t\t\t\t\t\tresolve();\r\n\t\t\t\t\t},\r\n\t\t\t\t\treason => {}\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t},\r\n\t},\r\n\tcomponents: {},\r\n};\r\n</script>\r\n<style scoped lang=\"scss\">\r\n@import url('http://gov.snkoudai.com/mapdemo/arcgis3.28/esri/css/esri.css');\r\n@import '~styles/gismap/esri-comon';\r\n#gismap {\r\n\twidth: 100vw;\r\n\theight: 100vh;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/pages/demo/gis.vue"],"mappings":"AAYA","sourceRoot":""}