{"version":3,"file":"static/js/65.b2dbe9c51d32dec01c71.js","sources":["webpack:///src/pages/login.vue"],"sourcesContent":["<template>\r\n\t<div class=\"login-page\" @keyup.13=\"checkLoginForm('loginForm')\" v-title data-title=\"登录\" :style=\"{background: `#020b1d url(${bg}) no-repeat bottom`}\">\r\n\t\t<effect-background></effect-background>\r\n\t\t<div class=\"login-box\">\r\n\t\t\t<p class=\"login-describe\">数据来源于真实的农业生产过程</p>\r\n\t\t\t<el-form ref=\"loginForm\" :model=\"loginForm\">\r\n\t\t\t\t<input type=\"text\" autocomplete=\"off\" style=\"position: absolute; top: -999px\" />\r\n\t\t\t\t<input type=\"password\" autocomplete=\"off\" style=\"position: absolute; top: -999px\" />\r\n\t\t\t\t<el-form-item prop=\"loginName\" :rules=\"loginNameRule\">\r\n\t\t\t\t\t<el-input\r\n\t\t\t\t\t\t:class=\"{focus: loginForm.loginFocus}\"\r\n\t\t\t\t\t\tv-model=\"loginForm.loginName\"\r\n\t\t\t\t\t\tautocomplete=\"off\"\r\n\t\t\t\t\t\tplaceholder=\"账号\"\r\n\t\t\t\t\t\t@focus=\"loginForm.loginFocus = true\"\r\n\t\t\t\t\t\t@blur=\"loginForm.loginFocus = false\"\r\n\t\t\t\t\t\t@input=\"forceChange($event)\"\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<i class=\"iconfont icon-zhanghu\" slot=\"prefix\"></i>\r\n\t\t\t\t\t</el-input>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item prop=\"password\" :rules=\"passwordRule\">\r\n\t\t\t\t\t<el-input\r\n\t\t\t\t\t\t:class=\"{focus: loginForm.passwordFocus}\"\r\n\t\t\t\t\t\tv-model=\"loginForm.password\"\r\n\t\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\t\tplaceholder=\"密码\"\r\n\t\t\t\t\t\t@focus=\"loginForm.passwordFocus = true\"\r\n\t\t\t\t\t\t@blur=\"loginForm.passwordFocus = false\"\r\n\t\t\t\t\t\t@input=\"forceChange($event)\"\r\n\t\t\t\t\t\tautocomplete=\"off\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<i class=\"iconfont icon-password\" slot=\"prefix\"></i>\r\n\t\t\t\t\t</el-input>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item>\r\n\t\t\t\t\t<el-button native-type=\"button\" @click=\"checkLoginForm('loginForm')\">登&emsp;录 </el-button>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t</el-form>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n<script>\r\nimport _bg from '@/assets/images/login/_login-bg.jpg';\r\nimport bg from '@/assets/images/login/login-bg-b.jpg';\r\nimport {getStorage, setStorage} from '@/utils/storage';\r\nimport effectBackground from '@/components/common/effect-background.vue';\r\nexport default {\r\n\tname: 'login',\r\n\tdata() {\r\n\t\tconst checkLoginName = (rule, value, callback) => {\r\n\t\t\tconst WEAK_LOGIN_REG = /^(?:[\\da-zA-Z!@#$%^&*]{1,10000})$/; // 弱：纯数字，纯字母，纯特殊字符\r\n\t\t\tif (!WEAK_LOGIN_REG.test(value)) {\r\n\t\t\t\treturn callback(new Error('请输入正确的账号'));\r\n\t\t\t}\r\n\t\t\treturn callback();\r\n\t\t};\r\n\t\tconst checkPassword = (rule, value, callback) => {\r\n\t\t\tconst WEAK_PWD_REG = /^(?:[\\da-zA-Z!@#$%^&*]{1,10000})$/; // 弱：纯数字，纯字母，纯特殊字符\r\n\t\t\t// const MEDIUM_PWD_REG = /^(?![a-zA-z]+$)(?!\\d+$)(?![!@#$%^&*]+$)[a-zA-Z\\d!@#$%^&*]+$/; // 中：字母+数字，字母+特殊字符，数字+特殊字符\r\n\t\t\t// const STRONG_PWD_REG = /^(?![a-zA-z]+$)(?!\\d+$)(?![!@#$%^&*]+$)(?![a-zA-z\\d]+$)(?![a-zA-z!@#$%^&*]+$)(?![\\d!@#$%^&*]+$)[a-zA-Z\\d!@#$%^&*]+$/; // 强：字母+数字+特殊字符\r\n\r\n\t\t\tif (!WEAK_PWD_REG.test(value)) {\r\n\t\t\t\treturn callback(new Error('密码格式不正确'));\r\n\t\t\t}\r\n\t\t\treturn callback();\r\n\t\t};\r\n\t\treturn {\r\n\t\t\tloginForm: {\r\n\t\t\t\tloginName: null,\r\n\t\t\t\tpassword: null,\r\n\t\t\t\tloginFocus: false,\r\n\t\t\t\tpasswordFocus: false,\r\n\t\t\t},\r\n\t\t\tloginNameRule: [\r\n\t\t\t\t{required: true, message: '请输入账号', trigger: 'blur'},\r\n\t\t\t\t{validator: checkLoginName, trigger: 'blur,change'},\r\n\t\t\t],\r\n\t\t\tpasswordRule: [\r\n\t\t\t\t{required: true, message: '请输入密码', trigger: 'blur'},\r\n\t\t\t\t{validator: checkPassword, trigger: 'blur,change'},\r\n\t\t\t],\r\n\t\t\tbg: _bg,\r\n\t\t};\r\n\t},\r\n\tcreated() {\r\n\t\tthis.checkLogin();\r\n\t},\r\n\tmounted() {\r\n\t\tthis.$nextTick(() => {\r\n\t\t\tif (!this.$refs.bgPic) return false;\r\n\t\t\tthis.$refs.bgPic.onload = () => {\r\n\t\t\t\tthis.bg = bg;\r\n\t\t\t};\r\n\t\t});\r\n\t},\r\n\tmethods: {\r\n\t\t/**\r\n\t\t * 验证是否登录\r\n\t\t */\r\n\t\tcheckLogin() {\r\n\t\t\tif (getStorage('accessToken')) {\r\n\t\t\t\tthis.$router.push({\r\n\t\t\t\t\tname: 'home',\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * 检查登录表单\r\n\t\t * @param formName\r\n\t\t */\r\n\t\tasync checkLoginForm(formName) {\r\n\t\t\tthis.$refs[formName].validate(async valid => {\r\n\t\t\t\tif (valid) {\r\n\t\t\t\t\tawait this.doLogin();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * 登录\r\n\t\t */\r\n\t\tasync doLogin() {\r\n\t\t\tawait new Promise((resolve, reject) => {\r\n\t\t\t\tthis.$ajax\r\n\t\t\t\t\t.post(this.$api.login.login, this.loginForm, {})\r\n\t\t\t\t\t.then(response => {\r\n\t\t\t\t\t\tconst res = response.data;\r\n\t\t\t\t\t\tif (res.respCode === 0) {\r\n\t\t\t\t\t\t\t// 存储用户的基本信息\r\n\t\t\t\t\t\t\tsetStorage('accessToken', res.obj.accessToken);\r\n\t\t\t\t\t\t\twindow.location.href = '/home';\r\n\t\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t\t\t/*\r\n                this.$router.push({\r\n                  name: \"home\"\r\n                });\r\n                return this.$message({\r\n                  type: \"success\",\r\n                  message: \"登录成功\",\r\n                  center: true\r\n                }); */\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\ttype: 'warning',\r\n\t\t\t\t\t\t\tmessage: res.respDesc,\r\n\t\t\t\t\t\t\tcenter: true,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treject(new Error('登录错误！'));\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(() => {\r\n\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\tmessage: '网络异常',\r\n\t\t\t\t\t\t\tcenter: true,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t});\r\n\t\t},\r\n\t\tforceChange(e) {\r\n\t\t\tthis.$forceUpdate();\r\n\t\t},\r\n\t},\r\n\tcomponents: {\r\n\t\teffectBackground,\r\n\t},\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@keyframes rotatebg {\r\n\t0% {\r\n\t\ttransform: translate(-50%, -50%) rotate(-15deg);\r\n\t}\r\n\t100% {\r\n\t\ttransform: translate(-50%, -50%) rotate(15deg);\r\n\t}\r\n}\r\n@-webkit-keyframes rotatebg {\r\n\t0% {\r\n\t\ttransform: translate(-50%, -50%) rotate(-15deg);\r\n\t}\r\n\t100% {\r\n\t\ttransform: translate(-50%, -50%) rotate(15deg);\r\n\t}\r\n}\r\n.login-page {\r\n\theight: 100vh;\r\n\twidth: 100vw;\r\n\tbackground-color: #020b1d;\r\n\tbackground-size: cover !important;\r\n\tposition: relative;\r\n\t&:after {\r\n\t\tcontent: '';\r\n\t\tposition: absolute;\r\n\t\ttop: 50%;\r\n\t\tleft: 50%;\r\n\t\twidth: 700px;\r\n\t\theight: 690px;\r\n\t\tbackground: url('../assets/images/login/login-container-bg.png');\r\n\t\tz-index: 0;\r\n\t\tbackground-size: 100% 100% !important;\r\n\t\tanimation: rotatebg 30s linear infinite alternate;\r\n\t\t-webkit-animation: rotatebg 30s linear infinite alternate;\r\n\t\tanimation-fill-mode: forwards;\r\n\t\t-webkit-animation-fill-mode: forwards;\r\n\t}\r\n}\r\n\r\n.login-box {\r\n\tposition: absolute;\r\n\ttop: 50%;\r\n\tleft: 50%;\r\n\ttransform: translate(-50%, -50%);\r\n\twidth: 490px;\r\n\theight: 388px;\r\n\tpadding: 62px 62px 0;\r\n\t-webkit-box-sizing: border-box;\r\n\t-moz-box-sizing: border-box;\r\n\tbox-sizing: border-box;\r\n\tbackground: url('../../src/assets/images/login/login-box-bg.png') no-repeat;\r\n\tbackground-size: 100% 100%;\r\n\tz-index: 9999;\r\n\r\n\t.login-describe {\r\n\t\tpadding: 32px 10px 21px 10px;\r\n\t\ttext-align: center;\r\n\t\tfont-size: 18px;\r\n\t\tcolor: #00f6ff;\r\n\t\tline-height: 18px;\r\n\t\tfont-weight: 400;\r\n\t}\r\n\r\n\t.el-form-item {\r\n\t\tmargin-bottom: 25px;\r\n\r\n\t\t/deep/ .el-form-item__content {\r\n\t\t\theight: 46px;\r\n\t\t\tline-height: 46px;\r\n\r\n\t\t\t.el-input {\r\n\t\t\t\tbackground: rgba(9, 32, 53, 0.5);\r\n\t\t\t\tborder: 1px solid transparent;\r\n\t\t\t\tborder-radius: 4px;\r\n\t\t\t\toverflow: hidden;\r\n\r\n\t\t\t\t&.focus {\r\n\t\t\t\t\tborder: 1px solid rgba(0, 246, 255, 1);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.el-input__inner {\r\n\t\t\t\t\theight: 100%;\r\n\t\t\t\t\tbackground-color: transparent;\r\n\t\t\t\t\tborder: 0 none;\r\n\t\t\t\t\tcolor: #00f6ff;\r\n\t\t\t\t\tfont-size: 16px;\r\n\t\t\t\t\tfont-weight: 400;\r\n\t\t\t\t\toutline: none;\r\n\t\t\t\t\tpadding-left: 60px;\r\n\t\t\t\t\tline-height: 44px;\r\n\t\t\t\t\tvertical-align: 0;\r\n\r\n\t\t\t\t\t&::-webkit-input-placeholder {\r\n\t\t\t\t\t\t/* WebKit, Blink, Edge */\r\n\t\t\t\t\t\tcolor: #115f78;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t&:-moz-placeholder {\r\n\t\t\t\t\t\t/* Mozilla Firefox 4 to 18 */\r\n\t\t\t\t\t\tcolor: #115f78;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t&::-moz-placeholder {\r\n\t\t\t\t\t\t/* Mozilla Firefox 19+ */\r\n\t\t\t\t\t\tcolor: #115f78;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t&:-ms-input-placeholder {\r\n\t\t\t\t\t\t/* Internet Explorer 10-11 */\r\n\t\t\t\t\t\tcolor: #115f78;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.el-input__prefix {\r\n\t\t\t\t\tleft: 20px;\r\n\r\n\t\t\t\t\ti {\r\n\t\t\t\t\t\tvertical-align: -2px;\r\n\r\n\t\t\t\t\t\t&.iconfont {\r\n\t\t\t\t\t\t\tfont-size: 18px;\r\n\t\t\t\t\t\t\tcolor: #00838f;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t&:after {\r\n\t\t\t\t\t\tcontent: '';\r\n\t\t\t\t\t\twidth: 0;\r\n\t\t\t\t\t\theight: 27px;\r\n\t\t\t\t\t\tborder-left: 1px solid rgba(34, 165, 145, 0.5);\r\n\t\t\t\t\t\tposition: absolute;\r\n\t\t\t\t\t\ttop: 50%;\r\n\t\t\t\t\t\ttransform: translateY(-50%);\r\n\t\t\t\t\t\tright: -5px;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t.el-form-item__error {\r\n\t\t\t\tline-height: 21px;\r\n\t\t\t\tpadding-top: 4px;\r\n\t\t\t\tleft: 62px;\r\n\t\t\t}\r\n\t\t\t.el-button {\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tdisplay: inline-block;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\tbackground-color: rgb(1, 40, 73);\r\n\t\t\t\tcolor: #00f6ff;\r\n\t\t\t\tfont-size: 18px;\r\n\t\t\t\tfont-weight: bold;\r\n\t\t\t\tborder: 0 none;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n@media screen and (max-height: 768px) {\r\n\t.login-page {\r\n\t\t&:after {\r\n\t\t\twidth: 560px;\r\n\t\t\theight: calc(560px * 0.986);\r\n\t\t}\r\n\r\n\t\t.login-box {\r\n\t\t\twidth: 410px;\r\n\t\t\theight: 370px;\r\n\t\t}\r\n\t}\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/pages/login.vue"],"mappings":"AAgDA","sourceRoot":""}