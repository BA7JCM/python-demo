webpackJsonp([81],{"8N/m":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=e("Xtqa"),s=e("VCTt"),i=e("GV5o"),n=e.n(i);function o(t){if(Array.isArray(t)){for(var a=0,e=Array(t.length);a<t.length;a++)e[a]=t[a];return e}return Array.from(t)}var l={name:"plot-detail-dialog-body",props:{landId:{type:String,default:""}},data:function(){return{layerData:{cropList:[],farmingList:[],historyCrop:[],operators:{},plotInfo:{},certificate:""},bScroll:null,lvseprod:"",showHistory:!1,tabindex:1}},created:function(){},mounted:function(){},destroyed:function(){this.showHistory=!1,this.layerData.cropList=[],this.layerData.historyCrop=[],this.layerData.farmingList=[],this.layerData.operators={},this.layerData.plotInfo={},this.layerData.certificate=""},methods:{getList:function(t){var a=this;return function(t){return function(){var a=t.apply(this,arguments);return new Promise(function(t,e){return function r(s,i){try{var n=a[s](i),o=n.value}catch(t){return void e(t)}if(!n.done)return Promise.resolve(o).then(function(t){r("next",t)},function(t){r("throw",t)});t(o)}("next")})}}(regeneratorRuntime.mark(function e(){var r,i,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.tabindex=t,1!==a.tabindex){e.next=6;break}return e.next=4,a.getPlantFn();case 4:e.next=25;break;case 6:if(2!==a.tabindex){e.next=11;break}return e.next=9,a.getFarmingListFn();case 9:e.next=25;break;case 11:if(3!==a.tabindex){e.next=16;break}return e.next=14,a.getOperatorsFn();case 14:e.next=25;break;case 16:if(4!==a.tabindex){e.next=25;break}return e.next=19,a.getInfoFn();case 19:if(!a.layerData.plotInfo.shGisDkid){e.next=25;break}return r=a.getNYDid(a.layerData.plotInfo.shGisDkid),e.next=23,a.getLandGreencertDetail(r);case 23:(i=e.sent).length&&(n="",i.map(function(t){n+=t.prod+","}),a.lvseprod=n&&-1!==n.indexOf(",")?n.substring(0,n.length-1):n);case 25:a.$nextTick(function(){a.bScroll?(a.bScroll.refresh(),a.bScroll.scrollTo(0,0)):(a.bScroll=Object(s.a)(a.$refs.wrapper),setTimeout(function(){a.bScroll&&a.bScroll.refresh()},500))});case 26:case"end":return e.stop()}},e,a)}))()},getPlantFn:function(){var t=this;return new Promise(function(a){t.$ajax.post(t.$api.plotlist.urlGetPlantPlan,{landId:t.landId,pageNo:1,pageSize:1e3,plantStatus:2}).then(function(e){if(0===e.data.respCode){var r=e.data.obj;t.serverDate=e.data.curDate,t.layerData.cropList=[].concat(o(r.listAgri),o(r.listForestry),o(r.listAnimal),o(r.listFishery)),a(!0)}else a(!1)}).catch(function(){a(!1)})})},getFarmingListFn:function(){var t=this;return new Promise(function(a){t.$ajax.post(t.$api.plotlist.getLandAllFarmRecord,{landId:t.landId,pageNo:1,pageSize:1e3}).then(function(e){if(0===e.data.respCode){var r=e.data.obj;t.layerData.farmingList=r.list,a(!0)}else a(!1)}).catch(function(){a(!1)})})},getOperatorsFn:function(){var t=this,a=this;return new Promise(function(e){t.$ajax.post(t.$api.plotlist.urlGetOperators,{landId:t.landId}).then(function(t){0===t.data.respCode?(a.layerData.operators=t.data.obj,a.layerData.operators.farmDetailVO.farmImageList||(a.layerData.operators.farmDetailVO.farmImageList=[n.a]),a.layerData.operators.farmDetailVO&&a.layerData.operators.farmDetailVO.landRightImgUrl&&(a.layerData.certificate=a.layerData.operators.farmDetailVO.landRightImgUrl),e(!0)):e(!1)}).catch(function(){e(!1)})})},getInfoFn:function(){var t=this,a=this;return new Promise(function(e){t.$ajax.post(t.$api.plotlist.urlGetPlotInfo,{landId:t.landId}).then(function(t){0===t.data.respCode?(a.layerData.plotInfo=t.data.obj,e(!0)):e(!1)}).catch(function(){e(!1)})})},historyToggle:function(){var t=this;this.showHistory=!this.showHistory,this.bScroll&&this.$nextTick(function(){t.bScroll.refresh()})},getNYDid:function(t){return/(\d{18})(\d{3})/g.test(t)?RegExp.$1+"000":t},getLandGreencertDetail:function(t){var a=this;return new Promise(function(e){a.$ajax.post(a.$api.govPatrol.landisgreenCert,{landCode:t}).then(function(t){0===t.data.respCode?e(t.data.obj):e(!1)}).catch(function(){e(!1)})})},viewBigPic:function(){this.$emit("view-pic",this.layerData.certificate)},goDetail:function(){this.$router.push("/farmdetail/"+this.layerData.operators.farmDetailVO.farmId)}},computed:{businessCategoryStr:function(){if(Boolean(this.layerData.operators.farmDetailVO&&this.layerData.operators.farmDetailVO.businessCategoryIdList&&this.layerData.operators.farmDetailVO.businessCategoryIdList.length)&&this.layerData.operators.businessCategoryList&&this.layerData.operators.businessCategoryList.length){var t=this.layerData.operators.farmDetailVO.businessCategoryIdList,a=[];return this.layerData.operators.businessCategoryList.map(function(e){t.includes(e.id)&&a.push(e.bizCategoryName)}),a.join("，")}return""},landAcre:function(){var t=this.layerData.plotInfo.landAcre,a=Number(this.layerData.plotInfo.landAcreUnit)||1;if(!t||!a)return"--";return t>1&&a<4?Object(r.b)(t/[1,1,10,666.66666666667][a],2)+" 亩":Object(r.b)(t,2)+" 亩"}},filters:{landnamefilter:function(t,a){return t&&!/\d{18,}/g.test(t)&&a?t+"("+a+")":t}},components:{plantSpecies:function(){return Promise.all([e.e(0),e.e(37)]).then(e.bind(null,"FjDI"))},farmingOperations:function(){return Promise.all([e.e(0),e.e(33)]).then(e.bind(null,"mACT"))}}},c=[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"label"},[a("img",{attrs:{src:e("b7zr"),alt:""}}),this._v(" "),a("span",[this._v("地块名称")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"label"},[a("img",{attrs:{src:e("4AX2"),alt:""}}),this._v(" "),a("span",[this._v("地块面积")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"label"},[a("img",{attrs:{src:e("IIGb"),alt:""}}),this._v(" "),a("span",[this._v("地块类型")])])}],p=e("W5g0");var f=function(t){e("Lk1N")},d=Object(p.a)(l,function(){var t=this,a=t.$createElement,r=t._self._c||a;return r("div",{ref:"wrapper",staticClass:"tabcon"},[1===t.tabindex?r("div",{staticClass:"plantplan"},[r("plant-species",{attrs:{"crop-list":t.layerData.cropList,"cur-date":t.serverDate}}),t._v(" "),t.layerData.cropList.length>0&&t.layerData.historyCrop.list&&t.layerData.historyCrop.list.length?r("div",{staticClass:"history"},[r("div",{staticClass:"split"},[r("div",{staticClass:"line"}),t._v(" "),r("span",{on:{click:function(a){return t.historyToggle()}}},[t._v(t._s(t.showHistory?"收起":"查看")+"历史种养记录"),r("i",{staticClass:"el-icon-d-arrow-right",class:[t.showHistory?"slide":""]})]),t._v(" "),r("div",{staticClass:"line"})]),t._v(" "),r("plant-species",{directives:[{name:"show",rawName:"v-show",value:t.showHistory,expression:"showHistory"}],attrs:{"crop-list":t.layerData.historyCrop}})],1):t._e()],1):t._e(),t._v(" "),2===t.tabindex?r("div",{staticClass:"resourcebox"},[r("farmingOperations",{attrs:{farminglist:t.layerData.farmingList}})],1):t._e(),t._v(" "),3===t.tabindex?r("div",{staticClass:"operators"},[r("ul",{staticClass:"companylist"},[r("li",{staticClass:"company"},[t.layerData.operators.farmDetailVO&&t.layerData.operators.farmDetailVO.farmImageList?r("div",{staticClass:"company-img"},[r("img",{attrs:{src:t._f("aliimg")(t.layerData.operators.farmDetailVO.farmImageList[0],360,240,!0),alt:"公司图片"}})]):t._e(),t._v(" "),r("div",{staticClass:"txtdes"},[t.layerData.operators.companyVO&&t.layerData.operators.companyVO.companyName?r("p",{staticClass:"title"},[t._v("\n\t\t\t\t\t\t"+t._s(t.layerData.operators.companyVO.companyName)+"\n\t\t\t\t\t")]):t._e(),t._v(" "),r("ul",{staticClass:"infolist"},[r("li",[r("span",{staticClass:"label"},[t._v("法人代表（负责人）：")]),t._v(" "),t.layerData.operators.companyVO&&t.layerData.operators.companyVO.legalPerson?r("span",{staticClass:"lacon"},[t._v(t._s(t.layerData.operators.companyVO.legalPerson))]):t._e()]),t._v(" "),r("li",[r("span",{staticClass:"label"},[t._v("联系方式：")]),t._v(" "),t.layerData.operators.companyVO&&t.layerData.operators.companyVO.legalPersonPhone?r("span",{staticClass:"lacon"},[t._v(t._s(t.layerData.operators.companyVO.legalPersonPhone))]):t._e()]),t._v(" "),r("li",[r("span",{staticClass:"label"},[t._v("主体类型：")]),t._v(" "),r("span",{staticClass:"lacon"},[t._v(t._s(t.layerData.operators.companyVO&&t.layerData.operators.companyVO.companyCategoryVO&&t.layerData.operators.companyVO.companyCategoryVO.companyCategoryName||""))])]),t._v(" "),t.businessCategoryStr?r("li",{staticClass:"business-category"},[r("span",{staticClass:"label"},[t._v("经营类目：")]),t._v(" "),r("span",{staticClass:"lacon"},[t._v(t._s(t.businessCategoryStr||""))])]):t._e(),t._v(" "),r("li",{staticClass:"business-category"},[r("span",{staticClass:"label"},[t._v("主体唯一标识：")]),t._v(" "),t.layerData.operators.companyVO?r("span",{staticClass:"lacon"},[t._v(t._s(t.layerData.operators.companyVO.enterpriseCreditCode||""))]):t._e()]),t._v(" "),t.layerData.operators.farmDetailVO&&(t.layerData.operators.farmDetailVO.landRightStartDate||t.layerData.operators.farmDetailVO.landRightEndDate)?r("li",[r("span",{staticClass:"label"},[t._v("土地承包期限：")]),t._v(" "),t.layerData.operators.farmDetailVO&&t.layerData.operators.farmDetailVO.landRightStartDate?r("span",{staticClass:"lacon"},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(t._f("dateFormat")(t.layerData.operators.farmDetailVO.landRightStartDate,"yyyy.MM.dd"))+"~\n\t\t\t\t\t\t\t\t"+t._s(t._f("dateFormat")(t.layerData.operators.farmDetailVO.landRightEndDate,"yyyy.MM.dd"))+"\n\t\t\t\t\t\t\t")]):t._e(),t._v(" "),t.layerData.certificate?r("i",{staticClass:"imgico",on:{click:t.viewBigPic}}):t._e()]):t._e()])])]),t._v(" "),r("div",{staticClass:"go-farm-detail"},[r("div",{staticClass:"go-farm-detail-box",on:{click:t.goDetail}},[r("span",[t._v("进入主体详情")]),t._v(" "),r("i",{staticClass:"iconfont icon-shuangjiantoushang"})])])])]):t._e(),t._v(" "),4===t.tabindex?r("div",{staticClass:"plotinfo"},[r("ul",[r("li",{staticClass:"infoitem"},[t.layerData.plotInfo.shGisDkid?r("div",{staticClass:"plot-number"},[t._v("编号："+t._s(t.layerData.plotInfo.shGisDkid))]):t._e(),t._v(" "),t._m(0),t._v(" "),r("p",{staticClass:"pyc"},[t._v(t._s(t.layerData.plotInfo.landName))]),t._v(" "),t.lvseprod?r("p",{staticClass:"lvse-cert"},[r("el-tooltip",{attrs:{"popper-class":"lvse-tooltip",effect:"dark",content:"认证产品："+t.lvseprod,placement:"top"}},[r("img",{attrs:{src:e("ySU3"),alt:""}})])],1):t._e()]),t._v(" "),r("li",{staticClass:"infoitem"},[t._m(1),t._v(" "),r("p",[t._v(t._s(t.landAcre))])]),t._v(" "),r("li",{staticClass:"infoitem"},[t._m(2),t._v(" "),r("p",[t._v(t._s(t.layerData.plotInfo.landTypeName))])])])]):t._e()])},c,!1,f,"data-v-0618561b",null);a.default=d.exports},GV5o:function(t,a){t.exports="https://snkoudai.oss-cn-hangzhou.aliyuncs.com/goverment/static/img/default_companylogo.58bdeac.png"},Lk1N:function(t,a){}});
//# sourceMappingURL=81.0ff95642393f90bf23d8.js.map