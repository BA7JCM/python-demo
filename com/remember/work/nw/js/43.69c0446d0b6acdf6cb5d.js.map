{"version":3,"file":"static/js/43.69c0446d0b6acdf6cb5d.js","sources":["webpack:///src/components/overview/modules/business-category-5.vue"],"sourcesContent":["<template>\n\t<div class=\"gov-area-panel\" v-loading=\"mainLoading\" element-loading-spinner=\"iconfont icon-loading1\" element-loading-background=\"rgba(0, 0, 0, 0.2)\">\n\t\t<area-panel area-title=\"经营类目统计\" @hand-sub-title=\"handlePage\">\n\t\t\t<div slot=\"panelMain\" class=\"echart-container\" ref=\"EContainer\"></div>\n\t\t</area-panel>\n\t</div>\n</template>\n\n<script>\nimport areaPanel from '@/components/overview/area-panel';\nimport {areaLevelCorAreaId, maxDecimalPlaces} from '@/common/fn';\n\n// echarts 超级变量含义 {a} series.name, {b} data.name {c} data.value {d} data%\nconst pieOption = {\n\ttitle: {\n\t\t// subtext: '',\n\t\tleft: 'center',\n\t\ttop: '35%',\n\t\ttextStyle: {\n\t\t\tcolor: '#9ED2D8',\n\t\t\tfontSize: 12,\n\t\t\tlineHeight: 22\n\t\t},\n\t\tsubtextStyle: {\n\t\t\tcolor: '#00F6FF',\n\t\t\tfontSize: 24,\n\t\t\tlineHeight: 34,\n\t\t\tfontWeight: 'bold'\n\t\t},\n\t\titemGap: 0\n\t},\n\ttooltip: {\n\t\tshow: true,\n\t\ttrigger: 'item',\n\t\tformatter: '{b}：{c}家',\n\t\tbackgroundColor: '#043250',\n\t\tpadding: [13, 14, 13, 11],\n\t\ttextStyle: {\n\t\t\tfontSize: 12,\n\t\t\tcolor: '#9ED2D8'\n\t\t}\n\t},\n\tcolor: ['#FFA37E', '#3CC8FF', '#61D9CB', '#FFCE7E', '#7E94FF', '#DFF247', '#F087B1', '#46F262', '#9CE9E8', '#BB97FB'],\n\ttextStyle: {\n\t\tcolor: '#9DD1D7',\n\t\tfontSize: 14,\n\t\tfontWeight: '400',\n\t\tlineHeight: 14\n\t},\n\tseries: [\n\t\t{\n\t\t\tname: '经营主体类型统计',\n\t\t\ttype: 'pie',\n\t\t\t// center: ['50%', '80%'],\n\t\t\tradius: ['60%', '75%'],\n\t\t\tavoidLabelOverlap: true,\n\t\t\tminAngle: 15,\n\t\t\tstartAngle: 80,\n\t\t\tlabel: {\n\t\t\t\tnormal: {\n\t\t\t\t\tshow: true,\n\t\t\t\t\tfontSize: 12,\n\t\t\t\t\tposition: 'outside',\n\t\t\t\t\tlineHeight: 16,\n\t\t\t\t\tformatter: ['{nameS|{b}}', '{valueS|{c}家}'].join('：'),\n\t\t\t\t\t// formatter: '{nameS|{b}}：{valueS|{c}家}',\n\t\t\t\t\trich: {\n\t\t\t\t\t\tnameS: {\n\t\t\t\t\t\t\tcolor: '#9ED2D8'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tvalueS: {\n\t\t\t\t\t\t\tcolor: '#00F6FF'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tlabelLine: {\n\t\t\t\tnormal: {\n\t\t\t\t\tshow: true,\n\t\t\t\t\tlength: 20,\n\t\t\t\t\tlength2: 10\n\t\t\t\t\t// smooth: 0\n\t\t\t\t}\n\t\t\t},\n\t\t\thoverAnimation: true,\n\t\t\tselectedMode: 'multiple',\n\t\t\tselectedOffset: 2,\n\t\t\tdata: []\n\t\t},\n\t\t{\n\t\t\ttype: 'pie',\n\t\t\tradius: ['55%', '56%'],\n\t\t\tminAngle: 15,\n\t\t\tstartAngle: 80,\n\t\t\tanimation: true,\n\t\t\tlabelLine: {\n\t\t\t\tshow: false\n\t\t\t},\n\t\t\thoverAnimation: false,\n\t\t\tz: 3,\n\t\t\ttooltip: {\n\t\t\t\tshow: false\n\t\t\t},\n\t\t\tlabel: {\n\t\t\t\tshow: false\n\t\t\t},\n\t\t\tselectedMode: 'multiple',\n\t\t\tselectedOffset: 4,\n\t\t\tdata: []\n\t\t}\n\t]\n};\nexport default {\n\tname: 'business-category-5',\n\tprops: {\n\t\tfarmAreaInfo: {\n\t\t\ttype: Object,\n\t\t\tdefault() {\n\t\t\t\treturn areaLevelCorAreaId();\n\t\t\t}\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tchartInstance: null,\n\t\t\tmainLoading: true\n\t\t};\n\t},\n\tmounted() {\n\t\tthis.$nextTick(() => {\n\t\t\tthis.initMoudle();\n\t\t});\n\t},\n\tmethods: {\n\t\tasync initMoudle() {\n\t\t\tthis.mainLoading = true;\n\t\t\tif (!this.chartInstance) {\n\t\t\t\tthis.chartInstance = this._initEcharts(this.eContainerRef, pieOption);\n\t\t\t}\n\t\t\tconst res = await this.getBusinessScale();\n\t\t\tconst numRes = await this.getOperatorsTypeNum();\n\t\t\tthis.setEchart(this.chartInstance, res, numRes);\n\t\t\tthis.adaptationChart();\n\t\t\tthis.mainLoading = false;\n\t\t},\n\t\trefreshRender() {\n\t\t\tif (this.chartInstance) {\n\t\t\t\tthis.chartInstance.resize();\n\t\t\t\tthis.adaptationChart();\n\t\t\t}\n\t\t},\n\t\t// 经营主体数量分布\n\t\tgetOperatorsTypeNum() {\n\t\t\treturn this.$ajax\n\t\t\t\t.post(this.$api.overview.getOperatorsTypeNum, {\n\t\t\t\t\tfarmAreaId: [this.farmAreaInfo.farmAreaId],\n\t\t\t\t\tfarmAreaType: this.farmAreaInfo.farmAreaType\n\t\t\t\t})\n\t\t\t\t.then(({data}) => {\n\t\t\t\t\tif (data.respCode === 0) {\n\t\t\t\t\t\treturn data.obj;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(e => {\n\t\t\t\t\tconsole.log(new Error('经营主体数量分布error'), e);\n\t\t\t\t});\n\t\t},\n\t\t// 获取经营类目统计\n\t\tgetBusinessScale() {\n\t\t\treturn this.$ajax\n\t\t\t\t.post(this.$api.overview.getBusinessCategory, {\n\t\t\t\t\tfarmAreaId: [this.farmAreaInfo.farmAreaId],\n\t\t\t\t\tfarmAreaType: this.farmAreaInfo.farmAreaType\n\t\t\t\t})\n\t\t\t\t.then(({data}) => {\n\t\t\t\t\tif (data.respCode === 0) {\n\t\t\t\t\t\treturn data.obj;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(e => {\n\t\t\t\t\tconsole.log(new Error('获取经营类目统计error'), e);\n\t\t\t\t});\n\t\t},\n\t\t_initEcharts(el, option) {\n\t\t\tconst chart = this.$echarts.init(el);\n\t\t\tchart.setOption(option);\n\t\t\treturn chart;\n\t\t},\n\t\tsetEchart(chartInstance, res, numRes) {\n\t\t\tconst seriesData = res\n\t\t\t\t.filter(info => info.count > 0)\n\t\t\t\t.map(info => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tname: info.name,\n\t\t\t\t\t\tvalue: info.count,\n\t\t\t\t\t\tselected: false\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\tconst noData = !(seriesData.length > 0);\n\t\t\tconst chartOpts = {\n\t\t\t\ttitle: {\n\t\t\t\t\ttext: '经营主体(家)',\n\t\t\t\t\tsubtext: `${numRes.count}`,\n\t\t\t\t\tleft: 'center',\n\t\t\t\t\ttop: 'center'\n\t\t\t\t},\n\t\t\t\tseries: [\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: seriesData\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: seriesData\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\t\t\tchartInstance.setOption(chartOpts);\n\t\t},\n\t\t// 适配Echarts\n\t\tadaptationChart() {\n\t\t\tconst containerH = this.eContainerRef.clientHeight;\n\t\t\tlet textLineHeight = maxDecimalPlaces({\n\t\t\t\tvalue: containerH * 0.088,\n\t\t\t\tplaces: 0\n\t\t\t});\n\t\t\tlet subtextLineHeight = maxDecimalPlaces({\n\t\t\t\tvalue: containerH * 0.136,\n\t\t\t\tplaces: 0\n\t\t\t});\n\t\t\tlet textFontSize = maxDecimalPlaces({\n\t\t\t\tvalue: containerH * 0.048,\n\t\t\t\tplaces: 0\n\t\t\t});\n\t\t\tlet labelLineHeight = maxDecimalPlaces({\n\t\t\t\tvalue: containerH * 0.064,\n\t\t\t\tplaces: 0\n\t\t\t});\n\t\t\ttextLineHeight = textLineHeight > 22 ? textLineHeight : 22;\n\t\t\tsubtextLineHeight = subtextLineHeight > 34 ? subtextLineHeight : 34;\n\t\t\ttextFontSize = textFontSize > 12 ? textFontSize : 12;\n\t\t\tlabelLineHeight = labelLineHeight > 16 ? labelLineHeight : 16;\n\t\t\tthis.chartInstance.setOption({\n\t\t\t\ttitle: {\n\t\t\t\t\ttop: this.eContainerRef.clientHeight / 2 - (textLineHeight + subtextLineHeight) / 2,\n\t\t\t\t\ttextStyle: {\n\t\t\t\t\t\tfontSize: textFontSize,\n\t\t\t\t\t\tlineHeight: textLineHeight\n\t\t\t\t\t},\n\t\t\t\t\tsubtextStyle: {\n\t\t\t\t\t\tfontSize: textFontSize * 2,\n\t\t\t\t\t\tlineHeight: subtextLineHeight\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tseries: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: {\n\t\t\t\t\t\t\tnormal: {\n\t\t\t\t\t\t\t\tlineHeight: labelLineHeight,\n\t\t\t\t\t\t\t\trich: {\n\t\t\t\t\t\t\t\t\tnameS: {\n\t\t\t\t\t\t\t\t\t\tfontSize: textFontSize\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tvalueS: {\n\t\t\t\t\t\t\t\t\t\tfontSize: textFontSize\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tlabelLine: {\n\t\t\t\t\t\t\tnormal: {\n\t\t\t\t\t\t\t\tlength: maxDecimalPlaces({\n\t\t\t\t\t\t\t\t\tvalue: containerH * 0.04,\n\t\t\t\t\t\t\t\t\tplaces: 0\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tlength2: maxDecimalPlaces({\n\t\t\t\t\t\t\t\t\tvalue: containerH * 0.06,\n\t\t\t\t\t\t\t\t\tplaces: 0\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t});\n\t\t},\n\t\thandlePage() {\n\t\t\t// this.$router.push({\n\t\t\t// \tname: 'operateSubjectList'\n\t\t\t// });\n\t\t\tthis.$emit('handleClick', 'operateSubjectList', '经营类目统计');\n\t\t}\n\t},\n\tcomputed: {\n\t\teContainerRef() {\n\t\t\treturn this.$refs.EContainer;\n\t\t}\n\t},\n\tcomponents: {\n\t\tareaPanel\n\t}\n};\n</script>\n\n<style scoped lang=\"less\">\n.gov-area-panel {\n\twidth: 100%;\n\theight: 100%;\n\t/*min-width: 364px;\n    min-height: 295px;*/\n\tbackground-color: fade(#061f36, 34%);\n\t.echart-container {\n\t\theight: 100%;\n\t}\n\t/deep/ .el-loading-spinner {\n\t\toverflow: hidden;\n\t\t.iconfont {\n\t\t\tdisplay: block;\n\t\t\tfont-size: 40px;\n\t\t\tcolor: #00f6ff;\n\t\t\tanimation: loading 1.25s linear infinite;\n\t\t\tmargin-top: 24px;\n\t\t\tmargin-left: 8px;\n\t\t}\n\t}\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/overview/modules/business-category-5.vue"],"mappings":"AAaA","sourceRoot":""}