{"version":3,"file":"static/js/19.7e5c5dd76539272cf898.js","sources":["webpack:///src/components/overview/modules/argi-materials-statistic-12.vue"],"sourcesContent":["<template>\n\t<div class=\"gov-area-panel\">\n\t\t<area-panel area-title=\"农资使用统计\">\n\t\t\t<div class=\"date-time head-sub-title\" slot=\"subTitle\">{{ dataTime | dateFormat('yyyy年MM月') }}</div>\n\t\t\t<div class=\"panel-main-container\" slot=\"panelMain\" v-loading=\"loading\" element-loading-spinner=\"iconfont icon-loading1\" element-loading-background=\"rgba(0, 0, 0, 0.2)\">\n\t\t\t\t<el-tabs value=\"manure\" @tab-click=\"switchTabs\" v-show=\"!loading\">\n\t\t\t\t\t<el-tab-pane label=\"肥料\" name=\"manure\" ref=\"manureRef\">\n\t\t\t\t\t\t<ul class=\"goods-ul\" v-if=\"manureList.length > 0\">\n\t\t\t\t\t\t\t<li class=\"goods-item\" v-for=\"(item, index) in manureList\" :key=\"index\">\n\t\t\t\t\t\t\t\t<p class=\"goods-name\">\n\t\t\t\t\t\t\t\t\t<span class=\"serial-number\">{{ index + 1 }}</span>\n\t\t\t\t\t\t\t\t\t<span class=\"g-name\">{{ item.resName }}</span>\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t<p class=\"goods-value\">{{ item.totalAmount }}{{ item.totalAmountUnit }}</p>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<div class=\"no-data\" v-else>暂无数据</div>\n\t\t\t\t\t</el-tab-pane>\n\t\t\t\t\t<el-tab-pane label=\"农药\" name=\"pesticide\" ref=\"pesticideRef\">\n\t\t\t\t\t\t<ul class=\"goods-ul\" v-if=\"pesticideList.length > 0\">\n\t\t\t\t\t\t\t<li class=\"goods-item\" v-for=\"(item, index) in pesticideList\" :key=\"index\">\n\t\t\t\t\t\t\t\t<p class=\"goods-name\">\n\t\t\t\t\t\t\t\t\t<span class=\"serial-number\">{{ index + 1 }}</span>\n\t\t\t\t\t\t\t\t\t<span class=\"g-name\">{{ item.resName }}</span>\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t<!-- 搞不懂问测试 -->\n\t\t\t\t\t\t\t\t<p class=\"goods-value\">{{ item.totalAmount * 1000 }}千克<!--{{ item.totalAmountUnit }}--></p>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<div class=\"no-data\" v-else>暂无数据</div>\n\t\t\t\t\t</el-tab-pane>\n\t\t\t\t</el-tabs>\n\t\t\t</div>\n\t\t</area-panel>\n\t</div>\n</template>\n\n<script>\nimport areaPanel from '@/components/overview/area-panel';\nimport {areaLevelCorAreaId, maxDecimalPlaces, prevMonth, dateFormat, _initBScroll} from '@/common/fn';\n\nexport default {\n\tname: 'argi-materials-statistic-12',\n\tprops: {\n\t\tfarmAreaInfo: {\n\t\t\ttype: Object,\n\t\t\tdefault() {\n\t\t\t\treturn areaLevelCorAreaId();\n\t\t\t}\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tloading: true,\n\t\t\tdataTime: new Date(prevMonth()).setDate(1),\n\t\t\tmanureList: [],\n\t\t\tmanureBs: null,\n\t\t\tpesticideList: [],\n\t\t\tpesticideBs: null,\n\t\t\tcancelAjaxFnContainer: [] //请求 ajax cancel 容器\n\t\t};\n\t},\n\tmounted() {\n\t\tthis.initMoudle();\n\t},\n\tmethods: {\n\t\tasync initMoudle() {\n\t\t\treturn new Promise(async resolve => {\n\t\t\t\tthis.stopPrevInitfn(); //取消上一次请求\n\t\t\t\tthis.loading = true;\n\t\t\t\tthis.manureBs && this.manureBs.scrollTo(0, 0);\n\t\t\t\tthis.manureBs && this.manureBs.destroy();\n\t\t\t\tthis.pesticideBs && this.pesticideBs.scrollTo(0, 0);\n\t\t\t\tthis.pesticideBs && this.pesticideBs.destroy();\n\t\t\t\tvar result = await this.renderList(this.farmAreaInfo.farmAreaId, this.farmAreaInfo.farmAreaType);\n\t\t\t\tif (!result) {\n\t\t\t\t\tresolve(false);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tthis.manureBs = _initBScroll(this.$refs.manureRef.$el);\n\t\t\t\t\tthis.pesticideBs = _initBScroll(this.$refs.pesticideRef.$el);\n\t\t\t\t\tthis.loading = false;\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tthis.manureBs.refresh();\n\t\t\t\t\t\tthis.pesticideBs.refresh();\n\t\t\t\t\t\tresolve(true);\n\t\t\t\t\t}, 300);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\trefreshRender() {\n\t\t\tif (this.manureBs || this.pesticideBs) {\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tthis.manureBs.refresh();\n\t\t\t\t\tthis.pesticideBs.refresh();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tstopPrevInitfn() {\n\t\t\tif (!this.cancelAjaxFnContainer.length) return;\n\t\t\tthis.cancelAjaxFnContainer.forEach(cancal => {\n\t\t\t\tcancal('取消过期请求');\n\t\t\t});\n\t\t\tthis.cancelAjaxFnContainer.length = 0;\n\t\t},\n\t\tgetMissionInputList(type, farmAreaId, farmAreaType, cancelFnContainer) {\n\t\t\tlet CancelToken = this.$ajax.CancelToken;\n\t\t\treturn new Promise(resolve => {\n\t\t\t\tthis.$ajax\n\t\t\t\t\t.post(\n\t\t\t\t\t\tthis.$api.inputs.getSpecies,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tareaId: farmAreaId,\n\t\t\t\t\t\t\tareaType: farmAreaType,\n\t\t\t\t\t\t\tdateStr: dateFormat(this.dataTime, 'yyyy-MM-dd'),\n\t\t\t\t\t\t\tinputType: type\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcancelToken: new CancelToken(function executor(c) {\n\t\t\t\t\t\t\t\tcancelFnContainer.push(c); // 这个参数 c 就是CancelToken构造函数里面自带的取消请求的函数，这里把该函数当参数用\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t\t.then(({data}) => {\n\t\t\t\t\t\tif (data.respCode === 0) {\n\t\t\t\t\t\t\tresolve(data.obj);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresolve(null);\n\t\t\t\t\t\t\tconsole.log(new Error('农资使用统计error'), e);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch(e => {\n\t\t\t\t\t\tconsole.log(new Error('农资使用统计error'), e);\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tasync renderList(farmAreaId, farmAreaType) {\n\t\t\treturn new Promise(async resolve => {\n\t\t\t\t// 1:种苗， 2:肥料, 4：农药\n\t\t\t\tconst manureRes = await this.getMissionInputList(2, farmAreaId, farmAreaType, this.cancelAjaxFnContainer);\n\t\t\t\tif (!manureRes) {\n\t\t\t\t\treturn resolve(false);\n\t\t\t\t}\n\t\t\t\tconst pesticideRes = await this.getMissionInputList(4, farmAreaId, farmAreaType, this.cancelAjaxFnContainer);\n\t\t\t\tif (!pesticideRes) {\n\t\t\t\t\treturn resolve(false);\n\t\t\t\t}\n\t\t\t\tthis.cancelAjaxFnContainer.length = 0;\n\t\t\t\tthis.manureList = [];\n\t\t\t\tthis.pesticideList = [];\n\t\t\t\tif (manureRes && manureRes.flResNameVOS && manureRes.flResNameVOS.length) {\n\t\t\t\t\tthis.manureList = manureRes.flResNameVOS.slice(0, 20); // 肥料\n\t\t\t\t}\n\t\t\t\tif (pesticideRes && pesticideRes.nyResNameVOS && pesticideRes.nyResNameVOS.length) {\n\t\t\t\t\tthis.pesticideList = pesticideRes.nyResNameVOS.slice(0, 20); // 农药\n\t\t\t\t}\n\t\t\t\tresolve(true);\n\t\t\t});\n\t\t},\n\t\tswitchTabs(tab) {\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis[`${tab.name}Bs`].refresh();\n\t\t\t});\n\t\t}\n\t},\n\tcomponents: {\n\t\tareaPanel\n\t}\n};\n</script>\n\n<style scoped lang=\"scss\">\n@import '~styles/tabsSkin_default';\n@import '~styles/scrollbarSkin_default';\n</style>\n\n<style scoped lang=\"less\">\n.gov-area-panel {\n\twidth: 100%;\n\theight: 100%;\n\tbackground-color: fade(#061f36, 34%);\n\t.date-time {\n\t\tline-height: 26px;\n\t\tfont-size: 14px;\n\t\tcolor: fade(#00f6ff, 50%);\n\t}\n\t.panel-main-container {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\t/deep/.el-tabs {\n\t\t\t.el-tabs__header {\n\t\t\t\tmargin: 0;\n\t\t\t\t.el-tabs__nav-wrap {\n\t\t\t\t\t&:after {\n\t\t\t\t\t\tbackground-color: #033250;\n\t\t\t\t\t}\n\t\t\t\t\t.el-tabs__nav-scroll {\n\t\t\t\t\t\toverflow: unset;\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\tjustify-content: center;\n\t\t\t\t\t\t.el-tabs__active-bar {\n\t\t\t\t\t\t\tbackground-color: #00f6ff;\n\t\t\t\t\t\t\tpadding: 0 4px;\n\t\t\t\t\t\t\tleft: -4px;\n\t\t\t\t\t\t\theight: 2px;\n\t\t\t\t\t\t\tbottom: 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t.el-tabs__item {\n\t\t\t\t\t\t\theight: 30px;\n\t\t\t\t\t\t\tline-height: 30px;\n\t\t\t\t\t\t\tfont-size: 16px;\n\t\t\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\t\t\t&.is-active {\n\t\t\t\t\t\t\t\tcolor: #00f6ff;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t.el-tabs__content {\n\t\t\t\t.el-tab-pane {\n\t\t\t\t\toverflow: hidden;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t.goods-ul {\n\t\t\twidth: 100%;\n\t\t\tbox-sizing: border-box;\n\t\t\tpadding: 0 14px;\n\t\t\t.goods-item {\n\t\t\t\theight: 40px;\n\t\t\t\tdisplay: flex;\n\t\t\t\tjustify-content: space-between;\n\t\t\t\talign-items: center;\n\t\t\t\t+ .goods-item {\n\t\t\t\t\tborder-top: 1px solid fade(#32cebb, 8%);\n\t\t\t\t}\n\t\t\t\t.goods-name {\n\t\t\t\t\tcolor: #9dd1d7;\n\t\t\t\t\tfont-size: 14px;\n\t\t\t\t\tline-height: 24px;\n\t\t\t\t\twhite-space: nowrap;\n\t\t\t\t\twidth: 67%;\n\t\t\t\t\t.serial-number {\n\t\t\t\t\t\tdisplay: inline-block;\n\t\t\t\t\t\twidth: 16px;\n\t\t\t\t\t\theight: 16px;\n\t\t\t\t\t\tborder-radius: 2px;\n\t\t\t\t\t\tbackground-color: #025b67;\n\t\t\t\t\t\ttext-align: center;\n\t\t\t\t\t\tline-height: 16px;\n\t\t\t\t\t\tfont-size: 12px;\n\t\t\t\t\t\tcolor: #00f6ff;\n\t\t\t\t\t\tmargin-right: 10px;\n\t\t\t\t\t\tvertical-align: 1px;\n\t\t\t\t\t}\n\t\t\t\t\t.g-name {\n\t\t\t\t\t\tmin-width: 200px;\n\t\t\t\t\t\twidth: 86%;\n\t\t\t\t\t\toverflow: hidden;\n\t\t\t\t\t\ttext-overflow: ellipsis;\n\t\t\t\t\t\tdisplay: inline-block;\n\t\t\t\t\t\twhite-space: nowrap;\n\t\t\t\t\t\tvertical-align: -6px;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t.goods-value {\n\t\t\t\t\twidth: 23%;\n\t\t\t\t\tmin-width: 80px;\n\t\t\t\t\toverflow: hidden;\n\t\t\t\t\ttext-overflow: ellipsis;\n\t\t\t\t\twhite-space: nowrap;\n\t\t\t\t\tfont-size: 14px;\n\t\t\t\t\tcolor: #00f6ff;\n\t\t\t\t\tline-height: 24px;\n\t\t\t\t\ttext-align: right;\n\t\t\t\t}\n\t\t\t\t&:nth-child(1) {\n\t\t\t\t\t.goods-name {\n\t\t\t\t\t\t.serial-number {\n\t\t\t\t\t\t\tbackground-color: #b65718;\n\t\t\t\t\t\t\tcolor: #ffd07e;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t&:nth-child(2) {\n\t\t\t\t\t.goods-name {\n\t\t\t\t\t\t.serial-number {\n\t\t\t\t\t\t\tbackground-color: #919110;\n\t\t\t\t\t\t\tcolor: #fbf95e;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t&:nth-child(3) {\n\t\t\t\t\t.goods-name {\n\t\t\t\t\t\t.serial-number {\n\t\t\t\t\t\t\tbackground-color: #159354;\n\t\t\t\t\t\t\tcolor: #71fa5a;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t.no-data {\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tjustify-content: center;\n\t\t\tfont-size: 14px;\n\t\t\tcolor: #00f6ff;\n\t\t\tfont-weight: bold;\n\t\t}\n\t}\n\t/deep/ .el-loading-spinner {\n\t\toverflow: hidden;\n\t\ttop: 34%;\n\t\t.iconfont {\n\t\t\tdisplay: block;\n\t\t\tfont-size: 40px;\n\t\t\tcolor: #00f6ff;\n\t\t\tanimation: loading 1.25s linear infinite;\n\t\t\tmargin-top: 24px;\n\t\t\tmargin-left: 8px;\n\t\t}\n\t}\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/overview/modules/argi-materials-statistic-12.vue"],"mappings":"AAyCA","sourceRoot":""}