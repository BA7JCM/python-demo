{"version":3,"file":"static/js/80.6cfc3e955b4b807e64eb.js","sources":["webpack:///src/pages/overview/farmRecordListOther.vue"],"sourcesContent":["<template>\r\n\t<div\r\n\t\tclass=\"farm-record-other\"\r\n\t\tv-title\r\n\t\tdata-title=\"信息直报\"\r\n\t\tv-loading=\"excelLoading\"\r\n\t\telement-loading-text=\"数据导出中...\"\r\n\t\telement-loading-spinner=\"el-icon-loading\"\r\n\t\telement-loading-background=\"rgba(0, 0, 0, 0.5)\"\r\n\t>\r\n\t\t<Nav @back=\"back\" title=\"信息直报\" :hasShadow=\"true\" backColor=\"#B6CFDE\" paddingRight=\"13px\" :isUserCenter=\"true\" :isAddNum=\"isAddNum\">\r\n\t\t\t<!-- <div slot=\"right\" style=\"width: 246px; height: 55px; position: relative;\">\r\n\t\t\t\t<UserCenter></UserCenter>\r\n\t\t\t</div> -->\r\n\t\t</Nav>\r\n\r\n\t\t<div class=\"main\">\r\n\t\t\t<div class=\"search-box\">\r\n\t\t\t\t<div class=\"search-box-left\">\r\n\t\t\t\t\t<CustomDatePicker margin=\"0 15px 0 0\" :clearable=\"false\" v-model=\"dateValue\" :pickerOptions=\"pickerOptions\" @change=\"dateChange\" @focus=\"focus\"></CustomDatePicker>\r\n\r\n\t\t\t\t\t<CustomSelect margin=\"0 15px 0 0\">\r\n\t\t\t\t\t\t<template slot=\"select-container\">\r\n\t\t\t\t\t\t\t<el-select v-model=\"businessCategory\" placeholder=\"选择经营类目\" @change=\"businessChange\">\r\n\t\t\t\t\t\t\t\t<el-option v-for=\"item in businessCategoryList\" :key=\"item.id\" :label=\"item.bizCategoryName\" :value=\"item.id\"> </el-option>\r\n\t\t\t\t\t\t\t</el-select>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</CustomSelect>\r\n\r\n\t\t\t\t\t<CustomSelect margin=\"0 15px 0 0\">\r\n\t\t\t\t\t\t<template slot=\"select-container\">\r\n\t\t\t\t\t\t\t<el-select v-model=\"reportStatus\" placeholder=\"全部\" @change=\"businessChange\">\r\n\t\t\t\t\t\t\t\t<el-option v-for=\"item in reportList\" :key=\"item.status\" :label=\"item.text\" :value=\"item.status\"> </el-option>\r\n\t\t\t\t\t\t\t</el-select>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</CustomSelect>\r\n\r\n\t\t\t\t\t<CustomAreaSelect @areaCilck=\"areaCilck\" :level=\"level\" :areaId=\"startId\"></CustomAreaSelect>\r\n\r\n\t\t\t\t\t<CustomInput iconfont=\"el-icon-search\" placeholder=\"输入经营主体名称搜索\" v-model=\"keyword\" @clickAndEnter=\"clickAndEnter\"></CustomInput>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"excel-box\">\r\n\t\t\t\t\t<div class=\"excel\" @click=\"download\">\r\n\t\t\t\t\t\t<img src=\"../../assets/images/table/bg-excel-icon.png\" />\r\n\t\t\t\t\t\t<span style=\"margin-left: 9px\">导出EXCEL</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"list-content\" ref=\"listContent\">\r\n\t\t\t\t<!-- <Loading :show=\"true\" type=\"element\"></Loading> -->\r\n\t\t\t\t<CustomTable>\r\n\t\t\t\t\t<template slot=\"table-container\">\r\n\t\t\t\t\t\t<el-table :data=\"farmRecordList\" style=\"width: 100%\" :fit=\"true\" :height=\"tableHeight\" :lazy=\"true\">\r\n\t\t\t\t\t\t\t<template slot=\"empty\">\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<Loading :show=\"loading\" type=\"element\" theme=\"loader-light\"></Loading>\r\n\t\t\t\t\t\t\t\t\t<div class=\"no-data\" v-if=\"!loading\">\r\n\t\t\t\t\t\t\t\t\t\t<img src=\"../../assets/images/table/bg-table-no-data.png\" />\r\n\t\t\t\t\t\t\t\t\t\t<span>暂无数据</span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t<el-table-column label=\"经营主体名称\">\r\n\t\t\t\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t\t\t\t<span class=\"text-bold\">{{ scope.row.farmName ? scope.row.farmName : '--' }}</span>\r\n\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t</el-table-column>\r\n\r\n\t\t\t\t\t\t\t<el-table-column label=\"所在地\">\r\n\t\t\t\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t\t\t\t<span class=\"text\">{{ spliceAreaName(scope.row) ? spliceAreaName(scope.row) : '--' }}</span>\r\n\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t</el-table-column>\r\n\r\n\t\t\t\t\t\t\t<el-table-column label=\"经营类目\">\r\n\t\t\t\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t\t\t\t<span class=\"text\">{{ scope.row.bizCategoryNameList.length ? scope.row.bizCategoryNameList.join('、') : '--' }}</span>\r\n\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t</el-table-column>\r\n\r\n\t\t\t\t\t\t\t<!-- <el-table-column label=\"在田品种\">\r\n\t\t\t\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t\t\t\t<span class=\"text text-ellipsis\" v-if=\"!scope.row.onLandCropList.length\">--</span> -->\r\n\t\t\t\t\t\t\t<!-- popper-class=\"farm-record-custom-tooltip-light\"白色主题 -->\r\n\t\t\t\t\t\t\t<!-- <el-tooltip v-else class=\"item\" effect=\"dark\" popper-class=\"farm-record-custom-tooltip-dark\" placement=\"top\">\r\n\t\t\t\t\t\t\t\t\t\t<div slot=\"content\" class=\"tooltip-box\">{{ scope.row.onLandCropList.join('、') }}</div>\r\n\t\t\t\t\t\t\t\t\t\t<span class=\"text text-ellipsis\" @click=\"buttonClick\">{{ scope.row.onLandCropList.length ? scope.row.onLandCropList.join('、') : '--' }}</span>\r\n\t\t\t\t\t\t\t\t\t</el-tooltip>\r\n\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t</el-table-column> -->\r\n\r\n\t\t\t\t\t\t\t<el-table-column label=\"生产作业上报(条)\">\r\n\t\t\t\t\t\t\t\t<template slot=\"header\" slot-scope=\"scope\">\r\n\t\t\t\t\t\t\t\t\t<CustomTableSort title=\"生产作业上报(条)\" :defaultSort=\"defaultSort\" @sortChange=\"sortChange\"></CustomTableSort>\r\n\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t\t\t\t<span class=\"text-bold text-green\">{{ scope.row.farmingReportCount }}</span>\r\n\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t</el-table-column>\r\n\r\n\t\t\t\t\t\t\t<el-table-column label=\"操作\" width=\"120\">\r\n\t\t\t\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"handle\" @click=\"goFarm(scope.row)\">\r\n\t\t\t\t\t\t\t\t\t\t<i class=\"iconfont icon-xiangqing\"></i>\r\n\t\t\t\t\t\t\t\t\t\t<span>详情</span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t</el-table-column>\r\n\t\t\t\t\t\t</el-table>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</CustomTable>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"page-box\">\r\n\t\t\t<div class=\"farm-statistics\">\r\n\t\t\t\t<span class=\"text-bold\">上报经营主体：{{ farmStatistics.reportFarms }}家 (占比{{ formatNum((farmStatistics.reportFarms / farmStatistics.totalFarms) * 100) }}%)</span>\r\n\t\t\t\t<span class=\"text-bold\">未上报经营主体：{{ farmStatistics.unReportFarms }}家 (占比{{ formatNum((farmStatistics.unReportFarms / farmStatistics.totalFarms) * 100) }}%)</span>\r\n\t\t\t\t<span class=\"text-bold\">生产作业上报：{{ farmStatistics.totalReports ? farmStatistics.totalReports : 0 }}条</span>\r\n\t\t\t</div>\r\n\t\t\t<Page\r\n\t\t\t\tv-if=\"total > pageSize\"\r\n\t\t\t\t:total=\"total\"\r\n\t\t\t\t:page-size=\"pageSize\"\r\n\t\t\t\t:current=\"currentPage\"\r\n\t\t\t\t@onChange=\"onChange\"\r\n\t\t\t\t@changePageSize=\"changePageSize\"\r\n\t\t\t\t:isPageSizeShow=\"true\"\r\n\t\t\t\t:isJumpShow=\"true\"\r\n\t\t\t\t:isTotalShow=\"true\"\r\n\t\t\t\t:perPage=\"15\"\r\n\t\t\t></Page>\r\n\t\t</div>\r\n\r\n\t\t<RunBall :isRunBall=\"isRunBall\"></RunBall>\r\n\r\n\t\t<downloadModal :isShow.sync=\"isModalShow\"></downloadModal>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport Nav from '@/components/common/nav.vue';\r\nimport Page from '@/components/common/page.vue';\r\nimport Loading from '@/components/common/loading.vue';\r\nimport CustomInput from '@/components/common/input.vue';\r\nimport CustomSelect from '@/components/common/select.vue';\r\nimport CustomTable from '@/components/common/table.vue';\r\nimport CustomTableSort from '@/components/common/custom-table-sort.vue';\r\nimport CustomDatePicker from '@/components/common/datePicker.vue';\r\nimport CustomAreaSelect from '@/components/common/area-selecter.vue';\r\nimport downloadModal from '@/components/common/download-modal.vue';\r\nimport RunBall from '@/components/common/run-ball.vue'; // 抛出动画\r\n\r\nimport {areaLevelCorAreaId, maxDecimalPlaces} from '@/common/fn/index.js';\r\nimport {getStorage, SessionStorage} from '@/utils/storage.js';\r\nimport {downloadExcel} from '@/utils/utils.js';\r\n\r\nlet farmRecordSessionStorage = '';\r\n\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tcurrentPage: 1,\r\n\t\t\tpageSize: 15,\r\n\t\t\ttotal: 1,\r\n\t\t\tkeyword: '',\r\n\t\t\tfarmRecordList: [],\r\n\t\t\t// 经营类目\r\n\t\t\tbusinessCategoryList: [\r\n\t\t\t\t{\r\n\t\t\t\t\tbizCategoryName: '全部经营类目',\r\n\t\t\t\t\tid: '',\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t\tbusinessCategory: '',\r\n\t\t\tdateValue: '',\r\n\t\t\tcurrentSelectStartTime: '',\r\n\t\t\tpickerOptions: {\r\n\t\t\t\tdisabledDate: time => {\r\n\t\t\t\t\t// console.log('time=======>', time.getDate(), this.dateValue)\r\n\t\t\t\t\tif (this.currentSelectStartTime) {\r\n\t\t\t\t\t\t// 只能选择在面板点击的开始时间到前后一年的范围\r\n\t\t\t\t\t\tlet curDate = this.currentSelectStartTime.getTime();\r\n\t\t\t\t\t\tlet oneYear = 365 * 24 * 3600 * 1000;\r\n\t\t\t\t\t\t// 后一年\r\n\t\t\t\t\t\tlet afterYear = curDate + oneYear;\r\n\t\t\t\t\t\t// 往前一年\r\n\t\t\t\t\t\tlet beforeYear = curDate - oneYear;\r\n\t\t\t\t\t\treturn time.getTime() > new Date().getTime() || ((time.getTime() > afterYear || time.getTime() < curDate) && (time.getTime() < beforeYear || time.getTime() > curDate));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn time.getTime() > new Date().getTime();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tonPick: time => {\r\n\t\t\t\t\t// 选择当前开始的时间\r\n\t\t\t\t\tthis.currentSelectStartTime = time.minDate;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tareaValue: {\r\n\t\t\t\tids: [],\r\n\t\t\t\tlevel: '',\r\n\t\t\t},\r\n\t\t\treportList: [\r\n\t\t\t\t{\r\n\t\t\t\t\tstatus: 0,\r\n\t\t\t\t\ttext: '全部经营主体',\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tstatus: 1,\r\n\t\t\t\t\ttext: '已上报',\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tstatus: 2,\r\n\t\t\t\t\ttext: '未上报',\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t\treportStatus: 0,\r\n\t\t\tstartAreaId: '',\r\n\t\t\tsortDirection: 1,\r\n\t\t\tsortField: 1,\r\n\t\t\tdefaultSort: 'descending',\r\n\t\t\ttableHeight: 0,\r\n\t\t\tloading: false,\r\n\t\t\tcountsFlag: '1',\r\n\t\t\texcelLoading: false,\r\n\t\t\tisModalShow: false,\r\n\t\t\tisRunBall: false,\r\n\t\t\tisAddNum: false,\r\n\t\t\tfarmStatistics: {},\r\n\t\t};\r\n\t},\r\n\tbeforeRouteEnter(to, from, next) {\r\n\t\tif (from.name === 'farmdetail' || from.name === 'gisfarmdetail') {\r\n\t\t\tfarmRecordSessionStorage = SessionStorage.get('farmRecordSessionStorage');\r\n\t\t} else {\r\n\t\t\tfarmRecordSessionStorage = '';\r\n\t\t}\r\n\t\tnext();\r\n\t},\r\n\tcreated() {\r\n\t\tif (farmRecordSessionStorage) {\r\n\t\t\tthis.keyword = farmRecordSessionStorage.keyword;\r\n\t\t\tthis.pageSize = farmRecordSessionStorage.pageSize;\r\n\t\t\tthis.currentPage = farmRecordSessionStorage.currentPage;\r\n\t\t\tthis.businessCategory = farmRecordSessionStorage.businessCategory;\r\n\t\t\tthis.dateValue = farmRecordSessionStorage.dateValue;\r\n\t\t\tthis.reportStatus = farmRecordSessionStorage.reportStatus;\r\n\t\t\tthis.sortDirection = farmRecordSessionStorage.sortDirection;\r\n\t\t} else {\r\n\t\t\tthis.keyword = '';\r\n\t\t\tthis.pageSize = 15;\r\n\t\t\tthis.currentPage = 1;\r\n\t\t\tthis.businessCategory = '';\r\n\t\t\tthis.dateValue = '';\r\n\t\t\tthis.reportStatus = 0;\r\n\t\t\tthis.sortDirection = 1;\r\n\t\t}\r\n\t\tthis.getBusinessCategory();\r\n\t\tthis.getFarmRecordList();\r\n\t\tthis.getListGroupFarmMissionStatistics();\r\n\t},\r\n\tmounted() {\r\n\t\tthis.$nextTick(() => {\r\n\t\t\tthis.tableHeight = this.$refs.listContent.offsetHeight;\r\n\t\t});\r\n\t\twindow.addEventListener('resize', this.resizeHandle, false);\r\n\t},\r\n\tbeforeRouteLeave(to, from, next) {\r\n\t\t// 如果进入farm详情页，缓存过滤条件，用于从详情页返回保持过滤条件\r\n\t\tif (to.name === 'farmdetail' || to.name === 'gisfarmdetail') {\r\n\t\t\tSessionStorage.set('farmRecordSessionStorage', {\r\n\t\t\t\tkeyword: this.keyword,\r\n\t\t\t\tpageSize: this.pageSize,\r\n\t\t\t\tcurrentPage: this.currentPage,\r\n\t\t\t\tbusinessCategory: this.businessCategory,\r\n\t\t\t\tdateValue: this.dateValue,\r\n\t\t\t\treportStatus: this.reportStatus,\r\n\t\t\t\tsortDirection: this.sortDirection,\r\n\t\t\t});\r\n\t\t}\r\n\t\tnext();\r\n\t},\r\n\tcomputed: {\r\n\t\t// 监管层级\r\n\t\tlevel() {\r\n\t\t\treturn getStorage('govGovernmentSubjectVO').subjectLevel;\r\n\t\t},\r\n\t\t// 监管地区id\r\n\t\tstartId() {\r\n\t\t\tlet storage = getStorage('govGovernmentSubjectVO');\r\n\t\t\tlet level = getStorage('govGovernmentSubjectVO').subjectLevel;\r\n\r\n\t\t\tif (level === 1) {\r\n\t\t\t\treturn storage.provinceId;\r\n\t\t\t}\r\n\t\t\tif (level === 2) {\r\n\t\t\t\treturn storage.cityId;\r\n\t\t\t}\r\n\t\t\tif (level === 3) {\r\n\t\t\t\treturn storage.countyId;\r\n\t\t\t}\r\n\t\t},\r\n\t},\r\n\tmethods: {\r\n\t\tback() {\r\n\t\t\tvar tempPath = this.$route.path;\r\n\t\t\tthis.$router.go(-1);\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tif (tempPath === this.$route.path) {\r\n\t\t\t\t\tthis.back();\r\n\t\t\t\t}\r\n\t\t\t}, 200);\r\n\t\t},\r\n\t\tgoFarm(row) {\r\n\t\t\tthis.$router.push(`/farmdetail/${row.farmId}`);\r\n\t\t},\r\n\t\tasync download() {\r\n\t\t\tthis.isModalShow = false;\r\n\r\n\t\t\tif (!this.farmRecordList.length) {\r\n\t\t\t\tthis.$message({\r\n\t\t\t\t\ttype: 'info',\r\n\t\t\t\t\tmessage: '暂无数据，无法导出',\r\n\t\t\t\t\tcenter: true,\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst defaultArea = areaLevelCorAreaId();\r\n\t\t\tconst userInfo = getStorage('govGovernmentUserVO');\r\n\r\n\t\t\t// let ids = this.areaValue.villageId ? [this.areaValue.villageId] : (this.areaValue.townId ? [this.areaValue.townId] : this.areaValue.ids);\r\n\r\n\t\t\tconst options = {\r\n\t\t\t\tfarmAreaId: this.areaValue.ids.length ? [this.areaValue.ids[this.areaValue.ids.length - 1]] : [defaultArea.farmAreaId],\r\n\t\t\t\tfarmAreaType: this.areaValue.level ? this.areaValue.level : defaultArea.farmAreaType,\r\n\t\t\t\tkeyword: this.keyword ? this.keyword : '',\r\n\t\t\t\tpageNo: this.currentPage,\r\n\t\t\t\tpageSize: this.pageSize,\r\n\t\t\t\tbusinessCategoryId: !this.businessCategory ? null : this.businessCategory,\r\n\t\t\t\tfarmingEndTime: this.dateValue.endTime ? this.dateValue.endTime : this.formatDate(new Date().getTime(), '-'),\r\n\t\t\t\tfarmingStartTime: this.dateValue.startTime ? this.dateValue.startTime : this.formatDate(new Date().getTime(), '-', 'startTime'),\r\n\t\t\t\treportStatus: this.reportStatus,\r\n\t\t\t\tsortDirection: this.sortDirection,\r\n\t\t\t\tsortField: this.sortField,\r\n\t\t\t\tgovUserId: userInfo.id,\r\n\t\t\t\ttownId: this.areaValue.townId ? this.areaValue.townId : '',\r\n\t\t\t\tvillageId: this.areaValue.villageId ? this.areaValue.villageId : '',\r\n\t\t\t};\r\n\r\n\t\t\tconst res = await this.$ajax.post(this.$api.downloadExcel.listFarmOperationUploadToServer1, options);\r\n\r\n\t\t\t// console.log('res=======>', res);\r\n\t\t\tif (res.data.respCode === 0) {\r\n\t\t\t\tif (this.isAddNum) {\r\n\t\t\t\t\tthis.isAddNum = false;\r\n\t\t\t\t}\r\n\t\t\t\tthis.isRunBall = true;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.isRunBall = false;\r\n\t\t\t\t\tthis.isAddNum = true;\r\n\t\t\t\t}, 800);\r\n\t\t\t}\r\n\t\t\tif (res.data.respCode === 300) {\r\n\t\t\t\tthis.isModalShow = true;\r\n\t\t\t}\r\n\t\t\t// this.excelLoading = true;\r\n\t\t\t// const defaultArea = areaLevelCorAreaId();\r\n\r\n\t\t\t// const endTime = this.dateValue.endTime ? this.dateValue.endTime : this.formatDate(new Date().getTime(), '-');\r\n\t\t\t// const startTime = this.dateValue.startTime ? this.dateValue.startTime : this.formatDate(new Date().getTime() - 1000 * 60 * 60 * 24 * 30, '-');\r\n\r\n\t\t\t// let filename = `农事填报汇总（${startTime.replace(/-/g, '.')}-${endTime.replace(/-/g, '.')}）`;\r\n\r\n\t\t\t// const res = await downloadExcel(\r\n\t\t\t// \t'/freetekApi/produce/gov/farm/listFarmOperationDownLoad',\r\n\t\t\t// \t{\r\n\t\t\t// \t\tfarmAreaId: this.areaValue.ids.length ? this.areaValue.ids : [defaultArea.farmAreaId],\r\n\t\t\t// \t\tfarmAreaType: this.areaValue.level ? this.areaValue.level : defaultArea.farmAreaType,\r\n\t\t\t// \t\tfarmName: this.keyword,\r\n\t\t\t// \t\tendTime: endTime,\r\n\t\t\t// \t\tstartTime: startTime,\r\n\t\t\t// \t\tcategoryName: !this.businessCategory || this.businessCategory === '全部经营类目' ? '' : this.businessCategory,\r\n\t\t\t// \t\ttownId: this.areaValue.townId ? this.areaValue.townId : null,\r\n\t\t\t// \t\tvillageId: this.areaValue.villageId ? this.areaValue.villageId : null\r\n\t\t\t// \t},\r\n\t\t\t// \tfilename\r\n\t\t\t// );\r\n\t\t\t// if (res.msg === 'success') {\r\n\t\t\t// \tthis.$message({\r\n\t\t\t// \t\ttype: 'success',\r\n\t\t\t// \t\tmessage: '下载成功',\r\n\t\t\t// \t\tcenter: true\r\n\t\t\t// \t});\r\n\t\t\t// \tthis.excelLoading = false;\r\n\t\t\t// } else {\r\n\t\t\t// \tthis.excelLoading = false;\r\n\t\t\t// }\r\n\t\t},\r\n\t\tasync areaCilck(val) {\r\n\t\t\tthis.areaValue = val;\r\n\t\t\tthis.currentPage = 1;\r\n\t\t\tthis.getFarmRecordList();\r\n\t\t\tthis.getListGroupFarmMissionStatistics();\r\n\t\t},\r\n\t\tbusinessChange() {\r\n\t\t\tthis.currentPage = 1;\r\n\t\t\tthis.getFarmRecordList();\r\n\t\t\tthis.getListGroupFarmMissionStatistics();\r\n\t\t},\r\n\t\tdateChange() {\r\n\t\t\tthis.currentPage = 1;\r\n\t\t\tthis.getFarmRecordList();\r\n\t\t\tthis.getListGroupFarmMissionStatistics();\r\n\t\t},\r\n\t\tfocus() {\r\n\t\t\t// 时间选择器focus时清空上次选择的限制\r\n\t\t\tthis.currentSelectStartTime = '';\r\n\t\t},\r\n\t\tonChange(page) {\r\n\t\t\tthis.currentPage = page;\r\n\t\t\tthis.getFarmRecordList();\r\n\t\t},\r\n\t\tchangePageSize(pageSize) {\r\n\t\t\tthis.pageSize = pageSize;\r\n\t\t\tthis.currentPage = 1;\r\n\t\t\tthis.getFarmRecordList();\r\n\t\t},\r\n\t\tclickAndEnter() {\r\n\t\t\tthis.currentPage = 1;\r\n\t\t\tthis.getFarmRecordList();\r\n\t\t\tthis.getListGroupFarmMissionStatistics();\r\n\t\t},\r\n\t\tsortChange(value) {\r\n\t\t\tthis.currentPage = 1;\r\n\t\t\tthis.defaultSort = value.order === 'descending' ? 'descending' : 'ascending';\r\n\t\t\tthis.sortDirection = value.order === 'descending' ? 1 : 0;\r\n\t\t\tthis.getFarmRecordList();\r\n\t\t},\r\n\t\tasync getFarmRecordList() {\r\n\t\t\tthis.farmRecordList = [];\r\n\t\t\tthis.loading = true;\r\n\t\t\tconst defaultArea = areaLevelCorAreaId();\r\n\r\n\t\t\tif (!this.dateValue) {\r\n\t\t\t\tthis.dateValue = {};\r\n\t\t\t\tthis.dateValue.endTime = this.formatDate(new Date().getTime(), '-');\r\n\t\t\t\tthis.dateValue.startTime = this.formatDate(new Date().getTime(), '-', 'startTime');\r\n\t\t\t}\r\n\r\n\t\t\t// let ids = this.areaValue.villageId ? [this.areaValue.villageId] : (this.areaValue.townId ? [this.areaValue.townId] : this.areaValue.ids);\r\n\r\n\t\t\tconst options = {\r\n\t\t\t\tfarmAreaId: this.areaValue.ids.length ? this.areaValue.ids : [defaultArea.farmAreaId],\r\n\t\t\t\tfarmAreaType: this.areaValue.level ? this.areaValue.level : defaultArea.farmAreaType,\r\n\t\t\t\tkeyword: this.keyword ? this.keyword : '',\r\n\t\t\t\tpageNo: this.currentPage,\r\n\t\t\t\tpageSize: this.pageSize,\r\n\t\t\t\tbusinessCategoryId: !this.businessCategory ? null : this.businessCategory,\r\n\t\t\t\tfarmingEndTime: this.dateValue.endTime,\r\n\t\t\t\tfarmingStartTime: this.dateValue.startTime,\r\n\t\t\t\treportStatus: this.reportStatus,\r\n\t\t\t\tsortDirection: this.sortDirection,\r\n\t\t\t\tsortField: this.sortField,\r\n\t\t\t\ttownId: this.areaValue.townId ? this.areaValue.townId : null,\r\n\t\t\t\tvillageId: this.areaValue.villageId ? this.areaValue.villageId : null,\r\n\t\t\t};\r\n\r\n\t\t\tconst res = await this.$ajax.post(this.$api.produce.listFarmOperation1, options);\r\n\r\n\t\t\tif (res.data.respCode === 0 && res.data.obj) {\r\n\t\t\t\tthis.farmRecordList = res.data.obj.list;\r\n\t\t\t\tthis.total = res.data.obj.totalCount;\r\n\t\t\t\tthis.loading = false;\r\n\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\tthis.tableHeight = this.$refs.listContent.offsetHeight;\r\n\t\t\t\t\tthis.backTop();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tthis.loading = false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync getListGroupFarmMissionStatistics() {\r\n\t\t\tconst defaultArea = areaLevelCorAreaId();\r\n\r\n\t\t\tif (!this.dateValue) {\r\n\t\t\t\tthis.dateValue = {};\r\n\t\t\t\tthis.dateValue.endTime = this.formatDate(new Date().getTime(), '-');\r\n\t\t\t\tthis.dateValue.startTime = this.formatDate(new Date().getTime(), '-', 'startTime');\r\n\t\t\t}\r\n\r\n\t\t\t// let ids = this.areaValue.villageId ? [this.areaValue.villageId] : (this.areaValue.townId ? [this.areaValue.townId] : this.areaValue.ids);\r\n\r\n\t\t\tconst options = {\r\n\t\t\t\tfarmAreaId: this.areaValue.ids.length ? this.areaValue.ids : [defaultArea.farmAreaId],\r\n\t\t\t\tfarmAreaType: this.areaValue.level ? this.areaValue.level : defaultArea.farmAreaType,\r\n\t\t\t\tkeyword: this.keyword ? this.keyword : '',\r\n\t\t\t\tbusinessCategoryId: !this.businessCategory ? null : this.businessCategory,\r\n\t\t\t\tfarmingEndTime: this.dateValue.endTime,\r\n\t\t\t\tfarmingStartTime: this.dateValue.startTime,\r\n\t\t\t\ttownId: this.areaValue.townId ? this.areaValue.townId : null,\r\n\t\t\t\tvillageId: this.areaValue.villageId ? this.areaValue.villageId : null,\r\n\t\t\t};\r\n\r\n\t\t\tconst res = await this.$ajax.post(this.$api.produce.listGroupFarmMissionStatistics, options);\r\n\r\n\t\t\tif (res.data.respCode === 0 && res.data.obj) {\r\n\t\t\t\tconsole.log('res.data=====>', res.data);\r\n\t\t\t\tthis.farmStatistics = res.data.obj;\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync getBusinessCategory() {\r\n\t\t\tconst res = await this.$ajax.post(this.$api.produce.businessCategory, {});\r\n\r\n\t\t\tif (res.data.respCode === 0) {\r\n\t\t\t\tres.data.obj.list.forEach(ele => {\r\n\t\t\t\t\tthis.businessCategoryList.push(ele);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tspliceAreaName(row) {\r\n\t\t\tconst storage = getStorage('govGovernmentSubjectVO');\r\n\r\n\t\t\tlet str = '';\r\n\t\t\tstr = row.townName ? str + '/' + row.townName : '';\r\n\t\t\tstr = row.villageName ? (str ? str + '/' + row.villageName : row.villageName) : str ? str : '';\r\n\r\n\t\t\tif (storage.subjectLevel === 1) {\r\n\t\t\t\treturn row.cityName + '/' + row.countyName + str;\r\n\t\t\t}\r\n\r\n\t\t\tif (storage.subjectLevel === 2 || storage.subjectLevel === 3) {\r\n\t\t\t\tlet str1 = row.cityName;\r\n\t\t\t\tstr = row.countyName ? str1 + '/' + row.countyName + str : str;\r\n\r\n\t\t\t\treturn str;\r\n\t\t\t}\r\n\t\t},\r\n\t\tformatDate(time, character, startTime) {\r\n\t\t\tconst date = new Date(time);\r\n\t\t\tlet DD = '';\r\n\t\t\tconst YY = date.getFullYear() + character;\r\n\t\t\tconst MM = (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1) + character;\r\n\t\t\tif (!startTime) {\r\n\t\t\t\tDD = date.getDate() < 10 ? '0' + date.getDate() : date.getDate();\r\n\t\t\t} else {\r\n\t\t\t\tDD = '01';\r\n\t\t\t}\r\n\r\n\t\t\treturn YY + MM + DD;\r\n\t\t},\r\n\t\tformatNum(num) {\r\n\t\t\tif (!num) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\treturn maxDecimalPlaces({\r\n\t\t\t\tvalue: num,\r\n\t\t\t\tplaces: 2,\r\n\t\t\t});\r\n\t\t},\r\n\t\tresizeHandle() {\r\n\t\t\tthis.tableHeight = this.$refs.listContent.offsetHeight;\r\n\t\t},\r\n\t\tbackTop() {\r\n\t\t\tdocument.querySelector('.el-table__body-wrapper').scrollTop = 0;\r\n\t\t},\r\n\t\t// 解决element ui tooltip点击后，切换页面回来后，tip出现的问题\r\n\t\tbuttonClick(e) {\r\n\t\t\te.target.blur();\r\n\t\t},\r\n\t},\r\n\tdestroyed() {\r\n\t\twindow.removeEventListener('resize', this.resizeHandle, false);\r\n\t},\r\n\tcomponents: {\r\n\t\tNav,\r\n\t\tPage,\r\n\t\tLoading,\r\n\t\tCustomInput,\r\n\t\tCustomSelect,\r\n\t\tCustomTable,\r\n\t\tCustomTableSort,\r\n\t\tCustomDatePicker,\r\n\t\tCustomAreaSelect,\r\n\t\tdownloadModal,\r\n\t\tRunBall,\r\n\t},\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.farm-record-other {\r\n\toverflow: hidden;\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\theight: 100vh;\r\n\tmin-width: 1366px;\r\n\tmin-height: 696px;\r\n\tbox-sizing: border-box;\r\n\tbackground-color: #021220;\r\n\r\n\t.main {\r\n\t\tflex: 1;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\theight: 100%;\r\n\t\tbox-sizing: border-box;\r\n\t\toverflow: hidden;\r\n\r\n\t\t.search-box {\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: space-between;\r\n\t\t\tpadding: 28px 50px 21px;\r\n\r\n\t\t\t.search-box-left {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t}\r\n\r\n\t\t\t.excel-box {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\r\n\t\t\t\t.excel {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tjustify-content: center;\r\n\t\t\t\t\twidth: 120px;\r\n\t\t\t\t\theight: 36px;\r\n\t\t\t\t\tmargin-left: 15px;\r\n\t\t\t\t\tborder: 1px solid #145763;\r\n\t\t\t\t\tborder-radius: 2px;\r\n\t\t\t\t\tbackground-color: #24969a;\r\n\t\t\t\t\tcolor: #d9e3ed;\r\n\t\t\t\t\tfont-size: 14px;\r\n\t\t\t\t\tcursor: pointer;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.list-content {\r\n\t\t\tflex: 1;\r\n\t\t\tdisplay: flex;\r\n\t\t\tflex-direction: column;\r\n\t\t\toverflow: hidden;\r\n\t\t\theight: 100%;\r\n\t\t}\r\n\t}\r\n\r\n\t.handle {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tfont-size: 14px;\r\n\t\tcolor: #20a8f8;\r\n\t\tcursor: pointer;\r\n\r\n\t\t.iconfont {\r\n\t\t\tfont-size: 23px;\r\n\t\t}\r\n\t}\r\n\t.handle.handle-disabled {\r\n\t\tcolor: #aaaaaa;\r\n\t\tcursor: not-allowed;\r\n\t}\r\n\r\n\t.custom-header-text {\r\n\t\tfont-size: 14px;\r\n\t\tfont-family: Microsoft YaHei;\r\n\t\tfont-weight: 400;\r\n\t\tcolor: #24969a;\r\n\t}\r\n\t.text-ellipsis {\r\n\t\tword-break: break-all;\r\n\t\ttext-overflow: ellipsis;\r\n\t\toverflow: hidden;\r\n\t\tdisplay: -webkit-box;\r\n\t\t-webkit-line-clamp: 2;\r\n\t\t-webkit-box-orient: vertical;\r\n\t\toutline: none;\r\n\t}\r\n\t.text {\r\n\t\tcolor: #a1acb7;\r\n\t\tfont-size: 14px;\r\n\t}\r\n\t.text-bold {\r\n\t\tcolor: #a1acb7;\r\n\t\tfont-weight: bold;\r\n\t\tfont-size: 14px;\r\n\t}\r\n\t.text-hover {\r\n\t\tcolor: #1d9096;\r\n\t}\r\n\t.text-hover:hover {\r\n\t\tborder-bottom: 1px solid #1d9096;\r\n\t}\r\n\t.text-blue {\r\n\t\tcolor: #1d9096;\r\n\t}\r\n\t.text-green {\r\n\t\tcolor: #16b665;\r\n\t}\r\n\t.value-text {\r\n\t\tcolor: #a1acb7;\r\n\t\tfont-weight: bold;\r\n\t\tfont-size: 14px;\r\n\t}\r\n\r\n\t.page-box {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\theight: 88px;\r\n\t\tpadding: 0 40px;\r\n\t\tbackground: #021220;\r\n\t\tbox-shadow: 0px -3px 21px 0px rgba(4, 52, 82, 0.2);\r\n\r\n\t\t.farm-statistics {\r\n\t\t\tspan {\r\n\t\t\t\tmargin-right: 10px;\r\n\t\t\t\tcolor: #24969a;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.no-data {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t}\r\n}\r\n</style>\r\n\r\n<style lang=\"scss\">\r\n.farm-record-other {\r\n\t.custom-table {\r\n\t\t/deep/ .el-table {\r\n\t\t\t.el-table__header {\r\n\t\t\t\t// padding-right: 20px;\r\n\t\t\t}\r\n\r\n\t\t\ttr td.el-table_1_column_6_column_7,\r\n\t\t\ttr:nth-child(2) th:nth-child(1) {\r\n\t\t\t\tpadding-left: 0;\r\n\t\t\t}\r\n\t\t\tthead tr:nth-child(1) th:nth-child(5) {\r\n\t\t\t\t// border-bottom: 1px solid #010b14;\r\n\t\t\t}\r\n\r\n\t\t\tthead tr:nth-child(1) th:nth-child(1),\r\n\t\t\ttbody tr td:nth-child(1) {\r\n\t\t\t\tpadding-right: 15px;\r\n\t\t\t}\r\n\t\t\tthead tr:nth-child(1) th:nth-child(2),\r\n\t\t\tthead tr:nth-child(1) th:nth-child(3),\r\n\t\t\tthead tr:nth-child(1) th:nth-child(4) {\r\n\t\t\t\tpadding: 10px 20px;\r\n\t\t\t}\r\n\r\n\t\t\ttbody tr td:nth-child(2),\r\n\t\t\ttbody tr td:nth-child(3),\r\n\t\t\ttbody tr td:nth-child(4) {\r\n\t\t\t\tpadding: 10px 20px;\r\n\t\t\t}\r\n\r\n\t\t\tthead tr th,\r\n\t\t\ttbody tr td {\r\n\t\t\t\t// border-right: 1px solid #010b14;\r\n\t\t\t}\r\n\t\t\ttbody tr:last-child td {\r\n\t\t\t\t// border-bottom: 1px solid #010b14;\r\n\t\t\t}\r\n\t\t\tthead tr:nth-child(2) th {\r\n\t\t\t\tpadding: 5px 0;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n.farm-record-custom-tooltip-light.el-tooltip__popper {\r\n\twidth: 200px;\r\n\t// overflow-y: scroll;\r\n\tbackground-color: #f4f7f9 !important;\r\n\tbox-shadow: 0px 3px 9px 0px rgba(0, 0, 0, 0.13) !important;\r\n\tcolor: #485256;\r\n\tline-height: 24px;\r\n\r\n\t.popper__arrow {\r\n\t\tbottom: -12px;\r\n\t\tborder-color: transparent !important;\r\n\t\tborder-top-color: #f4f7f9 !important;\r\n\t\tborder-width: 6px !important;\r\n\t\tborder-style: solid !important;\r\n\t}\r\n\t.tooltip-box {\r\n\t\tmax-height: 160px;\r\n\t\toverflow: hidden;\r\n\t\toverflow-y: auto;\r\n\t}\r\n}\r\n.farm-record-custom-tooltip-dark.el-tooltip__popper {\r\n\twidth: 200px;\r\n\tline-height: 24px;\r\n\r\n\t.popper__arrow {\r\n\t\tbottom: -12px;\r\n\t\tborder-color: transparent !important;\r\n\t\tborder-top-color: rgba(0, 0, 0, 0.9) !important;\r\n\t\tborder-width: 6px !important;\r\n\t\tborder-style: solid !important;\r\n\t}\r\n\t.tooltip-box {\r\n\t\tmax-height: 160px;\r\n\t\toverflow: hidden;\r\n\t\toverflow-y: auto;\r\n\t}\r\n}\r\n.farm-record-other > .el-loading-mask {\r\n\ti {\r\n\t\tcolor: #00e5ff;\r\n\t\tfont-size: 40px;\r\n\t}\r\n\tp {\r\n\t\tcolor: #00e5ff;\r\n\t\tline-height: 40px;\r\n\t\tfont-size: 18px;\r\n\t}\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/pages/overview/farmRecordListOther.vue"],"mappings":"AA6JA","sourceRoot":""}