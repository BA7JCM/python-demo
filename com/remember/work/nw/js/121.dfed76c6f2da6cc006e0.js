webpackJsonp([121],{"77TN":function(e,t){},mder:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("446f"),a=r("VCTt"),o=r("VKKs"),i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&c.return&&c.return()}finally{if(a)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function c(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,o){try{var i=t[a](o),c=i.value}catch(e){return void r(e)}if(!i.done)return Promise.resolve(c).then(function(e){n("next",e)},function(e){n("throw",e)});e(c)}("next")})}}var s=(new Date).getFullYear(),u=(new Date).getMonth(),l=Object(a.h)({startTime:s+"-01-01",howMonth:u}),p=s-1,f=Object(a.h)({startTime:p+"-01-01"}),d={title:{show:!1,text:"暂无数据",textStyle:{fontSize:12,color:"#6DC1CB"},left:"center",top:"center"},grid:{show:!0,borderColor:"#0D394A",bottom:30,top:40,right:20},tooltip:{show:!0,trigger:"axis",formatter:function(e){var t=e.map(function(e){return null!==e.value?e.seriesName+"："+Object(a.j)({value:e.value})+"元/公斤":""});return e[0].axisValue+"<br/>"+t.join("<br />")},backgroundColor:"#043250",padding:[13,14,13,11],textStyle:{fontSize:12,color:"#9ED2D8"}},legend:{show:!0,type:"plain",textStyle:{color:"#6DC1CB",fontSize:12},backgroundColor:"rgba(255, 255, 255, 0)",top:3,right:10,itemWidth:30,itemHeight:10,height:20,data:[{name:(new Date).getFullYear()-1+"年",icon:"image://"+r("Zg+v")},{name:(new Date).getFullYear()+"年",icon:"image://"+r("IG9e")}]},xAxis:{data:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],boundaryGap:!1,axisLabel:{textStyle:{color:"#6DC1CB",fontSize:12},align:"center"},axisTick:{show:!1},axisLine:{show:!0,lineStyle:{color:"rgba(109,193,203,0.2)"}},z:10},yAxis:{name:"(元/公斤)",nameTextStyle:{fontSize:12,color:"#6DC1CB",padding:[4,8,5,10]},axisLine:{show:!1,lineStyle:{color:"#0D394A"}},axisTick:{show:!1},splitLine:{show:!0,lineStyle:{color:"rgba(109,193,203,0.2)"}},axisLabel:{textStyle:{color:"#6DC1CB",fontSize:12}}},series:[{data:[],type:"line",smooth:!0,symbolSize:0,areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(0, 162, 255, 0.5)"},{offset:1,color:"rgba(60, 105, 217, 0)"}],global:!1}},lineStyle:{color:"#00FFFF"}},{data:[],type:"line",smooth:!0,symbolSize:0,areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(212, 167, 84, 0.5)"},{offset:1,color:"rgba(212, 167, 84, 0)"}],global:!1}},lineStyle:{color:"#D4A754"}}]},h=Object(o.b)("govGovernmentSubjectVO"),g=Object(o.b)("vegetableVariety"),m={name:"PriceTrend",props:{farmAreaInfo:{type:Object,default:function(){return Object(a.b)()}}},data:function(){return{chart:null,loading:!1,priceType:0,priceTypeList:[{name:"田头价",id:0},{name:"批发价",id:1}],vegetableVariety:[],cropId:null}},created:function(){},mounted:function(){this.initPage(),window.addEventListener("resize",this.resizeChart,!1)},methods:{getTtjCropList:function(){return this.$ajax.post(this.$api.operate.ttjCropList,{pageNo:1,pageSize:1e4}).then(function(e){var t=e.data;if(0===t.respCode)return t.obj;throw new Error(t)}).catch(function(e){throw console.log(e),e})},getDefaultCropList:function(){return this.$ajax.post(this.$api.market.cropList,{areaId:h.provinceId,keyword:"",pageNo:1,pageSize:1e4}).then(function(e){var t=e.data;if(0===t.respCode)return Object(o.c)("cropTime",t.curDate),t.obj;throw new Error(t)}).catch(function(e){throw console.log(e),e})},getCropPriceStatisticList:function(){return this.$ajax.post(this.$api.operate.cropPriceStatisticList,{yearsList:[""+(new Date).getFullYear(),""+((new Date).getFullYear()-1)],cropId:this.cropId,provinceId:h.provinceId}).then(function(e){var t=e.data;if(0===t.respCode)return t.obj;throw new Error(t)}).catch(function(e){throw e})},getDefaultStatisticList:function(){return this.$ajax.all([this.$ajax.post(this.$api.market.cropPrice,{dateListStr:l,nccropId:this.cropId,proviceId:h.provinceId}),this.$ajax.post(this.$api.market.cropPrice,{dateListStr:f,nccropId:this.cropId,proviceId:h.provinceId})]).then(function(e){var t=i(e,2),r=t[0],n=t[1];if(0===r.data.respCode||0===n.data.respCode)return[{data:r.data.obj},{data:n.data.obj}];throw new Error([JSON.stringify(r.data,null,"\t"),JSON.stringify(n.data,null,"\t")].join(","))}).catch(function(e){throw e})},processDefaultCropList:function(){var e=this;return c(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise(function(t,r){if(e.checkCropReload()&&g&&g.length){e.vegetableVariety=g.map(function(e){return{crop:e.ncCropName,cropId:e.id}});try{return e.cropId=g[0].id,t()}catch(e){console.log(e),r(e)}}else e.getDefaultCropList().then(function(n){Object(o.c)("vegetableVariety",n.list),e.vegetableVariety=n.list.map(function(e){return{crop:e.ncCropName,cropId:e.id}});try{return e.cropId=e.vegetableVariety[0].cropId,t()}catch(e){console.log(e),r(e)}}).catch(function(e){console.log(e),r(e)})});case 2:case"end":return t.stop()}},t,e)}))()},processTtjCropList:function(){var e=this;return c(regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getTtjCropList();case 3:r=t.sent,e.vegetableVariety=r.list.map(function(e){return{crop:e.cropName,cropId:e.id}}),e.cropId=e.vegetableVariety[0].cropId,t.next=12;break;case 8:throw t.prev=8,t.t0=t.catch(0),console.log(t.t0),t.t0;case 12:case"end":return t.stop()}},t,e,[[0,8]])}))()},processDefaultPriceList:function(){var e=this;return c(regeneratorRuntime.mark(function t(){var r,n,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getDefaultStatisticList();case 3:return r=t.sent,n=r[0].data.map(function(e){return e.price}),a=r[1].data.map(function(e){return e.price}),t.abrupt("return",[n,a]);case 9:throw t.prev=9,t.t0=t.catch(0),t.t0;case 12:case"end":return t.stop()}},t,e,[[0,9]])}))()},processTtjPriceList:function(){var e=this;return c(regeneratorRuntime.mark(function t(){var r,n,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getCropPriceStatisticList();case 3:return r=t.sent,n=r[0].data.slice(0,12).map(function(e){return Number(e)}),a=r[1].data.slice(0,12).map(function(e){return Number(e)}),t.abrupt("return",[n,a]);case 9:throw t.prev=9,t.t0=t.catch(0),t.t0;case 12:case"end":return t.stop()}},t,e,[[0,9]])}))()},updateCropList:function(){var e=this;return c(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.vegetableVariety=[],!e.priceType){t.next=6;break}return t.next=4,e.processDefaultCropList();case 4:t.next=8;break;case 6:return t.next=8,e.processTtjCropList();case 8:case"end":return t.stop()}},t,e)}))()},updateCropPrice:function(){var e=this;return c(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.updateChart();case 3:e.loading=!1;case 4:case"end":return t.stop()}},t,e)}))()},updateChart:function(){var e=this;return c(regeneratorRuntime.mark(function t(){var r,n,o,c,s,u,l,p,f;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=null,!e.priceType){t.next=8;break}return t.next=5,e.processDefaultPriceList();case 5:r=t.sent,t.next=11;break;case 8:return t.next=10,e.processTtjPriceList();case 10:r=t.sent;case 11:n=i(r,2),o=n[0],c=n[1],s=o.reduce(function(e,t){return e+t}),u=c.reduce(function(e,t){return e+t}),l=(new Date).getFullYear(),p=l-1,f=0!==s||0!==u,e.chart.setOption({tooltip:{show:f},title:{show:!f},yAxis:{show:!0},xAxis:{show:f},series:f?[{name:Object(a.c)(p+"-01-01","yyyy年"),data:c.map(function(e,t){return{name:t+1+"月",value:e}}),symbol:"circle",symbolSize:2,color:"#00F6FF"},{name:Object(a.c)(l+"-01-01","yyyy年"),data:o.map(function(e,t){return{name:t+1+"月",value:e}}),symbol:"circle",symbolSize:2,color:"#FBC02D"}]:[{data:[]},{data:[]}]}),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(0),console.log(t.t0);case 23:case"end":return t.stop()}},t,e,[[0,20]])}))()},initPage:function(){var e=this;return c(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.chart=e._initEcharts(e.eContainerRef,d),t.next=3,e.updateCropList();case 3:e.getDefaultStatisticList(),e.updateCropPrice();case 5:case"end":return t.stop()}},t,e)}))()},selectPriceType:function(){var e=this;return c(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.updateCropList();case 2:e.chart.setOption({series:[{data:[]},{data:[]}]}),e.updateCropPrice(),e.$nextTick(function(){e.$refs.priceType.blur()});case 5:case"end":return t.stop()}},t,e)}))()},selectCrop:function(){var e=this;this.chart.setOption({series:[{data:[]},{data:[]}]}),this.updateCropPrice(),this.$nextTick(function(){e.$refs.cropSearch.blur()})},checkCropReload:function(){var e=Object(o.b)("cropTime");if(!e)return!0;e=Number(e);var t=new Date(e).getMonth();return new Date(e).setMonth(t+1,1)>=(new Date).getTime()},_initEcharts:function(e,t){var r=this.$echarts.init(e);return r.setOption(t),r},resizeChart:function(){this.chart&&this.chart.resize()}},computed:{eContainerRef:function(){return this.$refs.EContainer}},components:{BoxItem:n.default}},b=r("W5g0");var v=function(e){r("77TN")},y=Object(b.a)(m,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("box-item",{attrs:{title:"田头价格监测",position:"left",loading:e.loading}},[r("div",{staticClass:"sub-title",attrs:{slot:"subTitle"},slot:"subTitle"},[r("el-select",{ref:"priceType",staticClass:"vegetable-select",attrs:{slot:"subTitle",placeholder:"请选择",filterable:""},on:{change:e.selectPriceType},slot:"subTitle",model:{value:e.priceType,callback:function(t){e.priceType=t},expression:"priceType"}},e._l(e.priceTypeList,function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1),e._v(" "),r("el-select",{ref:"cropSearch",staticClass:"vegetable-select",attrs:{slot:"subTitle",placeholder:"请选择",filterable:""},on:{change:e.selectCrop},slot:"subTitle",model:{value:e.cropId,callback:function(t){e.cropId=t},expression:"cropId"}},e._l(e.vegetableVariety,function(e,t){return r("el-option",{key:t,attrs:{label:e.crop,value:e.cropId}})}),1)],1),e._v(" "),r("div",{ref:"EContainer",staticClass:"echart-container"})])},[],!1,v,"data-v-3a38fd93",null);t.default=y.exports}});
//# sourceMappingURL=121.dfed76c6f2da6cc006e0.js.map