{"version":3,"file":"static/js/132.772d57381c558606ead2.js","sources":["webpack:///src/components/overview/modules/plot-video-10.vue"],"sourcesContent":["<template>\n\t<div class=\"gov-area-panel\" v-loading=\"mainLoading\" element-loading-spinner=\"iconfont icon-loading1\" element-loading-background=\"rgba(0, 0, 0, 0.2)\">\n\t\t<area-panel area-title=\"物联网监控\" subTitle=\"更多\" @hand-sub-title=\"handlePage\">\n\t\t\t<div slot=\"panelMain\" class=\"video-container\">\n\t\t\t\t<p class=\"video-head\">{{ farmName }}</p>\n\t\t\t\t<div class=\"video-wrap\">\n\t\t\t\t\t<hls-video video-id=\"baseDefaultVideo\" :video-quality=\"videoInfo\" v-if=\"showVideo\"></hls-video>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</area-panel>\n\t</div>\n</template>\n\n<script>\nimport areaPanel from '@/components/overview/area-panel';\nimport hlsVideo from '@/components/common/video';\nimport destroyVideos from '@/common/fn/destroyVideos';\nimport {areaLevelCorAreaId} from '@/common/fn';\n\nexport default {\n\tname: 'plot-video-10',\n\tprops: {\n\t\tfarmAreaInfo: {\n\t\t\ttype: Object,\n\t\t\tdefault() {\n\t\t\t\treturn areaLevelCorAreaId();\n\t\t\t}\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tvideoInfo: null,\n\t\t\tmainLoading: true,\n\t\t\tfarmId: process.env.NODE_ENV === 'development' ? '3746' : '3573',\n\t\t\tfarmName: '',\n\t\t\tshowVideo: false\n\t\t};\n\t},\n\tmounted() {\n\t\tthis.$nextTick(() => {\n\t\t\tthis.stopRender();\n\t\t\tthis.initMoudle();\n\t\t});\n\t},\n\tdestroyed() {\n\t\tthis.stopRender();\n\t},\n\tmethods: {\n\t\tasync initMoudle() {\n\t\t\tthis.stopRender(); //停止加载上一个视频\n\t\t\tthis.showVideo = false; // 使视频组件强制更新，应用最新 url\n\t\t\tconst res = await this.getAreaCameraListByArea();\n\t\t\tthis.mainLoading = false;\n\t\t\tif (!res || !res.list.length) {\n\t\t\t\tthis.farmName = '未配置示例摄像头';\n\t\t\t\tthis.videoInfo = null;\n\t\t\t} else {\n\t\t\t\tthis.videoInfo = res.list[0];\n\t\t\t\tthis.farmId = res.list[0].farmId;\n\t\t\t\tthis.farmName = res.list[0].farmName;\n\t\t\t}\n\t\t\tthis.showVideo = true;\n\t\t},\n\t\tstopRender() {\n\t\t\tdestroyVideos();\n\t\t},\n\t\t// 获取农场下的所有物联网设备\n\t\tgetAllIoTTheFarm() {\n\t\t\treturn this.$ajax\n\t\t\t\t.post(this.$api.farmDetail.getIotAll, {\n\t\t\t\t\tfarmId: this.farmId\n\t\t\t\t})\n\t\t\t\t.then(({data}) => {\n\t\t\t\t\tif (data.respCode === 0) {\n\t\t\t\t\t\treturn data.obj;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(e => {\n\t\t\t\t\tconsole.log(new Error('获取农场下的所有物联网设备'), e);\n\t\t\t\t});\n\t\t},\n\t\t// 获取农场下的所有物联网设备\n\t\tgetAreaCameraListByArea() {\n\t\t\treturn this.$ajax\n\t\t\t\t.post(this.$api.areaCameraConfig.listByArea, {\n\t\t\t\t\tfarmAreaId: [this.farmAreaInfo.farmAreaId],\n\t\t\t\t\tfarmAreaType: this.farmAreaInfo.farmAreaType\n\t\t\t\t})\n\t\t\t\t.then(({data}) => {\n\t\t\t\t\tif (data.respCode === 0) {\n\t\t\t\t\t\treturn data.obj;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(e => {\n\t\t\t\t\tconsole.log(new Error('获取农场下的所有物联网设备'), e);\n\t\t\t\t});\n\t\t},\n\t\thandlePage() {\n\t\t\tif (!this.videoInfo) {\n\t\t\t\tthis.$message({\n\t\t\t\t\ttype: 'warning',\n\t\t\t\t\tmessage: '未配置示例基地',\n\t\t\t\t\tcenter: true\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.$router.push({\n\t\t\t\t\tpath: `/iotDevice/${this.farmId}`,\n\t\t\t\t\tquery: {\n\t\t\t\t\t\tfarmName: this.farmName\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\tcomponents: {\n\t\tareaPanel,\n\t\thlsVideo\n\t}\n};\n</script>\n\n<style scoped lang=\"less\">\n.gov-area-panel {\n\twidth: 100%;\n\theight: 100%;\n\t/*min-width: 364px;\n    min-height: 295px;*/\n\tbackground-color: fade(#061f36, 34%);\n\t.video-container {\n\t\theight: 100%;\n\t\twidth: 95%;\n\t\tmargin: 0 auto;\n\t\t.video-head {\n\t\t\theight: 40px;\n\t\t\tline-height: 40px;\n\t\t\tcolor: #00e5ff;\n\t\t\tfont-weight: 400;\n\t\t\tfont-size: 14px;\n\t\t\ttext-align: center;\n\t\t\tbackground-color: #010b20;\n\t\t}\n\t\t.video-wrap {\n\t\t\t/*height: 190px;*/\n\t\t\theight: calc(100% - 60px);\n\t\t\tbackground-color: #010b20;\n\t\t}\n\t}\n\t/deep/ .el-loading-spinner {\n\t\toverflow: hidden;\n\t\t.iconfont {\n\t\t\tdisplay: block;\n\t\t\tfont-size: 40px;\n\t\t\tcolor: #00f6ff;\n\t\t\tanimation: loading 1.25s linear infinite;\n\t\t\tmargin-top: 24px;\n\t\t\tmargin-left: 8px;\n\t\t}\n\t}\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/overview/modules/plot-video-10.vue"],"mappings":"AAmBA","sourceRoot":""}