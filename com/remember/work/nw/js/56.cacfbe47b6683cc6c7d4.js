webpackJsonp([56,66,78],{"+BDs":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAABf0lEQVQ4jb3TQYiNURjG8d93cYlrpcRCYjMxYaGU7G2JLGcrWdqwtrCYja0dJUnN3maSBaVkJRsKGSOykTETMh4L55rv3rn3u3ckb719X+855/8+55zn8I+j+vOX1OstnMZJHMR6vMRd3MCX1aSqr5B0c7/kqSSSn5I3kueS76X2UXKiNr9fTA/wgORTWXxFsrO2qCM5K/kgWZZMjQJulLyQfJMcX6VgJXcV1V8lE03Ac2VLFxtg3TxW5t5qAt6TLEk2jwEkeSBZKDvruc1uHMZjLA1oNyjuo4O99WId2MHimDBWrLNtGHAeu9cA3FO+bwcPJzfLQU+OcX6bJO8kr5ou5Ugx8qxk3Qjg5dL8wihjXysT7xQj94Nakkul8ZOitAfY/5bbuI1TeI/reIQf2IcpHMIzXMV2TGO56S1XkvOS+aK2nouSacnW4ttIZiTtYQrrsQFH/fZZG3N4iM9lfBKz2IEZVXVmmMK15IRkTvJ6HIXjxha0VNXC3wL+b/wCW8SP4yTIK98AAAAASUVORK5CYII="},"0NJ0":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("wggp"),a=r.n(n),i=r("ji7R"),s=r("ydj4"),o=r("VKKs"),c=r("PbuP"),l=r("yTDo"),u=r("jIOT"),p=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(a)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function d(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function g(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,i){try{var s=t[a](i),o=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(o).then(function(e){n("next",e)},function(e){n("throw",e)});e(o)}("next")})}}var f=Object(o.b)("govGovernmentSubjectVO"),h={data:function(){return{temptoken:"",serverLayers:{},companyProfile:null,companyLayers:{},plotLayers:null,landId:"",gisType:0,plotId:"",plotdialogVisible:!1,plotTabIndex:1,gismap:null,searchStr:"",searchText:"",nowSubjectCrop:"",searchResultWord:"",tileMap:{weixing:"/shanghaiArcGIS/rest/services/SHMAP_IMAGE/MapServer"},serviceMap:{nongyongdi:"",hzssc_dapeng:"",hezuosheNaturalBorder:""},homeLatLng:[121.12961431068945,30.979833911253177,121.69403691811132,31.266851733518802],options:{url:"http://gov.snkoudai.com/mapdemo/arcgis3.28/init.js"},inCompanySearch:!1,layershow:{service:["农用地","蔬菜大棚"],companyService:["农用地","蔬菜大棚"]},gisloading:!1,iconobj:{subject:r("u2Yj"),plot:r("9dcc"),area:r("g6+4"),arrow:r("tbsX")},brightMode:!1,pcListTipsShow:!1,pcListTipsScroll:null,wxLayerUpdateEnd:!1,corpActiveId:"",farmActiveId:"",tempAllPlotId:[],landPop:{landPopVisible:!1,landDetailData:{}}}},watch:{layershow:{handler:function(e){var t=e.service,r=e.companyService;-1!==t.indexOf("农用地")?this.serverLayers.nongyongdi.show():this.serverLayers.nongyongdi.hide(),-1!==t.indexOf("蔬菜大棚")?this.serverLayers.hzssc_dapeng.show():this.serverLayers.hzssc_dapeng.hide(),-1!==r.indexOf("农用地")?this.companyLayers.nongyongdi.show():this.companyLayers.nongyongdi.hide(),-1!==r.indexOf("蔬菜大棚")?this.companyLayers.hzssc_dapeng.show():this.companyLayers.hzssc_dapeng.hide()},deep:!0},brightMode:function(e){var t=document.getElementById("gismap_weixing_ditu");-1===t.className.indexOf("bright-mode")&&e?document.getElementById("gismap_weixing_ditu").className="bright-mode":-1===t.className.indexOf("bright-mode")||e||(document.getElementById("gismap_weixing_ditu").className="")},pcListTipsShow:function(e){var t=this;return g(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:t.showCropOrTypeSubjectList(e);case 1:case"end":return r.stop()}},r,t)}))()}},computed:{},props:[],mounted:function(){var e=this;return g(regeneratorRuntime.mark(function t(){var r,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=Object(o.b)("govGovernmentSubjectVO"),n="310100",r&&r.cityId&&2===r.subjectLevel&&(n=r.cityId),r&&r.countyId&&3===r.subjectLevel&&(n=r.countyId),n=c.a.hasOwnProperty(n)?n:"310100",e.serviceMap.nongyongdi=c.a[n].nongyongdi,e.serviceMap.hzssc_dapeng=c.a[n].dapeng,e.serviceMap.hezuosheNaturalBorder=c.a[n].hezuosheNaturalBorder,e.homeLatLng=c.a[n].centerExtend,t.next=11,Object(l.a)(e);case 11:e.temptoken=t.sent,e.$nextTick(g(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.gisloading=!0,t.next=3,e.initMap();case 3:return t.next=5,e.initMapHander();case 5:if(t.sent){t.next=9;break}return window.location.reload(),t.abrupt("return");case 9:e.gisloading=!1,e.initServerLayer(e.gismap,"nongyongdi"),e.initServerLayer(e.gismap,"hzssc_dapeng"),dojo.connect(e.gismap,"onClick",e.searchPointer);case 13:case"end":return t.stop()}},t,e)})));case 13:case"end":return t.stop()}},t,e)}))()},methods:{initMapHander:function(){var e,t=this,r=this,n=!1,a=r.$route.path;function i(){var e,t=this;return new Promise((e=g(regeneratorRuntime.mark(function e(i){var s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:s=function(){if(r.$route.path===a&&!n){var e=document.getElementById("gismap_weixing_ditu");e&&""!==e.innerHTML&&(n=!0,i(!0))}},setTimeout(s,200),setTimeout(s,500),setTimeout(s,1e3),setTimeout(s,2e3),setTimeout(s,4e3),setTimeout(s,5e3),setTimeout(function(){if(r.$route.path===a&&!n){var e=document.getElementById("gismap_weixing_ditu");e&&""!==e.innerHTML?(n=!0,i(!0)):(document.getElementById("gismap").innerHTML="",console.log("天地图加载有问题 重新加载"),i(!1))}},7e3);case 8:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))}return new Promise((e=g(regeneratorRuntime.mark(function e(r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i();case 2:n=e.sent,r(n);case 4:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},initMap:function(){var e=this;return new Promise(function(t){a.a.loadModules(["esri/map","esri/layers/ArcGISTiledMapServiceLayer","esri/layers/ArcGISDynamicMapServiceLayer","esri/layers/ImageParameters","esri/geometry/Point","esri/SpatialReference","esri/geometry/Extent","esri/layers/GraphicsLayer"],e.options).then(function(r){var n=p(r,8),a=n[0],i=n[1],s=(n[2],n[3],n[4],n[5],n[6]),o=n[7],c=e,l=new a("gismap",{extent:new(Function.prototype.bind.apply(s,[null].concat(d(e.homeLatLng),[new esri.SpatialReference({wkid:4326})]))),logo:!1,optimizePanAnimation:!0});dojo.connect(l,"onExtentChange",function(e){});var u=new i(e.tileMap.weixing,{id:"weixing_ditu"});u.on("update-end",function(e){console.log(e.error),c.wxLayerUpdateEnd=!0}),l.addLayer(u),e.companyLayers.nongyongdi=new o({visible:!0}),l.addLayer(e.companyLayers.nongyongdi),e.companyLayers.hzssc_dapeng=new o({visible:!0}),l.addLayer(e.companyLayers.hzssc_dapeng),e.plotLayers=new o({visible:!0}),l.addLayer(e.plotLayers),e.gismap=l,t(!0)},function(e){t(!1)})})},searchPointer:function(e){var t=this;return g(regeneratorRuntime.mark(function r(){var n,a,i,s,o,c,l,u,d,g,f,h,m,v,y,b,A,w,x;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t.layersHander(0),t.gismap.infoWindow.hide(),t.plotdialogVisible=!1,r.next=5,t.queryOnePointer(e,"hzssc_dapeng");case 5:if(n=r.sent,a=p(n,2),i=a[0],s=a[1],!i){r.next=25;break}return o=s.features[0].attributes.DPDKID,r.next=13,t.getPlotId(o);case 13:if(c=r.sent,l=p(c,2),u=l[0],d=l[1],!u){r.next=25;break}return t.landId=d.id,t.plotId=d.plotId,t.gisType=d.type,t.plotdialogVisible=!0,t.renderAllPolygon(t.gismap,s.features,t.plotLayers),t.getCenterAZoom(s.features,"plot"),r.abrupt("return");case 25:return r.next=27,t.queryOnePointer(e,"nongyongdi");case 27:if(g=r.sent,f=p(g,2),h=f[0],m=f[1],!h){r.next=49;break}return v=m.features[0].attributes.DKID,r.next=35,t.getPlotId(v);case 35:if(y=r.sent,b=p(y,2),A=b[0],w=b[1],!A){r.next=47;break}return t.landId=w.id,t.plotId=w.plotId,t.gisType=w.type,t.plotdialogVisible=!0,t.renderAllPolygon(t.gismap,m.features,t.plotLayers),t.getCenterAZoom(m.features,"plot"),r.abrupt("return");case 47:r.next=50;break;case 49:console.log("当前地点无地块数据");case 50:if((x=s||m)&&x.features&&0!=x.features.length){r.next=53;break}return r.abrupt("return");case 53:t.renderAllPolygon(t.gismap,x.features,t.plotLayers),t.showAreaInfo(t.gismap,x,e.mapPoint);case 55:case"end":return r.stop()}},r,t)}))()},searchSubjectfn:function(e){var t=this;return g(regeneratorRuntime.mark(function r(){var n,a,i,s,o,c,l,u,g,f,h;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t.searchStr&&""!==t.searchStr||e&&""!==e){r.next=2;break}return r.abrupt("return");case 2:return t.searchStr&&(t.searchText=t.searchStr),e&&(t.searchText=e),n=t.searchText||e,t.plotdialogVisible=!1,t.layersHander(),t.layersHander(1),t.inCompanySearch=!0,t.layershow.companyService=["农用地","蔬菜大棚"],t.searchResultWord="",t.corpActiveId=t.farmActiveId="",a=!1,/\d{18,}/g.test(n)&&(a=!0),t.gisloading=!0,r.next=18,t.searchSubjectOrPlotfn("nongyongdi",n,a);case 18:return i=r.sent,s=p(i,2),o=s[0],c=s[1],o&&t.renderAllPolygon(t.gismap,c,t.companyLayers.nongyongdi,2),r.next=25,t.searchSubjectOrPlotfn("hzssc_dapeng",n,a);case 25:if(l=r.sent,u=p(l,2),g=u[0],f=u[1],g&&t.renderAllPolygon(t.gismap,f,t.companyLayers.hzssc_dapeng,2),t.gisloading=!1,0!=c.length||0!=f.length){r.next=34;break}return t.$message("未搜索到任何地块"),r.abrupt("return");case 34:return t.searchSubjectWordHander(c,f),t.wxLayerUpdateEnd=!1,r.next=38,t.getCenterAZoom([].concat(d(c),d(f)));case 38:return h=r.sent,r.next=41,t.tempWatchVariables();case 41:h&&t.polygonsActiveAntimate([t.companyLayers.nongyongdi,t.companyLayers.hzssc_dapeng]);case 42:case"end":return r.stop()}},r,t)}))()},backHomefn:function(){this.resetMapfn(),this.goHomeExtent()},goHomeExtent:function(){var e=this;a.a.loadModules(["esri/geometry/Extent"],this.options).then(function(t){var r=p(t,1)[0],n=new(Function.prototype.bind.apply(r,[null].concat(d(e.homeLatLng),[new esri.SpatialReference({wkid:4326})])));e.gismap.setExtent(n)})},resetMapfn:function(){this.layersHander(),this.plotdialogVisible=!1,this.searchStr=this.searchText="",this.searchResultWord="",this.corpActiveId=this.farmActiveId="",this.layershow.service=["农用地","蔬菜大棚"],this.inCompanySearch=!1},queryOnePointer:function(e,t){var r=this;return new Promise(function(n){a.a.loadModules(["esri/tasks/QueryTask","esri/tasks/query","esri/symbols/SimpleFillSymbol","esri/symbols/SimpleLineSymbol"],r.options).then(function(a){var i=p(a,4),s=i[0],o=i[1],c=i[2],l=i[3],u=new o;u.returnGeometry=!0,u.outFields=["*"];new c(c.STYLE_SOLID,new l(l.STYLE_SOLID,new dojo.Color([255,0,0]),2),new dojo.Color([255,255,0,.5]));var d,f=new s(r.serviceMap[t]+"/0?token="+r.temptoken);u.geometry=e.mapPoint,f.execute(u,(d=g(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t&&t.features&&t.features.length>0&&t.features[0].attributes&&(t.features[0].attributes.hasOwnProperty("DPDKID")||t.features[0].attributes.hasOwnProperty("DKID"))?n([!0,t]):n([!1,null]);case 1:case"end":return e.stop()}},e,this)})),function(e){return d.apply(this,arguments)}))})})},searchSubjectWordHander:function(e,t){var r="",n="";e&&e.length>0&&(r=e.length+"个农用地"),t&&t.length>0&&(n=t.length+"个大棚");var a="共搜索到: "+r+"，"+n;r&&n||(a=a.replace("，","")),this.searchResultWord=a},initServerLayer:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"nongyongdi",n=this.serviceMap[r]+"?token="+this.temptoken;a.a.loadModules(["esri/layers/ArcGISDynamicMapServiceLayer"],this.options).then(function(a){p(a,1)[0];var i=new esri.layers.ArcGISDynamicMapServiceLayer(n,{id:r,outFields:["*"]});t.serverLayers[r]=i,e.addLayer(i)},function(e){})},initServerLayerCondition:function(e,t,r,n){var i=this;return new Promise(function(e){i.serviceMap[t],i.temptoken;a.a.loadModules(["esri/layers/ImageParameters"],i.options).then(function(t){p(t,1)[0];var a=null;n&&(a=n()),r.setLayerDefinitions(a,!1),r.show(),r.refresh(),e()})})},getPlotId:function(e){return this.$ajax.post(this.$api.plotlist.getByGisDkid,{shGisDkid:e,dataTargetFlag:f.dataTargetFlag}).then(function(e){var t=e.data;return 0===t.respCode?2===t.obj.type?[!1,null]:[!0,t.obj]:[!1,null]}).catch(function(e){console.log(e)})},renderAllPolygon:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return new Promise(function(e){a.a.loadModules(["esri/graphic","esri/geometry/Polygon","esri/SpatialReference","esri/symbols/SimpleFillSymbol","esri/symbols/SimpleLineSymbol"],n.options).then(function(e){var a=p(e,5),s=a[0],o=a[1],c=a[2],l=a[3],u=a[4];if(0!==t.length){for(var g={},f=0;f<t.length;f++){var h=n.getNowAreaColor(t[f],i),m=p(h,2),v=((w=m[0])+(x=m[1])+(S=1===i?4:1)).split(",").join("");if(g[v]){y=JSON.parse(JSON.stringify(t[f].geometry.rings));g[v].rings=g[v].rings.concat(y)}else{var y=JSON.parse(JSON.stringify(t[f].geometry.rings));g[v]={areaColor:w,borderColor:x,borderwidth:S,rings:y}}}for(var b in g){for(var A=g[b],w=A.areaColor,x=A.borderColor,S=A.borderwidth,I=(y=A.rings,new l(l.STYLE_SOLID,new u(u.STYLE_SOLID,new dojo.Color(x),S),new dojo.Color([].concat(d(w),[1])))),C=new o(new c({wkid:4326})),P=0,L=y.length;P<L;P++)C.addRing(y[P]);r.add(new s(C,I))}}})})},getNowAreaColor:function(e,t){if(!e||!e.attributes||!(e.attributes["土地类型"]||e.attributes.TYPE||e.attributes.LANDTYPE))return[[51,98,2],[255,0,0]];var r=e.attributes["土地类型"]||e.attributes.TYPE||e.attributes.LANDTYPE;return u.c.hasOwnProperty(r)?e.attributes["土地类型"]?1===t?[u.c[r],[255,0,0]]:2===t?[u.c[r],[215,116,85]]:[u.c[r],u.c[r]]:1===t?[u.c[r],[255,0,0]]:2===t?[u.c[r],[215,116,85]]:[u.c[r],[165,165,165]]:[[201,242,208],[165,165,165]]},layersHander:function(e){switch(e){case 0:this.plotLayers&&this.plotLayers.clear();break;case 1:for(var t in this.serverLayers)this.serverLayers[t]&&this.serverLayers[t].hide();this.layershow.service=[];case 2:this.companyProfile&&this.companyProfile.hide();default:this.plotLayers&&this.plotLayers.clear(),this.companyLayers.nongyongdi&&this.companyLayers.nongyongdi.clear(),this.companyLayers.hzssc_dapeng&&this.companyLayers.hzssc_dapeng.clear(),this.companyProfile&&this.companyProfile.hide(),this.gismap.infoWindow.hide()}},getCenterAZoom:function(e,t){var r=this;return new Promise(function(n){for(var i=[],s=[],o=[],c=[],l=0;l<e.length;l++){var u=e[l].geometry.getExtent();i.push(u.xmin),s.push(u.ymin),o.push(u.xmax),c.push(u.ymax)}var g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"company";if(4!==e.length)return[];var r=e[2]-e[0],n=e[3]-e[1];e[0],e[1];if("company"===t){var a=.25*r,i=.25*n;return[e[0]-5*a,e[1]-i,e[2]+5*a,e[3]+1.5*i]}if("plot"===t){var a=r,i=n;return[e[0]-a,e[1]-i,e[2]+a,e[3]+5.5*i]}}([Math.min.apply(null,i),Math.min.apply(null,s),Math.max.apply(null,o),Math.max.apply(null,c)],t);a.a.loadModules(["esri/geometry/Extent","esri/layers/GraphicsLayer"],r.options).then(function(e){var t=p(e,2),a=t[0],i=(t[1],new(Function.prototype.bind.apply(a,[null].concat(d(g),[new esri.SpatialReference({wkid:4326})]))));r.gismap.setExtent(i);var s=Boolean(g[2]-g[0]>.05||g[3]-g[1]>.05);n(s)})})},plotdialogChange:function(e){this.plotdialogVisible=e,e||(this.plotTabIndex=1,this.layersHander(0))},landPopChange:function(e){this.landPop.landPopVisible=e,e||this.layersHander(0)},showAreaInfo:function(e,t,r){if(t.features&&0!=t.features.length){var n=t.features[0].attributes,a={};for(var i in n){var s=n[i];"Shape_Area"===i?(s=l(n.Shape_Area),a.shapeArea=s):"SHAPE_Area"===i&&(s=l(n.SHAPE_Area),a.shapeArea=s);var o=new RegExp("[\\u4E00-\\u9FFF]+","g");if(u.a.hasOwnProperty(i)||o.test(i)){var c=u.a.hasOwnProperty(i)?u.a[i]:i;s="地块类型"===c&&u.b.hasOwnProperty(s)?u.b[s]:s,"地块类型"===c&&u.b.hasOwnProperty(s)&&(a.landType=s),s="主体类型"===c&&u.d.hasOwnProperty(s)?u.d[s]:s,"主体类型"===c&&u.d.hasOwnProperty(s)&&(a.companyType=s),n[i]&&""!==n[i]&&" "!==n[i]&&"  "!==n[i]&&('<div><span class="title pyc">'+c+"</span><p>"+s+"</p></div>",a[i]=s)}}return n.hasOwnProperty("DPDKID")?(e.infoWindow.setTitle("大棚: "+n.DPDKID),this.landPop.landPopVisible=!0,this.landPop.landDetailData=a):(e.infoWindow.setTitle("农用地: "+n.DKID),this.landPop.landPopVisible=!0,this.landPop.landDetailData=a),!0}return!1;function l(e){/\d+e[+-]\d/g.test(e=e)||e<1e-4?e*=16e6:e=parseFloat(e/666.66666666667);var t=e.toExponential().match(/\d(?:\.(\d*))?e([+-]\d+)/);return e.toFixed(Math.max(0,(t[1]||"").length-t[2]))}},searchSubjectOrPlotfn:function(e,t,r){var n,a=this;return new Promise((n=g(regeneratorRuntime.mark(function t(r){var n,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.serviceMap[e]+"/0?token="+a.temptoken,t.next=3,a.serverQuery(n,i);case 3:s=t.sent,r(s);case 5:case"end":return t.stop()}},t,a)})),function(e){return n.apply(this,arguments)}));function i(){var n="";if(r){var a="DPDKID";"nongyongdi"===e&&(a="DKID"),n=a+" like '%"+t+"%'"}else{a="COMPANY";"nongyongdi"===e&&(a="ZHUTINAME"),n=a+" like '%"+t+"%'"}return n}},serverQuery:function(e,t){var r=this;return new Promise(function(n){a.a.loadModules(["esri/map","esri/layers/ArcGISDynamicMapServiceLayer","esri/tasks/QueryTask","esri/toolbars/draw","esri/tasks/query","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol"],r.options).then(function(r){var a=p(r,7),i=(a[0],a[1],a[2]),s=(a[3],a[4]),o=(a[5],a[6],new i(e)),c=new s;if(c.outFields=["*"],t&&(c.where=t()),c.where){c.outSpatialReference=esri.spatialReference,c.spatialRelationship=s.SPATIAL_REL_INTERSECTS,c.returnGeometry=!0,c.returnDistinctValues=!1,c.relationParam=!1;try{o.execute(c,function(e){e.features&&0!==e.features.length?n([!0,e.features]):n([!1,[]])})}catch(e){n([!1,[]])}}else n([!1,[]])})})},polygonsActiveAntimate:function(e){var t;if(e)for(var r=0;r<e.length;r++){if(!e[r]._div||!e[r]._div.children)return;for(var n=e[r]._div.children,a=0;a<n.length;a++)t=n[a].rawNode.childNodes,void 0,t.forEach(function(e,t){var r=e.getAttribute("stroke"),n=e.getAttribute("fill");e.setAttribute("stroke","rgb(255, 78, 23)"),e.setAttribute("fill","rgb(255, 78, 23)"),e.setAttribute("stroke-width","6"),setTimeout(function(){e.setAttribute("stroke",r),e.setAttribute("fill",n),e.setAttribute("stroke-width","1")},1500)})}},tempWatchVariables:function(){var e,t=this,r=0;return new Promise(function(n){e=setInterval(function(){r++,(t.wxLayerUpdateEnd||r>=150)&&(clearInterval(e),n())},20)})},showCropOrTypeSubjectList:function(e){var t=this;return g(regeneratorRuntime.mark(function r(){var n,a,i,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(s=function(e){var t=JSON.parse(localStorage.govGovernmentSubjectVO),r=t.subjectLevel,a=[t.provinceId,t.provinceId,t.cityId,t.countyId];return new Promise(function(i){n.$ajax.post(n.$api.operators.cropCategoryFarmList,{cropCategoryId:e,farmAreaId:[a[r]],farmAreaType:t.subjectLevel}).then(function(e){i(e)})})},i=function(e){var t=JSON.parse(localStorage.govGovernmentSubjectVO),r=t.subjectLevel,a=[t.provinceId,t.provinceId,t.cityId,t.countyId];return new Promise(function(i){n.$ajax.post(n.$api.operators.listByCropIdAndArea,{cropId:e,farmAreaId:[a[r]],farmAreaType:t.subjectLevel}).then(function(e){i(e)})})},n=t,t.searchResultWord.plantSubject||!t.searchResultWord.Id){r.next=15;break}if("crop"!==t.searchResultWord.type){r.next=10;break}return r.next=7,i(t.searchResultWord.Id);case 7:a=r.sent,r.next=14;break;case 10:if("croptype"!==t.searchResultWord.type){r.next=14;break}return r.next=13,s(t.searchResultWord.Id);case 13:a=r.sent;case 14:a&&200===a.status&&0===a.data.respCode&&a.data.obj&&a.data.obj.list&&(t.searchResultWord.plantSubject=a.data.obj.list,t.pcListTipsShow=!1,t.pcListTipsShow=!0);case 15:e&&!t.pcListTipsScroll&&t.searchResultWord.plantSubject&&t.searchResultWord.plantSubject.length>=12?t.$nextTick(function(){setTimeout(function(){t.pcListTipsScroll=$(t.$refs.plantCompantList).niceScroll({cursorcolor:"rgba(0, 247, 255 ,0.4)",cursorwidth:"3px",cursorborder:"",autohidemode:!0,railpadding:{top:0,right:4,left:0,bottom:0}})},400)}):($(".subject-select")&&$(".subject-select").getNiceScroll().remove(),t.pcListTipsScroll=null);case 16:case"end":return r.stop()}},r,t)}))()},goMorePlotsWithId:function(e,t){var r=this;return g(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(){var n=g(regeneratorRuntime.mark(function n(a){var i,s,o,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(c=function e(t,r){return t.length>r?[t.splice(0,r)].concat(d(e(t,r))):[t]},t&&0!==t.length){n.next=4;break}return a(),n.abrupt("return");case 4:i=c(JSON.parse(JSON.stringify(t)),1e3),s=r.serviceMap[e]+"/0?token="+r.temptoken,o=[],i.forEach(function(){var t=g(regeneratorRuntime.mark(function t(n,a){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:o.push(r.serverQuery(s,r.plotQueryfn(n,e)));case 1:case"end":return t.stop()}},t,r)}));return function(e,r){return t.apply(this,arguments)}}()),Promise.all(o).then(function(e){var t=!1,r=[];e.forEach(function(e,n){var a=p(e,2),i=a[0],s=a[1];i&&(t=!0),r.push.apply(r,d(s))}),a([t,r])});case 9:case"end":return n.stop()}},n,r)}));return function(e){return n.apply(this,arguments)}}()));case 1:case"end":return n.stop()}},n,r)}))()},plotQueryfn:function(e,t){var r="DPDKID",n=e||[];return n=n.filter(function(e){if(e)return e}),"nongyongdi"===t&&(r="DKID"),function(){for(var e="",t=0;t<n.length;t++)n[t]&&(t===n.length-1?e+=r+" = '"+n[t]+"'":e+=r+" = '"+n[t]+"' or ");return e}},allplotRender:function(e){var t=this;return g(regeneratorRuntime.mark(function r(){var n,a,i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t.gisloading=!0,t.searchStr=t.searchText="",t.gismap.infoWindow.hide(),n=p(e,2),a=n[0],i=n[1],t.tempAllPlotId=a,0!==a.length){r.next=11;break}return t.gisloading=!1,t.$message({type:"warning",offset:100,duration:2e3,message:"未搜索到对应地块"}),t.corpActiveId=t.farmActiveId="",t.backHomefn(),r.abrupt("return");case 11:t.plotdialogVisible=!1,t.layersHander(),t.layersHander(1),t.layershow.companyService=["农用地","蔬菜大棚"],t.inCompanySearch=!0,t.nowSubjectCrop=i,t.renderPlotForPlogon(a);case 18:case"end":return r.stop()}},r,t)}))()},renderPlotForImg:function(e){var t=this;return g(regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=t,r.next=3,t.initServerLayerCondition(t.gismap,"nongyongdi",t.companyLayers.nongyongdi_DMSL,function(){var t=[];return t[0]=n.plotQueryfn(e,"nongyongdi")(),t});case 3:return r.next=5,t.initServerLayerCondition(t.gismap,"hzssc_dapeng",t.companyLayers.hzssc_dapeng_DMSL,function(){var t=[];return t[0]=n.plotQueryfn(e,"hzssc_dapeng")(),t});case 5:t.goHomeExtent(),t.gisloading=!1;case 7:case"end":return r.stop()}},r,t)}))()},renderPlotForPlogon:function(e){var t=this;return g(regeneratorRuntime.mark(function r(){var n,a,i,s,o,c,l,u,g;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.goMorePlotsWithId("nongyongdi",e);case 2:return n=r.sent,a=p(n,2),i=a[0],s=a[1],i&&s.length>0&&t.renderAllPolygon(t.gismap,s,t.companyLayers.nongyongdi,2),r.next=9,t.goMorePlotsWithId("hzssc_dapeng",e);case 9:if(o=r.sent,c=p(o,2),l=c[0],u=c[1],l&&u.length>0&&t.renderAllPolygon(t.gismap,u,t.companyLayers.hzssc_dapeng,2),t.gisloading=!1,!i&&!l){r.next=25;break}return t.wxLayerUpdateEnd=!1,r.next=19,t.getCenterAZoom([].concat(d(s),d(u)));case 19:return g=r.sent,r.next=22,t.tempWatchVariables();case 22:g&&t.polygonsActiveAntimate([t.companyLayers.nongyongdi,t.companyLayers.hzssc_dapeng]),r.next=28;break;case 25:t.$message({type:"warning",offset:100,duration:2e3,message:"未搜索到对应地块"}),t.corpActiveId=t.farmActiveId="",t.backHomefn();case 28:case"end":return r.stop()}},r,t)}))()},showSomePlotRender:function(e){var t=this,r=e.farmId;e.farmName,e.name,e.cropIdentifier;return g(regeneratorRuntime.mark(function e(){var n,a,i,s,o,c,l,u,g,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,t.$refs.companycom.getFarmAllPlots(r);case 3:if(a=e.sent){e.next=6;break}return e.abrupt("return");case 6:if(0!==(n=(n=a.list).filter(function(e){return-1!==t.tempAllPlotId.indexOf(e)})).length){e.next=11;break}return t.$message({type:"warning",offset:100,duration:2e3,message:"未搜索到对应地块"}),e.abrupt("return");case 11:return t.pcListTipsShow=!1,t.gisloading=!0,t.plotdialogVisible=!1,t.layershow.companyService=["农用地","蔬菜大棚"],e.next=17,t.goMorePlotsWithId("nongyongdi",n);case 17:return i=e.sent,s=p(i,2),o=s[0],c=s[1],o&&c.length>0&&t.renderAllPolygon(t.gismap,c,t.plotLayers,2),e.next=24,t.goMorePlotsWithId("hzssc_dapeng",n);case 24:if(l=e.sent,u=p(l,2),g=u[0],f=u[1],g&&f.length>0&&t.renderAllPolygon(t.gismap,f,t.plotLayers,2),t.gisloading=!1,!o&&!g){e.next=40;break}return t.wxLayerUpdateEnd=!1,e.next=34,t.getCenterAZoom([].concat(d(c),d(f)));case 34:return e.sent,e.next=37,t.tempWatchVariables();case 37:t.polygonsActiveAntimate([t.plotLayers]),e.next=41;break;case 40:t.$message({type:"warning",offset:100,duration:2e3,message:"未搜索到对应地块"});case 41:setTimeout(function(){t.plotLayers.clear()},2e3);case 42:case"end":return e.stop()}},e,t)}))()},plantPredictDialogChangefn:function(e){e&&(this.plotdialogVisible=!1,this.gismap.infoWindow.hide(),this.layersHander(0))}},components:{plotDetailDialog:function(){return r.e(141).then(r.bind(null,"SXR7"))},companyListSlider:i.default,plantBreedSlider:s.default,landDetailPop:function(){return r.e(4).then(r.bind(null,"u+v7"))}}},m=r("W5g0");var v=function(e){r("Vda5")},y=Object(m.a)(h,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{directives:[{name:"title",rawName:"v-title"}],staticClass:"gis-mapcontainer",attrs:{"data-title":"土地资源监管"}},[n("div",{attrs:{id:"gismap"}}),e._v(" "),e.gisloading?n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.gisloading,expression:"gisloading"}],staticClass:"gisloader",attrs:{"element-loading-text":"加载中...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0)"}}):e._e(),e._v(" "),n("div",{staticClass:"search-box"},[n("el-input",{attrs:{placeholder:"搜索经营主体、地块编码",autocomplete:"off"},nativeOn:{keyup:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.searchSubjectfn()}},model:{value:e.searchStr,callback:function(t){e.searchStr=t},expression:"searchStr"}}),e._v(" "),e.searchText||e.searchStr?n("span",{staticClass:"clearinput",on:{click:e.resetMapfn}},[n("img",{attrs:{src:r("Igo0"),alt:""}})]):e._e(),e._v(" "),n("button",{staticClass:"seacch-btn",on:{click:function(){e.searchSubjectfn()}}},[n("img",{attrs:{src:r("+BDs"),alt:""}}),e._v("搜索\n\t\t\t")])],1),e._v(" "),e.inCompanySearch?n("div",{staticClass:"reduction-btn"},[e._v("\n\t\t\t正在搜索"),n("span",{staticClass:"search-word"},[e._v(e._s(e.searchText||e.nowSubjectCrop)),n("i",{staticClass:"icon",on:{click:e.backHomefn}},[e._v("×")])])]):e._e(),e._v(" "),e.searchResultWord?n("div",{staticClass:"search-result"},["string"==typeof e.searchResultWord?n("div",{staticClass:"plant-info-title",domProps:{innerHTML:e._s(e.searchResultWord)}}):e._e(),e._v(" "),"object"==typeof e.searchResultWord?n("div",{staticClass:"plant-info-title"},[n("el-popover",{attrs:{placement:"bootom-end",title:"",trigger:"click",content:"","popper-class":"popover-title"},model:{value:e.pcListTipsShow,callback:function(t){e.pcListTipsShow=t},expression:"pcListTipsShow"}},[n("div",{ref:"plantCompantList",staticClass:"subject-select"},[n("div",[e._l(e.searchResultWord.plantSubject,function(t,r){return e.searchResultWord.plantSubject?n("p",[n("span",{on:{click:function(r){return e.showSomePlotRender(Object.assign({},t,e.searchResultWord))}}},[e._v(e._s(t.farmName))]),n("span",{staticClass:"gofarm-detail",attrs:{title:"进入基地"},on:{click:function(){e.$router.push({path:"/farmdetail/"+t.farmId})}}})]):e._e()}),e._v(" "),e.searchResultWord.plantSubject?e._e():n("p",[e._v("数据加载中...")])],2)]),e._v(" "),n("div",{staticClass:"plantinfot-item",staticStyle:{cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"},[n("img",{attrs:{src:e.iconobj.subject,alt:""}}),e._v("经营主体："+e._s(e.searchResultWord.subjectNum)+"家"),n("img",{staticClass:"arrow",class:{active:e.pcListTipsShow},attrs:{src:e.iconobj.arrow,alt:""}})])]),e._v(" "),n("div",{staticClass:"plantinfot-item"},[n("img",{attrs:{src:e.iconobj.plot,alt:""}}),e._v(e._s(e.searchResultWord.cropIdentifier)+"地块："+e._s(e.searchResultWord.plotNum)+"个")]),e._v(" "),n("div",{staticClass:"plantinfot-item"},[n("img",{attrs:{src:e.iconobj.area,alt:""}}),e._v(e._s(e.searchResultWord.cropIdentifier)+"面积："+e._s(e.searchResultWord.areaNum)+"亩")])],1):e._e()]):e._e(),e._v(" "),n("div",{staticClass:"show-control-layer"},[n("div",{staticClass:"show-control-con"},[n("el-form",{ref:"form",attrs:{"label-width":"80px"}},[n("el-form-item",{attrs:{label:e.inCompanySearch?"搜索结果:":"显示图层:"}},[e.inCompanySearch?e._e():n("el-checkbox-group",{model:{value:e.layershow.service,callback:function(t){e.$set(e.layershow,"service",t)},expression:"layershow.service"}},[n("el-checkbox",{attrs:{label:"农用地",name:"type"}}),e._v(" "),n("el-checkbox",{attrs:{label:"蔬菜大棚",name:"type"}})],1),e._v(" "),e.inCompanySearch?n("el-checkbox-group",{model:{value:e.layershow.companyService,callback:function(t){e.$set(e.layershow,"companyService",t)},expression:"layershow.companyService"}},[n("el-checkbox",{attrs:{label:"农用地",name:"type"}}),e._v(" "),n("el-checkbox",{attrs:{label:"蔬菜大棚",name:"type"}})],1):e._e(),e._v(" "),n("el-checkbox-group",{model:{value:e.brightMode,callback:function(t){e.brightMode=t},expression:"brightMode"}},[n("el-checkbox",{attrs:{label:"卫星图",name:"type"}})],1)],1)],1)],1)]),e._v(" "),n("company-list-slider",{ref:"companycom",attrs:{farmactiveid:e.farmActiveId},on:{getFarmTitleEv:function(t){e.searchResultWord=t,e.corpActiveId=""},getFarmAllPlotEv:e.allplotRender,"update:farmactiveid":function(t){e.farmActiveId=t}}}),e._v(" "),n("plant-breed-slider",{attrs:{corpactiveid:e.corpActiveId},on:{getPlantTitleEv:function(t){e.searchResultWord=t,e.pcListTipsScroll=null,e.farmActiveId=""},getPlantAllPlotEv:e.allplotRender,plantPredictDialogChangeEv:e.plantPredictDialogChangefn,"update:corpactiveid":function(t){e.corpActiveId=t}}})],1),e._v(" "),e.plotdialogVisible?n("plotDetailDialog",{attrs:{plotdialogVisible:e.plotdialogVisible,"plot-id":e.plotId,"land-id":e.landId,"gis-type":e.gisType,plotTabIndex:e.plotTabIndex},on:{plotdialogChangeEv:e.plotdialogChange,"update:plotTabIndex":function(t){e.plotTabIndex=t},"update:plot-tab-index":function(t){e.plotTabIndex=t}}}):e._e(),e._v(" "),e.landPop.landPopVisible?n("landDetailPop",{attrs:{visible:e.landPop.landPopVisible,landDetailData:e.landPop.landDetailData},on:{changePop:e.landPopChange}}):e._e()],1)},[],!1,v,"data-v-6bd7f1aa",null);t.default=y.exports},"9dcc":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAABbUlEQVQ4jeWSsWsUURCHv90cKAfaJP4BXnlBSGFxvcIlBMtDuEJECKQTO2sLRRAkdlHsLYQ0ir0KXmWhCCqYkICNgs0J4kHyWdxbeNmbPVvBHwzszuz75vdmB/5fOauJOlLXVNS2elf9Gnx7p+K0atwHwOv0fALoA8+Aa8AG0AG2gN3szK15DofJTR631SN1rJ4N6q9yh2XG/A0sBL3uAQJPgb2gfhI4jIAfgPPBgR/AN+BTUDsFdIHPEfAh0zn1goOTINcC7gM/gZ08WekRcAF4CWwDowzUBs4Bg/R+BrgKLAOXgPFMuzTgUt1U36q/gvWo9F19onarn9MERF1UOynKlNtXb2ZNq/rpOrCscct05S8p1oPZrWf150H9mMPL6UpX1JU5DlfUG+nbXtOVS/V9WtT68ubAKhbUj+qLJuAgdbwYAB+r/SA/rFxWnCIDvgOWgOuNc5lVyXR/3xRFsVp3eDBnTf6m3bDdP6k/klbeiobwox4AAAAASUVORK5CYII="},Igo0:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAB2ElEQVQ4ja3Uy0uUURjH8c9IhkIS5WKQ8tJgJNZC7IK0UYzWbmJa1yLof2jZ/9DSTW2kTduiSCIQ06ToMt2gRjMoCgd1QGWaFuedmXdm3qGB+sHhhef5Pd9z3udc+M9Kwf7sjaTcNC5H34EolscjzOFhY8Hu3E37EkAjuIWphNxwNK7hMa4jFzd0NBRMYrEFrFFTkXeyFXAE99DTBqyinqhmpBGYwiwOgmKRH99bY0olPrwL31AzGzGqwAuYqBb8jgrWVpthOzs8X2Jvj1SqEp2IGFVgtq7oQA/jZ/m6xqePtfj2FsvP6O1l9BQddVuQjQOnm1bS1cX4GQobvHnNr5+sLDM4RGY4qRHTcWB/kkNnJ2PjFLd4scLxExw5mmitMCrAnVYua/nQt3Qf+S/strbGgetNmXKZ9zm+rYd+jp4knWZ5ieJ24tRx4GJdqlTi1Uu2NgOsuzvEB4bIZEIvCxuNwKdx4J26VP5zOBJjp0Mf40r3hR2O737QbVTv8n0sqJzFwWMBWDtn9Tp0OIyaFvAgvsIyrqCAcL5awZpVwNWIUXeXc5jBZrukyDuDt5VA42szj3PCL/xNC5F3Ph5Meg9zOI+LuCTc0X7sYhVPcFfoWbmNif9NfwBCE3iWgBkBAQAAAABJRU5ErkJggg=="},Vda5:function(e,t){},Y6OB:function(e,t){},ckTI:function(e,t){},"g6+4":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAABUElEQVQ4jdXUvWpVURAF4A+5EBTUGGyUYKGFNlraBAsRG/EJgqCtlU1sUvoWvoGmCERrQUgjYiPYWgR/iUjUYC6iYVmcucnOFS83SaMLhj0ze7POmh8O/wWSHE3yIMn37MT5JMY16BXnfVzFPaw133q3V4UbSeZ3o6axmSRzSc7AgeI8OKRsXJzAQ/zCk5Zwr/iAaTzFJts9bHEXx7GCGTzHY9zBJJaw2LyfLpWzW5ma6O3qyXLFH8uS5EeSlSRrFV+vt0eSvExyM8mxUSX3cRbnyn+L07hU91fqPIVV3MDC30qGT/ja+O+rR28qN1HnK926bWG/Q/kD+yU8ide4PIpw3Xa5yl8vP7p93ai4p+vtIU1iGNeG4guN/w1ToyQPFPZ1O7ZbHK7z5yAxUPgIc7pJfhmTrIdb+IxnO26STCZZSNLP+NhM8iLJxfb39e/jNy0zJEPnpIzHAAAAAElFTkSuQmCC"},ji7R:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("VCTt"),a=r("VKKs");function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,i){try{var s=t[a](i),o=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(o).then(function(e){n("next",e)},function(e){n("throw",e)});e(o)}("next")})}}var s=Object(n.b)(),o=Object(a.b)("govGovernmentSubjectVO").groupFlag,c={data:function(){return{subjectsearch:"",landtypeList:[],subjectList:[],searchHasResult:!0,ploticon:r("9dcc"),tabindex:!0}},props:{farmactiveid:{default:"",type:String}},computed:{farmActiveId:{get:function(){return this.farmactiveid},set:function(e){this.$emit("update:farmactiveid",e)}}},watch:{subjectsearch:function(e){var t=this;this.searchHasResult=!1,this.subjectList.forEach(function(r){-1!==r.farmName.indexOf(e)?(r.nohas=!1,t.searchHasResult=!0):r.nohas=!0}),this.$nextTick(function(){$(t.$refs.companylist).getNiceScroll().resize()})},tabindex:function(e){var t=this;this.$nextTick(function(){e?($(t.$refs.landtypelist).getNiceScroll().show(),$(t.$refs.companylist).getNiceScroll().hide()):($(t.$refs.landtypelist).getNiceScroll().hide(),1===$(t.$refs.companylist).getNiceScroll().length?$(t.$refs.companylist).getNiceScroll().show():$(t.$refs.companylist).niceScroll({cursorcolor:"rgba(0, 247, 255 ,0.4)",cursorwidth:"3px",cursorborder:"",autohidemode:!0,railpadding:{top:0,right:8,left:0,bottom:0}}))})}},mounted:function(){var e=this;return i(regeneratorRuntime.mark(function t(){var r,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0===o?e.getAreaLandTypeDistribution:e.getAllLandTypeList)();case 2:if(r=t.sent){t.next=5;break}return t.abrupt("return");case 5:return e.landtypeList=r.list,t.next=8,e.getFarmList();case 8:if(n=t.sent){t.next=11;break}return t.abrupt("return");case 11:e.subjectList=n.list,e.$nextTick(function(){$(e.$refs.landtypelist).niceScroll({cursorcolor:"rgba(0, 247, 255 ,0.4)",cursorwidth:"3px",cursorborder:"",autohidemode:!0,railpadding:{top:0,right:8,left:0,bottom:0}})});case 13:case"end":return t.stop()}},t,e)}))()},methods:{showFarmAllPlotfn:function(e,t){var r=this;return i(regeneratorRuntime.mark(function n(){var a,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r.farmActiveId=e,n.next=3,r.getFarmAllPlots(e);case 3:if(a=n.sent){n.next=6;break}return n.abrupt("return");case 6:r.$emit("getFarmAllPlotEv",[a.list,t]),i="",a.totalCount>0&&(i='<div class="plantinfot-item"><img src="'+r.ploticon+'" alt="">地块：'+a.totalCount+"个</div>",r.ploticon,a.totalCount),r.$emit("getFarmTitleEv",i);case 10:case"end":return n.stop()}},n,r)}))()},getFarmList:function(){var e=this,t=JSON.parse(localStorage.govGovernmentSubjectVO),r=t.subjectLevel,n=[t.provinceId,t.provinceId,t.cityId,t.countyId];return new Promise(function(a){e.$ajax.post(e.$api.operators.listByArea,{farmAreaId:[n[r]],farmAreaType:t.subjectLevel}).then(function(e){var t=e.status,r=e.data;200===t&&0===r.respCode&&a(r.obj),a(!1)})})},getFarmAllPlots:function(e){var t=this;return new Promise(function(r){t.$ajax.post(t.$api.operators.getFarmAllPoltIds,{farmId:e}).then(function(e){var t=e.status,n=e.data;200===t&&0===n.respCode&&r(n.obj),r(!1)})})},getAreaLandTypeDistribution:function(){return this.$ajax.post(this.$api.public.areaLandTypeDistribution,{farmAreaId:[s.farmAreaId],farmAreaType:s.farmAreaType}).then(function(e){var t=e.data;if(0===t.respCode)return t.obj}).catch(function(e){console.log(new Error("获取用地类型---非集团版本"),e)})},getAllLandTypeList:function(){var e=this;return new Promise(function(t){e.$ajax.post(e.$api.plotlist.landTypeDistributionlist,{}).then(function(e){var r=e.status,n=e.data;200===r&&0===n.respCode&&t(n.obj),t(!1)})})}}},l=r("W5g0");var u=function(e){r("Y6OB")},p=Object(l.a)(c,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"gis-company-list tabs-container"},[r("div",{staticClass:"tab-detail"},[r("h3",{staticClass:"title"},[r("span",{class:{active:e.tabindex},on:{click:function(){e.tabindex=!0}}},[e._v("土地类型")]),e._v(" "),r("span",{class:{active:!e.tabindex},on:{click:function(){e.tabindex=!1}}},[e._v("经营主体")])]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.tabindex,expression:"tabindex"}],staticClass:"list-detail"},[r("div",{ref:"landtypelist",staticClass:"list-items list-items-plus"},[e.landtypeList&&e.landtypeList.length>0?r("div",e._l(e.landtypeList,function(t,n){return r("div",{staticClass:"item itemplus"},[r("div",{staticClass:"nameplus"},[r("p",{staticClass:"pyc landname"},[r("i",{style:{"background-color":t.color}}),e._v(e._s(t.landType))]),e._v(" "),r("p",{staticClass:"pyc"},[e._v(e._s(t.landNum)+"个地块")])]),e._v(" "),r("span",{staticClass:"area"},[e._v(e._s(t.landAcre)+"亩")])])}),0):r("div",[r("p",{staticClass:"nodata"},[e._v("暂无土地类型")])])])]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!e.tabindex,expression:"!tabindex"}],staticClass:"list-detail"},[r("div",{staticClass:"list-search"},[r("label",{attrs:{for:"subjectSea"}}),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.subjectsearch,expression:"subjectsearch"}],attrs:{id:"subjectSea",type:"text",placeholder:"搜索经营主体",autocomplete:"off"},domProps:{value:e.subjectsearch},on:{input:function(t){t.target.composing||(e.subjectsearch=t.target.value)}}})]),e._v(" "),r("div",{ref:"companylist",staticClass:"list-items"},[e.subjectList&&e.subjectList.length>0?r("div",[e._l(e.subjectList,function(t,n){return!t.nohas&&e.searchHasResult?r("div",{staticClass:"item",class:{active:t.farmId===e.farmActiveId}},[r("p",{staticClass:"name pyc",on:{click:function(r){return e.showFarmAllPlotfn(t.farmId,t.farmName)}}},[e._v(e._s(t.farmName))]),e._v(" "),r("span",{staticClass:"gosubject",attrs:{title:"查看地块"},on:{click:function(r){return e.showFarmAllPlotfn(t.farmId,t.farmName)}}}),e._v(" "),r("span",{staticClass:"gosubject-detail",attrs:{title:"进入基地"},on:{click:function(r){return e.$router.push({path:"/farmdetail/"+t.farmId})}}})]):e._e()}),e._v(" "),e.searchHasResult?e._e():r("p",{staticClass:"nodata"},[e._v("当前搜索无结果")])],2):r("div",[r("p",{staticClass:"nodata"},[e._v("暂无经营主体")])])])])])])},[],!1,u,"data-v-2055552f",null);t.default=p.exports},tbsX:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAABAklEQVQ4jdXUMU5CQRDG8RdISOw4gTUBOlpPYOkZvIqxUwpIPIBnsNFLaIiY2GhrR7AQA/4sGJKXdR8IMSZ8yTTfzvx3Z3feK4q9EdJo4wJjfEQ8htdO89cBGxhgoVoLXOFgE7CB2zWgVHdRUwkcbgFbaVAF7GC+A3COzopTKzFPi6Kob/+cRT1qf5xwnOx8jufMiSY4xkPJG+eAs1LCteWdNnFT8t/Qi7Wjkj/bBJziJAprOMMLWuEdJh1Nf9PyV4BqAVnNXAuvSe4oB7zM3JdouRmwXrSdqp8DdlWPzb3lQ0wya3N0c8BdB3voPz+9P/85lKODPp7wiXeMwuum+fujb5W/cBWdhGfzAAAAAElFTkSuQmCC"},u2Yj:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAABVklEQVQ4jdWUPSiFURjHfxeZ7D4zSFiUDCaDjO5kEQYZjAy+yiSZDAaDTAajSUYLGYy6CZMo1+JKJgv5+BmcW2+v9/XRjfLU6fw7/+f5n/95zunAb4T62ahXx9Qt9U5tT8sFqEjQLwe6gCzQB3QAF8BO4GuAk+86nFZv1Ud1V51U2yJ8Xn1W99QJtSHuMCrYpj6oQ2pVyrHy6oA6pebUF3U1TTCrngbcqh4FvKjORgS7Ixu0qPfFvib18DXMBWAh4G3gKaVbZ8Al0Fjsa1lKYiOwEfAYMBzjs8Bx8YBRIumWAc6BnoCXgJcYfwAMJhWmOWwG9gOeA8ZjfDewmVT4fx1eAaMBr/PxlnPAzE8c1gMrAQ8D/TG+HZgvxeFzqQ6/eoedwPJnDmt5/0UqgSbgAegNeC3kNIX8OuAQGAlrlaG2FrjOAKgFoDrF7XfjJpPJ1JSo8QfxBkLXHH/umPtpAAAAAElFTkSuQmCC"},ydj4:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("wx4u");function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,i){try{var s=t[a](i),o=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(o).then(function(e){n("next",e)},function(e){n("throw",e)});e(o)}("next")})}}var i={data:function(){return{plantsearch:"",plantPredictDialogShow:!1,cropList:[],searchHasResult:!0,tabindex:!0,cropTypeList:[]}},props:{corpactiveid:{default:"",type:String}},computed:{corpActiveId:{get:function(){return this.corpactiveid},set:function(e){this.$emit("update:corpactiveid",e)}}},watch:{plantsearch:function(e){var t=this;this.searchHasResult=!1,this.cropList.forEach(function(r){-1!==r.cropName.indexOf(e)?(r.nohas=!1,t.searchHasResult=!0):r.nohas=!0}),this.$nextTick(function(){$(t.$refs.plantlist).getNiceScroll().resize()})},tabindex:function(e){var t=this;this.$nextTick(function(){e?($(t.$refs.plantlist).getNiceScroll().show(),$(t.$refs.planttypelist).getNiceScroll().hide()):($(t.$refs.plantlist).getNiceScroll().hide(),1===$(t.$refs.planttypelist).getNiceScroll().length?$(t.$refs.planttypelist).getNiceScroll().show():$(t.$refs.planttypelist).niceScroll({cursorcolor:"rgba(0, 247, 255 ,0.4)",cursorwidth:"3px",cursorborder:"",autohidemode:!0,railpadding:{top:0,right:8,left:0,bottom:0}}))})}},mounted:function(){var e=this;return a(regeneratorRuntime.mark(function t(){var r,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getBreedList();case 2:return 200===(r=t.sent).status&&0===r.data.respCode&&r.data.obj.list&&(e.cropList=r.data.obj.list),e.$nextTick(function(){$(e.$refs.plantlist).niceScroll({cursorcolor:"rgba(0, 247, 255 ,0.4)",cursorwidth:"3px",cursorborder:"",autohidemode:!0,railpadding:{top:0,right:8,left:0,bottom:0}})}),t.next=7,e.getCropTypeList();case 7:200===(n=t.sent).status&&0===n.data.respCode&&n.data.obj&&(e.cropTypeList=n.data.obj.list);case 9:case"end":return t.stop()}},t,e)}))()},methods:{dislogChangeFn:function(e){e||(this.corpActiveId=""),this.plantPredictDialogShow=e,this.$emit("plantPredictDialogChangeEv",e)},showPlantDetailfn:function(e,t){var r=this;return a(regeneratorRuntime.mark(function n(){var a,i,s,o,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r.corpActiveId="crop"+e,n.next=3,r.getCropStatisticsRes(e);case 3:return 200===(a=n.sent).status&&0===a.data.respCode&&a.data.obj&&(i=a.data.obj.cropVO.cropSubjectIdentifier,s="种植","animal"!==i&&"fishery"!==i||(s="养殖"),o={type:"crop",Id:e,name:t,subjectNum:a.data.obj.farmTotal,plotNum:a.data.obj.landTotal,areaNum:a.data.obj.landArce,cropIdentifier:s},r.$emit("getPlantTitleEv",o)),n.next=7,r.getBreedAllPlots(e);case 7:200===(c=n.sent).status&&0===c.data.respCode&&c.data.obj&&r.$emit("getPlantAllPlotEv",[c.data.obj.list,t]);case 9:case"end":return n.stop()}},n,r)}))()},showCropTypeDetailfn:function(e,t){var r=this;return a(regeneratorRuntime.mark(function n(){var a,i,s,o,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r.corpActiveId="croptype"+e,n.next=3,r.getCropTypeStatisticsRes(e);case 3:return 200===(a=n.sent).status&&0===a.data.respCode&&a.data.obj&&(i=a.data.obj.cropSubjectVO.cropSubjectIdentifier||"agri",s="种植","animal"!==i&&"fishery"!==i||(s="养殖"),o={type:"croptype",Id:e,name:t,subjectNum:a.data.obj.farmTotal,plotNum:a.data.obj.landTotal,areaNum:a.data.obj.landArce,cropIdentifier:s},r.$emit("getPlantTitleEv",o)),n.next=7,r.getCropTypeAllPlots(e);case 7:200===(c=n.sent).status&&0===c.data.respCode&&c.data.obj&&r.$emit("getPlantAllPlotEv",[c.data.obj.list,t]);case 9:case"end":return n.stop()}},n,r)}))()},showCropPredictfn:function(e){this.$emit("plantPredictDialogChangeEv",!0),this.corpActiveId=e,this.plantPredictDialogShow=!0},getBreedList:function(){var e=this,t=JSON.parse(localStorage.govGovernmentSubjectVO),r=t.subjectLevel,n=[t.provinceId,t.provinceId,t.cityId,t.countyId];return new Promise(function(a){e.$ajax.post(e.$api.plotlist.getAreaCrop,{farmAreaId:[n[r]],farmAreaType:t.subjectLevel}).then(function(e){a(e)})})},getCropStatisticsRes:function(e){var t=this,r=JSON.parse(localStorage.govGovernmentSubjectVO),n=r.subjectLevel,a=[r.provinceId,r.provinceId,r.cityId,r.countyId];return new Promise(function(i){t.$ajax.post(t.$api.operators.getDataByCrop,{cropId:e,farmAreaId:[a[n]],farmAreaType:r.subjectLevel}).then(function(e){i(e)})})},getCropTypeStatisticsRes:function(e){var t=this,r=JSON.parse(localStorage.govGovernmentSubjectVO),n=r.subjectLevel,a=[r.provinceId,r.provinceId,r.cityId,r.countyId];return new Promise(function(i){t.$ajax.post(t.$api.operators.cropPlotStatistics,{cropCategoryId:e,farmAreaId:[a[n]],farmAreaType:r.subjectLevel}).then(function(e){i(e)})})},getBreedAllPlots:function(e){var t=this,r=JSON.parse(localStorage.govGovernmentSubjectVO),n=r.subjectLevel,a=[r.provinceId,r.provinceId,r.cityId,r.countyId];return new Promise(function(i){t.$ajax.post(t.$api.operators.getCropPoltId,{cropId:e,farmAreaId:[a[n]],farmAreaType:r.subjectLevel}).then(function(e){i(e)})})},getCropTypeList:function(){var e=this,t=JSON.parse(localStorage.govGovernmentSubjectVO),r=t.subjectLevel,n=[t.provinceId,t.provinceId,t.cityId,t.countyId];return new Promise(function(a){e.$ajax.post(e.$api.operators.cropCategorylistByArea,{farmAreaId:[n[r]],farmAreaType:t.subjectLevel}).then(function(e){a(e)})})},getCropTypeAllPlots:function(e){var t=this,r=JSON.parse(localStorage.govGovernmentSubjectVO),n=r.subjectLevel,a=[r.provinceId,r.provinceId,r.cityId,r.countyId];return new Promise(function(i){t.$ajax.post(t.$api.operators.cropCategoryAllGisPlotids,{cropCategoryId:e,farmAreaId:[a[n]],farmAreaType:r.subjectLevel}).then(function(e){i(e)})})}},components:{plantPredictDialog:n.default}},s=[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"search-btn"},[t("img",{attrs:{src:r("+BDs"),alt:""}}),this._v("搜索")])}],o=r("W5g0");var c=function(e){r("ckTI")},l=Object(o.a)(i,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"gis-plant-breed tabs-container"},[r("div",{staticClass:"tab-detail"},[r("h3",{staticClass:"title"},[r("span",{class:{active:e.tabindex},on:{click:function(){e.tabindex=!0}}},[e._v("在田品种")]),e._v(" "),r("span",{class:{active:!e.tabindex},on:{click:function(){e.tabindex=!1}}},[e._v("在田统计")])]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.tabindex,expression:"tabindex"}],staticClass:"list-detail"},[r("div",{staticClass:"list-search"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.plantsearch,expression:"plantsearch"}],attrs:{type:"text",placeholder:"搜索种养品种"},domProps:{value:e.plantsearch},on:{input:function(t){t.target.composing||(e.plantsearch=t.target.value)}}}),e._v(" "),e._m(0)]),e._v(" "),r("div",{ref:"plantlist",staticClass:"list-items"},[e.cropList&&e.cropList.length>0?r("div",[e._l(e.cropList,function(t,n){return!t.nohas&&e.searchHasResult?r("div",{key:t.cropId,staticClass:"item",class:{active:"crop"+t.cropId===e.corpActiveId}},[r("span",{staticClass:"plant-img",on:{click:function(r){return e.showPlantDetailfn(t.cropId,t.cropName)}}},[r("img",{attrs:{src:e._f("aliimg")(t.cropImgUrl,80,80,!0),alt:""}})]),e._v(" "),r("div",{staticClass:"name",on:{click:function(r){return e.showPlantDetailfn(t.cropId,t.cropName)}}},[r("p",{staticClass:"pyc"},[e._v(e._s(t.cropName))]),e._v(" "),r("p",{staticClass:"pyc"},[e._v(e._s(t.sumPlantAcre||0)+" 亩")])]),e._v(" "),r("span",{staticClass:"go-allplants",attrs:{title:"查看地块"},on:{click:function(r){return e.showPlantDetailfn(t.cropId,t.cropName)}}}),e._v(" "),r("span",{staticClass:"plant-plan",attrs:{title:"预计产量"},on:{click:function(r){return e.showCropPredictfn("crop"+t.cropId)}}})]):e._e()}),e._v(" "),e.searchHasResult?e._e():r("p",{staticClass:"nodata"},[e._v("当前搜索无结果")])],2):r("div",[r("p",{staticClass:"nodata"},[e._v("暂无种养品种")])])])]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!e.tabindex,expression:"!tabindex"}],staticClass:"list-detail"},[r("div",{ref:"planttypelist",staticClass:"list-items list-items-plus"},[e.cropTypeList&&e.cropTypeList.length>0?r("div",e._l(e.cropTypeList,function(t,n){return r("div",{key:t.id,staticClass:"cropSubject-con"},[r("p",{staticClass:"title"},[e._v("\n\t\t\t\t\t\t\t\t"+e._s(t.cropSubjectNickname)+"\n\t\t\t\t\t\t\t\t"),r("span",[e._v("共计"+e._s(t.sumPlantAcres)+"亩")])]),e._v(" "),e._l(t.stasticPlantAcreByCropCategory,function(t,n){return r("div",{key:t.cropCategoryId,staticClass:"item",class:{active:"croptype"+t.cropCategoryId===e.corpActiveId}},[r("span",{staticClass:"plant-img type-img",on:{click:function(r){return e.showCropTypeDetailfn(t.cropCategoryId,t.cropCategoryName)}}},[r("img",{attrs:{src:e._f("aliimg")(t.cropCategoryLogoUrl,80,80,!0),alt:""}})]),e._v(" "),r("div",{staticClass:"name",on:{click:function(r){return e.showCropTypeDetailfn(t.cropCategoryId,t.cropCategoryName)}}},[r("p",{staticClass:"pyc"},[e._v(e._s(t.cropCategoryName))]),e._v(" "),r("p",{staticClass:"pyc"},[e._v(e._s(t.sumPlantAcre||0)+" 亩")])]),e._v(" "),r("span",{staticClass:"go-allplants",attrs:{title:"查看地块"},on:{click:function(r){return e.showCropTypeDetailfn(t.cropCategoryId,t.cropCategoryName)}}}),e._v(" "),r("span",{staticClass:"plant-plan",attrs:{title:"预计产量"},on:{click:function(r){return e.showCropPredictfn("croptype"+t.cropCategoryId)}}})])})],2)}),0):r("div",[r("p",{staticClass:"nodata"},[e._v("暂无作物类型")])])])])])]),e._v(" "),e.plantPredictDialogShow?r("plant-predict-dialog",{attrs:{plantPredictDialog:e.plantPredictDialogShow,id:e.corpActiveId},on:{plantDialogChangeEv:e.dislogChangeFn}}):e._e()],1)},s,!1,c,null,null);t.default=l.exports}});
//# sourceMappingURL=56.cacfbe47b6683cc6c7d4.js.map