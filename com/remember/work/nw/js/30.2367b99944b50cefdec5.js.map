{"version":3,"file":"static/js/30.2367b99944b50cefdec5.js","sources":["webpack:///src/components/overview/operatorsDynamic11List.vue"],"sourcesContent":["<template>\r\n\t<div class=\"operators-dynamic-11-list\" v-loading=\"loading\" element-loading-spinner=\"iconfont icon-loading1\" element-loading-background=\"rgba(0, 0, 0, 0.2)\">\r\n\t\t<div class=\"top-select\" v-show=\"!loading\">\r\n\t\t\t<custom-select>\r\n\t\t\t\t<template slot=\"select-container\">\r\n\t\t\t\t\t<el-select v-model=\"showType\" :popper-class=\"selectStyle\" @change=\"refreshChart\">\r\n\t\t\t\t\t\t<el-option label=\"按日统计\" value=\"按日统计\"></el-option>\r\n\t\t\t\t\t\t<el-option label=\"按月统计\" value=\"按月统计\"></el-option>\r\n\t\t\t\t\t</el-select>\r\n\t\t\t\t</template>\r\n\t\t\t</custom-select>\r\n\t\t</div>\r\n\t\t<div v-show=\"!loading\" class=\"echart-container\" ref=\"EContainer\"></div>\r\n\t\t<div class=\"nodata\" v-if=\"noData\">暂无数据</div>\r\n\t</div>\r\n</template>\r\n<script>\r\nimport {dateFormat} from '@/common/fn/index.js';\r\nimport CustomSelect from '@/components/common/select.vue';\r\nconst xData = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];\r\nconst lineChartOption = {\r\n\ttitle: {\r\n\t\tshow: false,\r\n\t\ttext: '暂无数据',\r\n\t\ttextStyle: {\r\n\t\t\tfontSize: 12,\r\n\t\t\tcolor: '#6DC1CB',\r\n\t\t},\r\n\t\tleft: 'center',\r\n\t\ttop: 'center',\r\n\t},\r\n\tgrid: {\r\n\t\tshow: true,\r\n\t\tborderColor: '#0D394A',\r\n\t\tbottom: 55,\r\n\t\ttop: 60,\r\n\t\tleft: 60,\r\n\t\tright: 60,\r\n\t},\r\n\ttooltip: {\r\n\t\tshow: true,\r\n\t\ttrigger: 'axis',\r\n\t\tformatter(series) {\r\n\t\t\tconst seriesList = series.map(seriesInfo => {\r\n\t\t\t\treturn `${seriesInfo.seriesName}：${seriesInfo.data}${seriesInfo.seriesName === '填报条数' ? ' 条' : ' 家'}`;\r\n\t\t\t});\r\n\t\t\tvar name = series[0].name.split('|')[1];\r\n\t\t\treturn `${name}<br/>${seriesList.join('<br />')}`;\r\n\t\t},\r\n\t\tbackgroundColor: '#043250',\r\n\t\tpadding: [13, 14, 13, 11],\r\n\t\ttextStyle: {\r\n\t\t\tfontSize: 12,\r\n\t\t\tcolor: '#9ED2D8',\r\n\t\t},\r\n\t\tconfine: true,\r\n\t},\r\n\tcolor: ['#d2a352', '#00ffff'],\r\n\tlegend: {\r\n\t\tshow: true,\r\n\t\ttype: 'plain',\r\n\t\ttextStyle: {\r\n\t\t\tcolor: '#6DC1CB',\r\n\t\t\tfontSize: 12,\r\n\t\t\tlineHeight: 12,\r\n\t\t},\r\n\t\tbackgroundColor: 'rgba(255, 255, 255, 0)',\r\n\t\ttop: 18,\r\n\t\tleft: 'center',\r\n\t\titemWidth: 6,\r\n\t\titemHeight: 6,\r\n\t\titemGap: 25,\r\n\t\theight: 20,\r\n\t\ticon: 'circle',\r\n\t},\r\n\txAxis: {\r\n\t\ttype: 'category',\r\n\t\taxisTick: {show: false},\r\n\t\tboundaryGap: false,\r\n\t\taxisLine: {\r\n\t\t\tlineStyle: {\r\n\t\t\t\tcolor: 'rgba(50, 206, 187, 0.15)',\r\n\t\t\t},\r\n\t\t},\r\n\t\taxisLabel: {\r\n\t\t\tcolor: '#6DC1CB',\r\n\t\t\tfontSize: 14,\r\n\t\t\tverticalAlign: 'middle',\r\n\t\t\tpadding: [30, 0, 0, 0],\r\n\t\t\tformatter: function (e) {\r\n\t\t\t\treturn e.split('|')[0];\r\n\t\t\t},\r\n\t\t},\r\n\t\tdata: [],\r\n\t},\r\n\tyAxis: [\r\n\t\t{\r\n\t\t\ttype: 'value',\r\n\t\t\tname: '(单位：条)',\r\n\t\t\tsplitNumber: 8,\r\n\t\t\tnameTextStyle: {\r\n\t\t\t\tfontSize: 12,\r\n\t\t\t\tcolor: '#6DC1CB',\r\n\t\t\t\tpadding: [4, 8, 5, 10],\r\n\t\t\t},\r\n\t\t\taxisLine: {\r\n\t\t\t\tshow: true,\r\n\t\t\t\tonZero: true,\r\n\t\t\t\tlineStyle: {\r\n\t\t\t\t\tcolor: '#0D394A',\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\taxisTick: {\r\n\t\t\t\tshow: false,\r\n\t\t\t},\r\n\t\t\tsplitLine: {\r\n\t\t\t\tshow: true,\r\n\t\t\t\tlineStyle: {\r\n\t\t\t\t\tcolor: 'rgba(109,193,203,0.2)',\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\taxisLabel: {\r\n\t\t\t\ttextStyle: {\r\n\t\t\t\t\tcolor: '#6DC1CB',\r\n\t\t\t\t\tfontSize: 12,\r\n\t\t\t\t},\r\n\t\t\t\tformatter: '{value}',\r\n\t\t\t},\r\n\t\t\tscale: true,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: 'value',\r\n\t\t\tname: '(单位：家)',\r\n\t\t\tsplitNumber: 8,\r\n\t\t\tnameTextStyle: {\r\n\t\t\t\tfontSize: 12,\r\n\t\t\t\tcolor: '#6DC1CB',\r\n\t\t\t\tpadding: [4, 8, 5, 10],\r\n\t\t\t},\r\n\t\t\taxisLine: {\r\n\t\t\t\tshow: true,\r\n\t\t\t\tonZero: true,\r\n\t\t\t\tlineStyle: {\r\n\t\t\t\t\tcolor: '#0D394A',\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\taxisTick: {\r\n\t\t\t\tshow: false,\r\n\t\t\t},\r\n\t\t\tsplitLine: {\r\n\t\t\t\tshow: false,\r\n\t\t\t\tlineStyle: {\r\n\t\t\t\t\t// color: '#0D394A'\r\n\t\t\t\t\tcolor: 'rgba(109,193,203,0.2)',\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\taxisLabel: {\r\n\t\t\t\tshow: true,\r\n\t\t\t\ttextStyle: {\r\n\t\t\t\t\tcolor: '#6DC1CB',\r\n\t\t\t\t\tfontSize: 12,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tscale: true,\r\n\t\t},\r\n\t],\r\n\tseries: [\r\n\t\t{\r\n\t\t\tname: '填报条数',\r\n\t\t\tyAxisIndex: 0,\r\n\t\t\tdata: [],\r\n\t\t\ttype: 'line',\r\n\t\t\tsmooth: true,\r\n\t\t\tsymbolSize: 0,\r\n\t\t\tconnectNulls: true,\r\n\t\t\tareaStyle: {\r\n\t\t\t\tcolor: {\r\n\t\t\t\t\ttype: 'linear',\r\n\t\t\t\t\tx: 0,\r\n\t\t\t\t\ty: 0,\r\n\t\t\t\t\tx2: 0,\r\n\t\t\t\t\ty2: 1,\r\n\t\t\t\t\tcolorStops: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\toffset: 0,\r\n\t\t\t\t\t\t\tcolor: 'rgba(212,164,82, 0.5)', // 0% 处的颜色\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\toffset: 1,\r\n\t\t\t\t\t\t\tcolor: 'rgba(212,164,82, 0)', // 100% 处的颜色\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t],\r\n\t\t\t\t\tglobal: false, // 缺省为 false\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tlineStyle: {\r\n\t\t\t\tcolor: '#d2a352',\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: '填报经营主体数',\r\n\t\t\tyAxisIndex: 1,\r\n\t\t\tdata: [],\r\n\t\t\ttype: 'line',\r\n\t\t\tsmooth: true,\r\n\t\t\tsymbolSize: 0,\r\n\t\t\tconnectNulls: true,\r\n\t\t\tareaStyle: {\r\n\t\t\t\tcolor: {\r\n\t\t\t\t\ttype: 'linear',\r\n\t\t\t\t\tx: 0,\r\n\t\t\t\t\ty: 0,\r\n\t\t\t\t\tx2: 0,\r\n\t\t\t\t\ty2: 1,\r\n\t\t\t\t\tcolorStops: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\toffset: 0,\r\n\t\t\t\t\t\t\tcolor: 'rgba(0,255,255, 0.5)', // 0% 处的颜色\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\toffset: 1,\r\n\t\t\t\t\t\t\tcolor: 'rgba(0,255,255, 0)', // 100% 处的颜色\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t],\r\n\t\t\t\t\tglobal: false, // 缺省为 false\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tlineStyle: {\r\n\t\t\t\tcolor: '#00ffff',\r\n\t\t\t},\r\n\t\t},\r\n\t],\r\n};\r\nimport {areaLevelCorAreaId} from '@/common/fn';\r\nimport {areaData, areaMap} from '@/common/config/filterArea.js';\r\nexport default {\r\n\tprops: {\r\n\t\tfarmAreaInfo: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault() {\r\n\t\t\t\treturn areaLevelCorAreaId();\r\n\t\t\t},\r\n\t\t},\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tloading: false,\r\n\t\t\tchartInstance: null,\r\n\t\t\tnoData: false,\r\n\t\t\tshowType: '按日统计',\r\n\t\t};\r\n\t},\r\n\tmounted() {\r\n\t\tthis.$nextTick(() => {\r\n\t\t\tthis.initMoudle();\r\n\t\t});\r\n\t\t// 适配图表l字体大小\r\n\t\twindow.addEventListener('resize', this.adaptationChart);\r\n\t\tthis.$once('hook:beforeDestroy', function () {\r\n\t\t\twindow.removeEventListener('resize', this.adaptationChart);\r\n\t\t});\r\n\t},\r\n\tmethods: {\r\n\t\tasync initMoudle() {\r\n\t\t\tthis.loading = true;\r\n\t\t\tthis.chartInstance = this._initEcharts(this.eContainerRef, lineChartOption);\r\n\t\t\tawait this.refreshChart();\r\n\t\t\tthis.loading = false;\r\n\t\t},\r\n\t\tasync refreshChart() {\r\n\t\t\tthis.loading = true;\r\n\t\t\tvar xylist = await this.getChartList(this.showTypeIndex); //默认按天展示\r\n\t\t\tif (!xylist.length) return;\r\n\t\t\tthis._refreshChart(this.chartInstance, xylist);\r\n\t\t\tthis.loading = false;\r\n\t\t},\r\n\t\trefreshRender() {\r\n\t\t\tif (this.chartInstance) {\r\n\t\t\t\tthis.chartInstance.resize();\r\n\t\t\t}\r\n\t\t},\r\n\t\t_initEcharts(el, option) {\r\n\t\t\tconst chart = this.$echarts.init(el);\r\n\t\t\tchart.setOption(option);\r\n\t\t\treturn chart;\r\n\t\t},\r\n\t\t_refreshChart(chartInstance, list) {\r\n\t\t\tvar xlist = list.map(item => item.x);\r\n\t\t\tvar y1list = list.map(item => item.y1);\r\n\t\t\tvar y2list = list.map(item => item.y2);\r\n\t\t\tconst chartOpts = {\r\n\t\t\t\txAxis: {\r\n\t\t\t\t\ttype: 'category',\r\n\t\t\t\t\tdata: xlist,\r\n\t\t\t\t},\r\n\t\t\t\tseries: [\r\n\t\t\t\t\t{name: '填报条数', type: 'line', data: y2list},\r\n\t\t\t\t\t{name: '填报经营主体数', type: 'line', data: y1list},\r\n\t\t\t\t],\r\n\t\t\t};\r\n\t\t\tchartInstance.setOption(chartOpts);\r\n\t\t},\r\n\t\tasync getChartList(type) {\r\n\t\t\t//0按天统计 1按月统计\r\n\t\t\tlet {xlist, startTime, endTime} = this.handerParams(type);\r\n\t\t\tvar listResult = await this.getListData(+new Date(startTime), +new Date(endTime), type);\r\n\t\t\tlet isMonth = Boolean(type);\r\n\t\t\tif (!listResult) return;\r\n\t\t\tvar listObj = {};\r\n\t\t\tlistResult.map(item => {\r\n\t\t\t\tvar x = this.formatDate(item.date, '', isMonth);\r\n\t\t\t\tlistObj[x] = {\r\n\t\t\t\t\ty1: item.reportingBusinessEntityCount, //填报经营主体数\r\n\t\t\t\t\ty2: item.reportingCount, //填报数\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t\tvar xstrList = xlist.map(item => this.formatDate(item, '', isMonth));\r\n\t\t\treturn xstrList.map((x, index) => {\r\n\t\t\t\tvar xvalue = isMonth ? this.$options.filters.dateFormat(xlist[index], 'yyyy年MM月') : this.$options.filters.dateFormat(xlist[index], 'MM月dd日');\r\n\t\t\t\tvar tipValue = isMonth ? this.$options.filters.dateFormat(xlist[index], 'yyyy年MM月') : this.$options.filters.dateFormat(xlist[index], 'yyyy年MM月dd日');\r\n\t\t\t\tif (listObj[x]) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tx: xvalue + '|' + tipValue,\r\n\t\t\t\t\t\t...listObj[x],\r\n\t\t\t\t\t};\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tx: xvalue + '|' + tipValue,\r\n\t\t\t\t\t\ty1: 0,\r\n\t\t\t\t\t\ty2: 0,\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tgetListData(start, end, type) {\r\n\t\t\tlet ids = areaData.map(item => item.id);\r\n\t\t\treturn this.$ajax\r\n\t\t\t\t.post(this.$api.produce.farmRealTimeDynamic.statisticsByDate, {\r\n\t\t\t\t\tfarmAreaId: [this.farmAreaInfo.farmAreaId],\r\n\t\t\t\t\tfarmAreaType: this.farmAreaInfo.farmAreaType,\r\n\t\t\t\t\tstartTime: start,\r\n\t\t\t\t\tendTime: end,\r\n\t\t\t\t\ttype: type, //0按天统计 1按月统计\r\n\t\t\t\t})\r\n\t\t\t\t.then(({data}) => {\r\n\t\t\t\t\tif (data.respCode === 0) {\r\n\t\t\t\t\t\treturn data.obj;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.catch(e => {\r\n\t\t\t\t\tconsole.log('生产作业上报 error: ', e);\r\n\t\t\t\t});\r\n\t\t},\r\n\t\thanderParams(type) {\r\n\t\t\tvar nowTime = new Date();\r\n\t\t\tvar nowTemp = nowTime.getFullYear() + '-' + (nowTime.getMonth() + 1) + '-' + nowTime.getDate();\r\n\t\t\tif (type) {\r\n\t\t\t\t//1 按月统计\r\n\t\t\t\tvar endTime = this.$options.filters.dateFormat(new Date(nowTemp).setMonth(nowTime.getMonth() + 2), 'yyyy-MM-01');\r\n\t\t\t\tvar temp = new Date(new Date().setMonth(nowTime.getMonth() - 5));\r\n\t\t\t\tvar startTime = temp.getFullYear() + '-' + (temp.getMonth() + 1) + '-' + temp.getDate();\r\n\t\t\t\tvar xlist = new Array(6).fill(0).map((item, index) => new Date(new Date(startTime).setMonth(new Date(startTime).getMonth() + index)));\r\n\t\t\t} else {\r\n\t\t\t\t//0 按天统计\r\n\t\t\t\tvar endTime = this.$options.filters.dateFormat(new Date(nowTemp).setDate(nowTime.getDate() + 1), 'yyyy-MM-dd');\r\n\t\t\t\tvar temp = new Date(new Date().setMonth(nowTime.getMonth() - 1));\r\n\t\t\t\tvar startTime = temp.getFullYear() + '-' + (temp.getMonth() + 1) + '-' + temp.getDate();\r\n\t\t\t\tvar dayLen = Math.floor((new Date(endTime).getTime() - new Date(startTime).getTime()) / 86400000);\r\n\t\t\t\tvar xlist = new Array(dayLen).fill(0).map((item, index) => new Date(new Date(startTime).setDate(new Date(startTime).getDate() + index)));\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\txlist,\r\n\t\t\t\tstartTime,\r\n\t\t\t\tendTime,\r\n\t\t\t};\r\n\t\t},\r\n\t\tformatDate(time, character = '', onlyMonth = false) {\r\n\t\t\tlet date;\r\n\t\t\tif (typeof time === 'string' || typeof time === 'number') {\r\n\t\t\t\tdate = new Date(time);\r\n\t\t\t} else if (time instanceof Date) {\r\n\t\t\t\tdate = time;\r\n\t\t\t} else {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\tconst YY = date.getFullYear();\r\n\t\t\tconst MM = date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1;\r\n\t\t\tconst DD = date.getDate() < 10 ? '0' + date.getDate() : date.getDate();\r\n\t\t\treturn onlyMonth ? YY + character + MM : YY + character + MM + character + DD;\r\n\t\t},\r\n\t},\r\n\tcomputed: {\r\n\t\teContainerRef() {\r\n\t\t\treturn this.$refs.EContainer;\r\n\t\t},\r\n\t\tshowTypeIndex() {\r\n\t\t\treturn this.showType === '按日统计' ? 0 : 1;\r\n\t\t},\r\n\t},\r\n\tcomponents: {\r\n\t\tCustomSelect,\r\n\t},\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n/deep/.top-select .custom-select .el-select .el-input__inner {\r\n\twidth: 105px;\r\n\theight: 30px;\r\n\tline-height: 30px;\r\n}\r\n.operators-dynamic-11-list {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tposition: relative;\r\n\t.top-select {\r\n\t\tposition: absolute;\r\n\t\ttop: -31px;\r\n\t\tleft: 26px;\r\n\t}\r\n\t.echart-container {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t}\r\n\t.nodata {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tfont-size: 16px;\r\n\t\tcolor: #02cad4;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\r\n}\r\n/deep/ .el-loading-spinner {\r\n\toverflow: hidden;\r\n\t.iconfont {\r\n\t\tdisplay: block;\r\n\t\tfont-size: 40px;\r\n\t\tcolor: #00f6ff;\r\n\t\tanimation: loading 1.25s linear infinite;\r\n\t\tmargin-top: 24px;\r\n\t\tmargin-left: 8px;\r\n\t}\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/overview/operatorsDynamic11List.vue"],"mappings":"AAmBA","sourceRoot":""}