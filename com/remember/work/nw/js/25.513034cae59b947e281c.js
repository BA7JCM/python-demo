webpackJsonp([25],{BvCB:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("xk5x"),o=r("VCTt"),a=r("VKKs");function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(o,a){try{var i=t[o](a),c=i.value}catch(e){return void r(e)}if(!i.done)return Promise.resolve(c).then(function(e){n("next",e)},function(e){n("throw",e)});e(c)}("next")})}}var c={title:{show:!1,text:"暂无数据",textStyle:{fontSize:12,color:"#6DC1CB"},left:"center",top:"center"},grid:{show:!0,borderColor:"#0D394A",bottom:30,top:40,right:20},tooltip:{show:!0,trigger:"axis",formatter:function(e){var t=e.map(function(e){return null!==e.value?e.seriesName+"："+Object(o.j)({value:e.value})+"元/公斤":""});return e[0].axisValue+"<br/>"+t.join("<br />")},backgroundColor:"#043250",padding:[13,14,13,11],textStyle:{fontSize:12,color:"#9ED2D8"}},legend:{show:!0,type:"plain",textStyle:{color:"#6DC1CB",fontSize:12},backgroundColor:"rgba(255, 255, 255, 0)",top:3,right:10,itemWidth:30,itemHeight:10,height:20,data:[{name:(new Date).getFullYear()-1+"年",icon:"image://"+r("Zg+v")},{name:(new Date).getFullYear()+"年",icon:"image://"+r("IG9e")}]},xAxis:{data:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],boundaryGap:!1,axisLabel:{textStyle:{color:"#6DC1CB",fontSize:12},align:"center"},axisTick:{show:!1},axisLine:{show:!0,lineStyle:{color:"rgba(109,193,203,0.2)"}},z:10},yAxis:{name:"(元/公斤)",nameTextStyle:{fontSize:12,color:"#6DC1CB",padding:[4,8,5,10]},axisLine:{show:!1,lineStyle:{color:"#0D394A"}},axisTick:{show:!1},splitLine:{show:!0,lineStyle:{color:"rgba(109,193,203,0.2)"}},axisLabel:{textStyle:{color:"#6DC1CB",fontSize:12}}},series:[{data:[],type:"line",smooth:!0,symbolSize:0,areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(0, 162, 255, 0.5)"},{offset:1,color:"rgba(60, 105, 217, 0)"}],global:!1}},lineStyle:{color:"#00FFFF"}},{data:[],type:"line",smooth:!0,symbolSize:0,areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(212, 167, 84, 0.5)"},{offset:1,color:"rgba(212, 167, 84, 0)"}],global:!1}},lineStyle:{color:"#D4A452"}}]},s=Object(a.b)("govGovernmentSubjectVO"),l=Object(a.b)("vegetableVariety"),u={name:"market-supervision-20",props:{farmAreaInfo:{type:Object,default:function(){return Object(o.b)()}}},data:function(){return{chart:null,loading:!1,priceType:0,priceTypeList:[{name:"田头价",id:0},{name:"批发价",id:1}],vegetableVariety:[],cropId:null}},mounted:function(){this.initPage()},methods:{initPage:function(){var e=this;return i(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.chart=e._initEcharts(e.eContainerRef,c),t.next=3,e.updateCropList();case 3:e.updateCropPrice();case 4:case"end":return t.stop()}},t,e)}))()},updateCropList:function(){var e=this;return i(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.vegetableVariety=[],!e.priceType){t.next=6;break}return t.next=4,e.processDefaultCropList();case 4:t.next=8;break;case 6:return t.next=8,e.processTtjCropList();case 8:case"end":return t.stop()}},t,e)}))()},updateCropPrice:function(){var e=this;return i(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.loading=!0,!e.priceType){t.next=6;break}return t.next=4,e.getCropPriceTable();case 4:t.next=8;break;case 6:return t.next=8,e.processTtPrice();case 8:e.loading=!1;case 9:case"end":return t.stop()}},t,e)}))()},getTtjCropList:function(){return this.$ajax.post(this.$api.operate.ttjCropList,{pageNo:1,pageSize:1e4}).then(function(e){var t=e.data;if(0===t.respCode)return t.obj;throw new Error(t)}).catch(function(e){throw console.log(e),e})},getDefaultCropList:function(){return this.$ajax.post(this.$api.market.cropList,{areaId:s.provinceId,keyword:"",pageNo:1,pageSize:1e4}).then(function(e){var t=e.data;if(0===t.respCode)return Object(a.c)("cropTime",t.curDate),t.obj;throw new Error(t)}).catch(function(e){throw console.log(e),e})},getCropPriceStatisticList:function(){return this.$ajax.post(this.$api.operate.cropPriceStatisticList,{yearsList:[""+(new Date).getFullYear(),""+((new Date).getFullYear()-1)],cropId:this.cropId,provinceId:s.provinceId}).then(function(e){var t=e.data;if(0===t.respCode)return t.obj;throw new Error(t)}).catch(function(e){throw console.log(e),e})},getCropPriceTable:function(){var e=this;return i(regeneratorRuntime.mark(function t(){var r,n,a,i,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=(new Date).getFullYear(),n=(new Date).getMonth(),a=Object(o.h)({startTime:r+"-01-01",howMonth:n}),i=r-1,c=Object(o.h)({startTime:i+"-01-01"}),t.abrupt("return",e.$ajax.all([e.$ajax.post(e.$api.market.cropPrice,{dateListStr:a,nccropId:e.cropId,proviceId:s.provinceId}),e.$ajax.post(e.$api.market.cropPrice,{dateListStr:c,nccropId:e.cropId,proviceId:s.provinceId})]).then(function(t){if(t){var n=t[0].data,a=t[1].data,c=0,s=0;0===n.respCode&&n.obj.forEach(function(e){c+=e.price}),0===a.respCode&&a.obj.forEach(function(e){s+=e.price});var l=0!==c||0!==s;e.chart.setOption({tooltip:{show:l},title:{show:!l},yAxis:{show:!0},xAxis:{show:l},series:l?[{name:Object(o.c)(i+"-01-01","yyyy年"),data:0===a.respCode?a.obj.map(function(e){return{name:e.ncCropName,value:e.price}}):[],symbol:"circle",symbolSize:2,color:"#00F6FF"},{name:Object(o.c)(r+"-01-01","yyyy年"),data:0===n.respCode?n.obj.map(function(e){return{name:e.ncCropName,value:e.price}}):[],symbol:"circle",symbolSize:2,color:"#FBC02D"}]:[{data:[]},{data:[]}]})}}));case 6:case"end":return t.stop()}},t,e)}))()},processDefaultCropList:function(){var e=this;return i(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise(function(t,r){if(e.checkCropReload()&&l&&l.length){e.vegetableVariety=l.map(function(e){return{crop:e.ncCropName,cropId:e.id}});try{return e.cropId=l[0].id,t()}catch(e){console.log(e),r(e)}}else e.getDefaultCropList().then(function(r){Object(a.c)("vegetableVariety",r.list),e.vegetableVariety=r.list.map(function(e){return{crop:e.ncCropName,cropId:e.id}});try{return e.cropId=e.vegetableVariety[0].cropId,t()}catch(e){throw new Error(e)}}).catch(function(e){console.log(e),r(e)})});case 2:case"end":return t.stop()}},t,e)}))()},processTtjCropList:function(){var e=this;return i(regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getTtjCropList();case 3:r=t.sent,e.vegetableVariety=r.list.map(function(e){return{crop:e.cropName,cropId:e.id}}),e.cropId=e.vegetableVariety[0].cropId,t.next=12;break;case 8:throw t.prev=8,t.t0=t.catch(0),console.log(t.t0),t.t0;case 12:case"end":return t.stop()}},t,e,[[0,8]])}))()},processTtPrice:function(){var e=this;return i(regeneratorRuntime.mark(function t(){var r,n,a,i,c,s,l,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getCropPriceStatisticList();case 2:r=t.sent,n=r[0].data.slice(0,12),a=r[1].data.slice(0,12),i=n.reduce(function(e,t){return e+t},0),c=a.reduce(function(e,t){return e+t},0),s=(new Date).getFullYear(),l=s-1,u=0!==i||0!==c,e.chart.setOption({tooltip:{show:u},title:{show:!u},yAxis:{show:!0},xAxis:{show:u},series:u?[{name:Object(o.c)(l+"-01-01","yyyy年"),data:a.map(function(e,t){return{name:t+1+"月",value:e}}),symbol:"circle",symbolSize:2,color:"#00F6FF"},n.length?{name:Object(o.c)(s+"-01-01","yyyy年"),data:n.map(function(e,t){return{name:t+1+"月",value:e}}),symbol:"circle",symbolSize:2,color:"#FBC02D"}:{data:[]},,]:[{data:[]},{data:[]}]});case 11:case"end":return t.stop()}},t,e)}))()},selectCrop:function(){var e=this;this.chart.setOption({series:[{data:[]},{data:[]}]}),this.updateCropPrice(),this.$nextTick(function(){e.$refs.cropSearch.blur()})},selectPriceType:function(){var e=this;return i(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.updateCropList();case 2:e.chart.setOption({series:[{data:[]},{data:[]}]}),e.updateCropPrice(),e.$nextTick(function(){e.$refs.priceType.blur()});case 5:case"end":return t.stop()}},t,e)}))()},checkCropReload:function(){var e=Object(a.b)("cropTime");if(!e)return!0;e=Number(e);var t=new Date(e).getMonth();return new Date(e).setMonth(t+1,1)>=(new Date).getTime()},_initEcharts:function(e,t){var r=this.$echarts.init(e);return r.setOption(t),r},refreshRender:function(){this.chart&&this.chart.resize()}},computed:{eContainerRef:function(){return this.$refs.EContainer}},components:{areaPanel:n.default}},p=r("W5g0");var d=function(e){r("No18")},f=Object(p.a)(u,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"market-supervision-20",attrs:{"element-loading-spinner":"iconfont icon-loading1","element-loading-background":"rgba(0, 0, 0, 0.2)"}},[r("area-panel",{attrs:{"area-title":"田头价格监测",titleLeft:""}},[r("div",{staticClass:"sub-title",attrs:{slot:"subTitle"},slot:"subTitle"},[r("el-select",{ref:"priceType",staticClass:"vegetable-select",attrs:{slot:"subTitle",placeholder:"请选择",filterable:""},on:{change:e.selectPriceType},slot:"subTitle",model:{value:e.priceType,callback:function(t){e.priceType=t},expression:"priceType"}},e._l(e.priceTypeList,function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1),e._v(" "),r("el-select",{ref:"cropSearch",staticClass:"vegetable-select two",attrs:{slot:"subTitle",placeholder:"请选择",filterable:""},on:{change:e.selectCrop},slot:"subTitle",model:{value:e.cropId,callback:function(t){e.cropId=t},expression:"cropId"}},e._l(e.vegetableVariety,function(e,t){return r("el-option",{key:t,attrs:{label:e.crop,value:e.cropId}})}),1)],1),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"main-panel",attrs:{slot:"panelMain"},slot:"panelMain"},[r("div",{ref:"EContainer",staticClass:"echart-container"})])])],1)},[],!1,d,"data-v-883e367c",null);t.default=f.exports},No18:function(e,t){}});
//# sourceMappingURL=25.513034cae59b947e281c.js.map