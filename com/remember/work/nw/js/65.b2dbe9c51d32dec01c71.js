webpackJsonp([65],{Luci:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("dXA3"),r=n.n(o),i=n("gCAq"),s=n.n(i),a=n("VKKs");function c(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function o(r,i){try{var s=t[r](i),a=s.value}catch(e){return void n(e)}if(!s.done)return Promise.resolve(a).then(function(e){o("next",e)},function(e){o("throw",e)});e(a)}("next")})}}var u={name:"login",data:function(){return{loginForm:{loginName:null,password:null,loginFocus:!1,passwordFocus:!1},loginNameRule:[{required:!0,message:"请输入账号",trigger:"blur"},{validator:function(e,t,n){return/^(?:[\da-zA-Z!@#$%^&*]{1,10000})$/.test(t)?n():n(new Error("请输入正确的账号"))},trigger:"blur,change"}],passwordRule:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:function(e,t,n){return/^(?:[\da-zA-Z!@#$%^&*]{1,10000})$/.test(t)?n():n(new Error("密码格式不正确"))},trigger:"blur,change"}],bg:r.a}},created:function(){this.checkLogin()},mounted:function(){var e=this;this.$nextTick(function(){if(!e.$refs.bgPic)return!1;e.$refs.bgPic.onload=function(){e.bg=s.a}})},methods:{checkLogin:function(){Object(a.b)("accessToken")&&this.$router.push({name:"home"})},checkLoginForm:function(e){var t=this;return c(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t.$refs[e].validate(function(){var e=c(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=3;break}return e.next=3,t.doLogin();case 3:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return n.stop()}},n,t)}))()},doLogin:function(){var e=this;return c(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise(function(t,n){e.$ajax.post(e.$api.login.login,e.loginForm,{}).then(function(t){var o=t.data;if(0===o.respCode)return Object(a.c)("accessToken",o.obj.accessToken),window.location.href="/home",!0;e.$message({type:"warning",message:o.respDesc,center:!0}),n(new Error("登录错误！"))}).catch(function(){e.$message({type:"error",message:"网络异常",center:!0})})});case 2:case"end":return t.stop()}},t,e)}))()},forceChange:function(e){this.$forceUpdate()}},components:{effectBackground:n("gEm0").default}},l=n("W5g0");var f=function(e){n("xS3o")},g=Object(l.a)(u,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"title",rawName:"v-title"}],staticClass:"login-page",style:{background:"#020b1d url("+e.bg+") no-repeat bottom"},attrs:{"data-title":"登录"},on:{keyup:function(t){return t.type.indexOf("key")||13===t.keyCode?e.checkLoginForm("loginForm"):null}}},[n("effect-background"),e._v(" "),n("div",{staticClass:"login-box"},[n("p",{staticClass:"login-describe"},[e._v("数据来源于真实的农业生产过程")]),e._v(" "),n("el-form",{ref:"loginForm",attrs:{model:e.loginForm}},[n("input",{staticStyle:{position:"absolute",top:"-999px"},attrs:{type:"text",autocomplete:"off"}}),e._v(" "),n("input",{staticStyle:{position:"absolute",top:"-999px"},attrs:{type:"password",autocomplete:"off"}}),e._v(" "),n("el-form-item",{attrs:{prop:"loginName",rules:e.loginNameRule}},[n("el-input",{class:{focus:e.loginForm.loginFocus},attrs:{autocomplete:"off",placeholder:"账号",type:"text"},on:{focus:function(t){e.loginForm.loginFocus=!0},blur:function(t){e.loginForm.loginFocus=!1},input:function(t){return e.forceChange(t)}},model:{value:e.loginForm.loginName,callback:function(t){e.$set(e.loginForm,"loginName",t)},expression:"loginForm.loginName"}},[n("i",{staticClass:"iconfont icon-zhanghu",attrs:{slot:"prefix"},slot:"prefix"})])],1),e._v(" "),n("el-form-item",{attrs:{prop:"password",rules:e.passwordRule}},[n("el-input",{class:{focus:e.loginForm.passwordFocus},attrs:{type:"password",placeholder:"密码",autocomplete:"off"},on:{focus:function(t){e.loginForm.passwordFocus=!0},blur:function(t){e.loginForm.passwordFocus=!1},input:function(t){return e.forceChange(t)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}},[n("i",{staticClass:"iconfont icon-password",attrs:{slot:"prefix"},slot:"prefix"})])],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{"native-type":"button"},on:{click:function(t){return e.checkLoginForm("loginForm")}}},[e._v("登 录 ")])],1)],1)],1)],1)},[],!1,f,"data-v-302450fa",null);t.default=g.exports},dXA3:function(e,t){e.exports="https://snkoudai.oss-cn-hangzhou.aliyuncs.com/goverment/static/img/_login-bg.ef58e27.jpg"},gCAq:function(e,t){e.exports="https://snkoudai.oss-cn-hangzhou.aliyuncs.com/goverment/static/img/login-bg-b.5d5e59f.jpg"},xS3o:function(e,t){}});
//# sourceMappingURL=65.b2dbe9c51d32dec01c71.js.map