webpackJsonp([60,74],{"9feC":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Wftt"),n=a("XR6P"),r=a("VCTt"),o=a("VKKs");var s={tooltip:{show:!0,trigger:"item",formatter:"{b} <br/>面积: {c}万亩({d}%)"},color:["#E6AA4A","#BD4280","#A778F9","#AFBE3D","#0FEF34","#01B649","#32CEBB","#02B8FF","#7EE2E1","#85B5D5","#c4ccd3"],textStyle:{color:"#9DD1D7",fontSize:14,fontWeight:"400",lineHeight:14},series:[{name:"用地类型分布",type:"pie",radius:["44%","60%"],avoidLabelOverlap:!0,minAngle:15,startAngle:30,label:{normal:{show:!0,position:"outside",formatter:"{b}: {d}%"}},labelLine:{normal:{show:!0,length:10,length2:20}},hoverAnimation:!1,data:[]},{type:"pie",radius:["47.9%","54.4%"],minAngle:15,startAngle:90,itemStyle:{normal:{show:!0,color:"rgba(255,255,255,0.42)"},emphasis:{show:!0,color:"rgba(255,255,255,0.42)"}},animation:!0,labelLine:{show:!1},hoverAnimation:!1,z:3,tooltip:{show:!1},data:[0]}]},l=Object(r.b)(),c=Object(o.b)("govGovernmentSubjectVO").groupFlag,d={name:"landSource",data:function(){return{lTypeDis:null,lTypeDisData:Object(r.d)(s),pStandardDis:null,pStandardDisData:Object(r.d)(s),landTypeDetails:null,plantingStandardDetails:null,gisdata:null,lTypeDScroll:null,pSDScroll:null,gisget:!1}},mounted:function(){var t=this;this.$nextTick(function(){t.lTypeDis=t._initEcharts(t.$refs.lTypeDis,t.lTypeDisData),t.pStandardDis=t._initEcharts(t.$refs.pStandardDis,t.pStandardDisData),t.lTypeDScroll=Object(r.a)(t.$refs.landTypeDetails.$el.querySelector(".el-table__body-wrapper")),t.pSDScroll=Object(r.a)(t.$refs.plantingStandardDetails.$el.querySelector(".el-table__body-wrapper")),t.lTypeDis.resize(),t.pStandardDis.resize(),t.getAllData(),t.renderLandType(),t.getStatisticsAcre()}),window.onresize=function(){t.lTypeDis.resize(),t.pStandardDis.resize()}},activated:function(){},deactivated:function(){},methods:{getPlotTypeStatistical:function(){return this.$ajax.post(this.$api.plotlist.landTypeDistributionlist,{}).then(function(t){var e=t.data;if(0===e.respCode)return e.obj}).catch(function(t){console.log(new Error("获取用地类型"),t)})},getAreaLandTypeDistribution:function(){return this.$ajax.post(this.$api.public.areaLandTypeDistribution,{farmAreaId:[l.farmAreaId],farmAreaType:l.farmAreaType}).then(function(t){var e=t.data;if(0===e.respCode)return e.obj}).catch(function(t){console.log(new Error("获取用地类型---非集团版本"),t)})},renderLandType:function(){var t,e=this;return(t=regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0===c?e.getAreaLandTypeDistribution:e.getPlotTypeStatistical)();case 2:a=t.sent,e.landTypeDetails=a.list.map(function(t){return{landType:t.landType,area:t.landAcre/1e4,numberOfPlots:t.landNum}}),e.lTypeDis.setOption({series:[{name:"用地类型分布",data:e.landTypeDetails.map(function(t){return{name:t.landType,value:t.area}})}]}),e.$nextTick(function(){e.lTypeDScroll.refresh()});case 6:case"end":return t.stop()}},t,e)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function i(n,r){try{var o=e[n](r),s=o.value}catch(t){return void a(t)}if(!o.done)return Promise.resolve(s).then(function(t){i("next",t)},function(t){i("throw",t)});t(s)}("next")})})()},_initEcharts:function(t,e){var a=this.$echarts.init(t);return a.setOption(e),a},getAllData:function(){var t=this;this.$ajax.post(this.$api.landSource.index,{}).then(function(e){var a=e.data,i=void 0;if(0===a.respCode)return i=a.obj,t.gisget=!0,t.gisdata=i.gisDistributionVOList,!0})},getStatisticsAcre:function(){var t=this;this.$ajax.post(this.$api.landSource.statisticsAcre,{farmAreaId:[l.farmAreaId],farmAreaType:l.farmAreaType}).then(function(e){var a=e.data,i=a.obj,n=void 0;if(0===a.respCode){try{t.plantingStandardDetails=i.plantAcreAndLandNumVOS.map(function(t){return{plantStandard:t.cropName,area:Object(r.j)({value:t.sumPlantAcre/1e4,places:4}),numberOfPlots:t.landNum}}),n=i.plantAcreAndCropVOS.map(function(t){return{name:t.cropName,value:Object(r.j)({value:t.sumPlantAcre/1e4,places:4})}}),t.pStandardDis.setOption({tooltip:{position:function(t,e,a){return t[0]=t[0]-a.clientWidth-40,[t[0],t[1]]}},series:[{name:"种养面积分布",data:n}]})}catch(t){console.log("后台没有数据，错误被抛出！",t)}return t.$nextTick(function(){t.pSDScroll.refresh()}),!0}})}},components:{freetekBox:i.default,mappart:n.default}},p=a("W5g0");var u=function(t){a("P1Dq")},m=Object(p.a)(d,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"title",rawName:"v-title"}],staticClass:"layout-container",attrs:{"data-title":"自然资源监管"}},[a("div",{staticClass:"item-container"},[a("div",{staticClass:"s-item-wrap"},[a("div",{staticClass:"_s-item-wrap"},[a("freetek-box",{attrs:{title:"用地类型分布"}},[a("div",{ref:"lTypeDis",staticClass:"pie-charts-container"})])],1)]),t._v(" "),a("div",{staticClass:"s-item-wrap"},[a("div",{staticClass:"_s-item-wrap"},[a("freetek-box",{attrs:{title:"用地类型明细"}},[a("div",{staticClass:"table-container"},[a("el-table",{ref:"landTypeDetails",attrs:{data:t.landTypeDetails,stripe:"",height:"100%",width:"100%"}},[a("el-table-column",{attrs:{prop:"landType",label:"用地类型"}}),t._v(" "),a("el-table-column",{attrs:{prop:"area","min-width":"116px",label:"面积（万亩）"}}),t._v(" "),a("el-table-column",{attrs:{prop:"numberOfPlots",label:"地块数"}})],1)],1)])],1)])]),t._v(" "),a("div",{staticClass:"b-item-wrap"},[a("div",{staticClass:"_b-item-wrap"},[a("freetek-box",{attrs:{title:"",size:"big"}},[t.gisdata?a("mappart",{attrs:{gisdata:t.gisdata,gisget:t.gisget}}):t._e()],1)],1)]),t._v(" "),a("div",{staticClass:"item-container"},[a("div",{staticClass:"s-item-wrap"},[a("div",{staticClass:"_s-item-wrap"},[a("freetek-box",{attrs:{title:"种养面积分布"}},[a("div",{ref:"pStandardDis",staticClass:"pie-charts-container"})])],1)]),t._v(" "),a("div",{staticClass:"s-item-wrap"},[a("div",{staticClass:"_s-item-wrap"},[a("freetek-box",{attrs:{title:"种养面积明细"}},[a("div",{staticClass:"table-container"},[a("el-table",{ref:"plantingStandardDetails",attrs:{data:t.plantingStandardDetails,stripe:"",height:"100%",width:"100%"}},[a("el-table-column",{attrs:{prop:"plantStandard",label:"种养品种"}}),t._v(" "),a("el-table-column",{attrs:{prop:"area","min-width":"116px",label:"面积（万亩）"}}),t._v(" "),a("el-table-column",{attrs:{prop:"numberOfPlots",label:"地块数"}})],1)],1)])],1)])])])},[],!1,u,"data-v-594059d0",null);e.default=m.exports},P1Dq:function(t,e){},XR6P:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("VCTt"),n=a("VKKs"),r=a("+Yef");function o(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function i(n,r){try{var o=e[n](r),s=o.value}catch(t){return void a(t)}if(!o.done)return Promise.resolve(s).then(function(t){i("next",t)},function(t){i("throw",t)});t(s)}("next")})}}var s={data:function(){return{areaid:"",map:null,allpolygon:[],bigpolygon:null,imageOverlay:null,mapId:"暂无遥感",mapType:0,tulistr:"",updatetime:void 0,polygonready:!1,pointLat:void 0,pointLng:void 0,gisName:"",mapZoom:13}},props:["gisdata","gisget"],mounted:function(){var t=this;this.setAreaId(),this.$nextTick(o(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(n.b)("landSource_mapId"),e.next=3,t._initMap("mapcon");case 3:0!==t.gisdata.length&&(t.mapId=t.gisdata.some(function(t){return t.id===a})?a:t.gisdata[0].id,t.selectChange(t.mapId));case 4:case"end":return e.stop()}},e,t)})))},methods:{_initMap:function(t){var e=this;return o(regeneratorRuntime.mark(function a(){var n;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(i.g)({areaId:r.a[e.areaid]||e.areaid,child:!1});case 2:n=a.sent,e.map=L.map(t,{center:[0,0],zoom:9,zoomSnap:.1,layers:[],zoomControl:!1,attributionControl:!1,dragging:!1,touchZoom:!1,scrollWheelZoom:!1,doubleClickZoom:!1,boxZoom:!1,tap:!1,keyboard:!1,maxZoom:21,minZoom:5}).on("click",function(t){var a=t.latlng;e.$router.push({path:"/home/plotlist",query:{lat:e.pointLat||a.lat,lng:e.pointLng||a.lng,mapId:e.mapId,mapType:e.mapType,mapZoom:e.mapZoom}})}).on("resize",function(){e.drawProvinceFn()}),e.drawPolygon(n.features),e.drawProvinceFn();case 6:case"end":return a.stop()}},a,e)}))()},drawPolygon:function(t){var e=this;t.forEach(function(t,a){e.allpolygon[a]=L.geoJSON(t,{style:function(){return{color:"#6fcbdf",fillColor:"#009cba",fillOpacity:.6,fillRule:"evenodd",className:"polygonbox",lineJoin:"miter",weight:1}}}).addTo(e.map)})},drawProvinceFn:function(){var t,e,i=[];this.allpolygon.forEach(function(t){var e=t.getBounds();i.push([e._southWest.lat,e._southWest.lng]),i.push([e._northEast.lat,e._northEast.lng])}),this.bigpolygon=L.polygon(i,{}).getBounds(),t=this.map.getBoundsZoom(this.bigpolygon),e=this.bigpolygon.getCenter(),this.map.setView(e,t),"130529"===this.areaid&&L.imageOverlay(a("s8Nf"),this.bigpolygon,{interactive:!0,zIndex:998}).addTo(this.map)},addRemoteImg:function(t){t?(this.togglePolygon(!1),this.imageOverlay?this.imageOverlay.setUrl(t):(this.imageOverlay=L.imageOverlay(t,this.bigpolygon,{interactive:!0,zIndex:999}),this.imageOverlay.addTo(this.map))):(this.togglePolygon(!0),this.imageOverlay.setUrl(""))},togglePolygon:function(t){this.allpolygon.forEach(function(e){e.setStyle({weight:t?1:0,fillOpacity:t?.3:0})})},setAreaId:function(){var t=Object(n.b)("govGovernmentSubjectVO");if(!t)return this.$router.replace({path:"/login"});switch(t.subjectLevel){case 1:this.areaid=t.provinceId;break;case 2:this.areaid=t.cityId;break;default:this.areaid=t.countyId}},selectChange:function(t){var e=this.gisdata.filter(function(e){return e.id===t})[0];if(!e)return!1;Object(n.c)("landSource_mapId",t),this.gisName=e.gisName,this.mapType=e.mapType,this.mapZoom=e.zoom,this.pointLat=e.pointLat,this.pointLng=e.pointLng,this.tulistr=e.demoImgUrl,this.updatetime=e.dataUpdateTime,this.addRemoteImg(e.gisImgUrl)}},watch:{},computed:{}},l=a("W5g0");var c=function(t){a("ck7X")},d=Object(l.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mapcontain"},[a("el-select",{class:[t.gisdata.length?"":"noopts"],attrs:{placeholder:"",disabled:!(t.gisdata.length>0)},on:{change:t.selectChange},scopedSlots:t._u([{key:"prefix",fn:function(){return[a("div",{staticClass:"select-input"},[t._v(t._s(t.gisName))])]},proxy:!0}]),model:{value:t.mapId,callback:function(e){t.mapId=e},expression:"mapId"}},t._l(t.gisdata,function(t){return a("el-option",{key:t.id,attrs:{label:t.gisName,value:t.id}})}),1),t._v(" "),a("div",{attrs:{id:"mapcon"}}),t._v(" "),a("div",{staticClass:"tuli"},[a("img",{attrs:{src:t.tulistr,alt:""}})]),t._v(" "),t.updatetime?a("div",{staticClass:"updatetime"},[t._v("数据更新时间："+t._s(t._f("znDateFormat")(t.updatetime,"yyyy.MM.dd")))]):t._e()],1)},[],!1,c,"data-v-3e03fca4",null);e.default=d.exports},ck7X:function(t,e){},s8Nf:function(t,e){t.exports="https://snkoudai.oss-cn-hangzhou.aliyuncs.com/goverment/static/img/julu_weixing.d38e03e.png"}});
//# sourceMappingURL=60.4ed10316e432e203f64d.js.map