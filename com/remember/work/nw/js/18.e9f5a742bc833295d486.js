webpackJsonp([18],{rPva:function(e,t){},v061:function(e,t){},vlZk:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("mOB5"),i=a("mYEk"),n=a("44dg"),o=a("ItLx"),l=a("8BiH"),s=a("yivU"),u=a("Yz8N"),c=a("ae5q"),d=a("3VJJ"),h=a("CgIA"),p=a("VCTt"),f=a("VKKs"),g=(a("oAV5"),a("N/DY"));function m(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function r(i,n){try{var o=t[i](n),l=o.value}catch(e){return void a(e)}if(!o.done)return Promise.resolve(l).then(function(e){r("next",e)},function(e){r("throw",e)});e(l)}("next")})}}var v={props:{isHeaderShow:{type:Boolean,default:!0},isSearchShow:{type:Boolean,default:!0},hideColumn:{type:Object,default:function(){return{}}},minWidth:{type:String,default:"1366px"},minHeight:{type:String,default:"696px"},height:{type:String,default:"100vh"},defaultPageSize:{type:Number,default:15},isPageShow:{type:Boolean,default:!0},farmAreaInfo:{type:Object,default:function(){return Object(p.b)()}}},data:function(){return{currentPage:1,pageSize:15,total:1,keyword:"",areaItem:{areaName:"全部区",id:""},area:[{areaName:"全部区",id:""}],dateValue:"",lawSuperviseList:[],checkTypeMap:["未知","日常巡查","三品一标"],checkNameMap:[{index:100,text:"全部考核结果"},{index:1,text:"优"},{index:2,text:"良"},{index:3,text:"合格"},{index:4,text:"不合格"}],checkNameValue:100,tableHeight:0,sortDirection:1,sortField:0,dateDefaultSort:"descending",patrolValueDefaultSort:"none",regulatoryVisible:!1,patrolRecordId:"",dialogTitle:"",loading:!1,excelLoading:!1,isModalShow:!1,isRunBall:!1,isAddNum:!1}},created:function(){"{}"!==JSON.stringify(this.$route.query)&&(this.checkNameValue=this.$route.query.patrolResult?parseInt(this.$route.query.patrolResult):100,this.dateValue={startTime:this.$route.query.startTimeStr?this.formatDate(parseInt(this.$route.query.startTimeStr),"-"):"",endTime:this.$route.query.endTimeStr?this.formatDate(parseInt(this.$route.query.endTimeStr),"-"):""}),this.pageSize=this.defaultPageSize,this.getLawSuperviseList(),this.getArea()},computed:{getLevel:function(){return 2===Object(f.b)("govGovernmentSubjectVO").subjectLevel&&"310100"===Object(f.b)("govGovernmentSubjectVO").cityId}},mounted:function(){var e=this;this.$nextTick(function(){e.tableHeight=e.$refs.listContent.offsetHeight}),window.addEventListener("resize",this.resizeHandle,!1)},methods:{back:function(){var e=this,t=this.$route.path;this.$router.go(-1),setTimeout(function(){t===e.$route.path&&e.back()},200)},rowClick:function(e){this.isHeaderShow||(this.regulatoryVisible=!0,this.patrolRecordId=e.patrolRecordID,this.dialogTitle=e.cname)},download:function(){var e=this;return m(regeneratorRuntime.mark(function t(){var a,r,i,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.lawSuperviseList.length){t.next=3;break}return e.$message({type:"info",message:"暂无数据，无法导出",center:!0}),t.abrupt("return");case 3:return e.excelLoading=!0,a=Object(p.b)(),r=Object(f.b)("govGovernmentUserVO"),i={farmAreaId:e.areaItem.id?[e.areaItem.id]:[a.farmAreaId],farmAreaType:e.areaItem.level?e.areaItem.level:a.farmAreaType,endTimeStr:e.dateValue.endTime?e.dateValue.endTime:"",startTimeStr:e.dateValue.startTime?e.dateValue.startTime:"",keyword:e.keyword?e.keyword:null,patrolResult:null!==e.checkNameValue&&100!==e.checkNameValue?e.checkNameValue:null,sortDirection:e.sortDirection,sortField:e.sortField,govUserId:r.id},t.next=9,e.$ajax.post(e.$api.downloadExcel.lawExportByAreatoTask,i);case 9:n=t.sent,e.excelLoading=!1,0===n.data.respCode&&(e.isAddNum&&(e.isAddNum=!1),e.isRunBall=!0,setTimeout(function(){e.isRunBall=!1,e.isAddNum=!0},800)),300===n.data.respCode&&(e.isModalShow=!0);case 13:case"end":return t.stop()}},t,e)}))()},onChange:function(e){this.currentPage=e,this.getLawSuperviseList()},changePageSize:function(e){this.pageSize=e,this.currentPage=1,this.getLawSuperviseList()},clickAndEnter:function(){this.currentPage=1,this.getLawSuperviseList()},dateChange:function(){this.currentPage=1,this.getLawSuperviseList()},patrolResultChange:function(){this.currentPage=1,this.getLawSuperviseList()},sortChange:function(e){if(this.currentPage=1,"date"===e.prop){if("none"===this.dateDefaultSort)return this.patrolValueDefaultSort="none",this.dateDefaultSort="descending",this.sortField=0,this.sortDirection=1,void this.getLawSuperviseList();this.sortField=0,this.sortDirection="descending"===e.order?1:0}if("patrolValue"===e.prop){if("none"===this.patrolValueDefaultSort)return this.dateDefaultSort="none",this.patrolValueDefaultSort="descending",this.sortField=1,this.sortDirection=1,void this.getLawSuperviseList();this.sortField=1,this.sortDirection="descending"===e.order?1:0}this.getLawSuperviseList()},areaChange:function(){this.currentPage=1,this.getLawSuperviseList()},handleEdit:function(e){this.regulatoryVisible=!0,this.patrolRecordId=e.patrolRecordID,this.dialogTitle=e.cname},getLawSuperviseList:function(){var e=this;return m(regeneratorRuntime.mark(function t(){var a,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.lawSuperviseList=[],e.loading=!0,a=Object(p.b)(),!e.isHeaderShow&&e.farmAreaInfo.farmAreaId&&(e.areaItem.id=e.farmAreaInfo.farmAreaId,e.areaItem.level=e.farmAreaInfo.farmAreaType),r={farmAreaId:e.areaItem.id?[e.areaItem.id]:[a.farmAreaId],farmAreaType:e.areaItem.level?e.areaItem.level:a.farmAreaType,endTimeStr:e.dateValue.endTime?e.dateValue.endTime:"",startTimeStr:e.dateValue.startTime?e.dateValue.startTime:"",keyword:e.keyword?e.keyword:null,pageNo:e.currentPage,pageSize:e.pageSize,patrolResult:null!==e.checkNameValue&&100!==e.checkNameValue?e.checkNameValue:null,sortDirection:e.sortDirection,sortField:e.sortField},t.next=7,e.$ajax.post(e.$api.govPatrol.lawSuperviseList,r);case 7:0===(i=t.sent).data.respCode?(e.loading=!1,e.lawSuperviseList=i.data.obj.list,e.total=i.data.obj.totalCount,e.$nextTick(function(){e.tableHeight=e.$refs.listContent.offsetHeight,e.backTop()})):e.loading=!1;case 9:case"end":return t.stop()}},t,e)}))()},getArea:function(){var e=this;return m(regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$ajax.post(e.$api.area.listByParentId,{parentId:Object(f.b)("govGovernmentSubjectVO").cityId});case 2:0===(a=t.sent).data.respCode&&a.data.obj.list.forEach(function(t){"310100"===Object(f.b)("govGovernmentSubjectVO").cityId&&g.c.filterArea.filter(function(e){return t.id===e.id}).length||e.area.push(t)});case 4:case"end":return t.stop()}},t,e)}))()},getColor:function(e){switch(e){case 0:return"#ABC0D2";case 1:return"#3CCA42";case 2:return"#CAD640";case 3:return"#CAA207";case 4:return"#FF5252"}},formatDate:function(e,t){var a=new Date(e);return a.getFullYear()+t+((a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+t)+(a.getDate()<10?"0"+a.getDate():a.getDate())},resizeHandle:function(){this.tableHeight=this.$refs.listContent.offsetHeight},backTop:function(){document.querySelector(".el-table__body-wrapper").scrollTop=0}},destroyed:function(){window.removeEventListener("resize",this.resizeHandle,!1)},components:{Nav:r.default,Page:i.default,Loading:n.default,CustomInput:o.default,CustomSelect:l.default,CustomTable:s.default,CustomDatePicker:u.default,CustomTableSort:c.default,lawSuperviseDialog:function(){return Promise.all([a.e(0),a.e(3)]).then(a.bind(null,"Zn09"))},downloadModal:d.default,RunBall:h.default}},S=a("W5g0");var w=function(e){a("rPva"),a("v061")},b=Object(S.a)(v,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"title",rawName:"v-title"},{name:"loading",rawName:"v-loading",value:e.excelLoading,expression:"excelLoading"}],staticClass:"law-supervise",style:{minWidth:e.minWidth,height:e.height,minHeight:e.minHeight},attrs:{"data-title":e.isHeaderShow?"安全监管明细":"农业总览","element-loading-text":"导出中...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.5)"}},[e.isHeaderShow?r("Nav",{attrs:{title:"安全监管明细",hasShadow:!0,backColor:"#B6CFDE",paddingRight:"13px",isUserCenter:!0,isAddNum:e.isAddNum},on:{back:e.back}}):e._e(),e._v(" "),r("div",{staticClass:"main"},[e.isSearchShow?r("div",{staticClass:"search-box"},[r("div",{staticClass:"search-box-left"},[r("CustomDatePicker",{attrs:{margin:"0 15px 0 0",clearable:!!e.dateValue.startTime},on:{change:e.dateChange},model:{value:e.dateValue,callback:function(t){e.dateValue=t},expression:"dateValue"}}),e._v(" "),r("CustomSelect",{attrs:{margin:"0 15px 0 0"}},[r("template",{slot:"select-container"},[r("el-select",{attrs:{placeholder:"选择考核结果"},on:{change:e.patrolResultChange},model:{value:e.checkNameValue,callback:function(t){e.checkNameValue=t},expression:"checkNameValue"}},e._l(e.checkNameMap,function(e,t){return r("el-option",{key:t,attrs:{label:e.text,value:e.index}})}),1)],1)],2),e._v(" "),e.getLevel?r("CustomSelect",{attrs:{margin:"0 15px 0 0"}},[r("template",{slot:"select-container"},[r("el-select",{attrs:{placeholder:"全部区","value-key":"id"},on:{change:e.areaChange},model:{value:e.areaItem,callback:function(t){e.areaItem=t},expression:"areaItem"}},e._l(e.area,function(e){return r("el-option",{key:e.id,attrs:{label:e.areaName,value:e}})}),1)],1)],2):e._e(),e._v(" "),r("CustomInput",{attrs:{iconfont:"el-icon-search",placeholder:"输入经营主体名称搜索"},on:{clickAndEnter:e.clickAndEnter},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),e._v(" "),r("div",{staticClass:"excel-box"},[r("div",{staticClass:"excel",on:{click:e.download}},[r("img",{attrs:{src:a("zqrc")}}),e._v(" "),r("span",{staticStyle:{"margin-left":"9px"}},[e._v("导出EXCEL")])])])]):e._e(),e._v(" "),r("div",{ref:"listContent",staticClass:"list-content"},[r("CustomTable",[r("template",{slot:"table-container"},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.lawSuperviseList,fit:!0,height:e.tableHeight,lazy:!0},on:{"row-click":e.rowClick}},[r("template",{slot:"empty"},[r("div",[r("Loading",{attrs:{show:e.loading,type:"element",theme:"loader-light"}}),e._v(" "),e.loading?e._e():r("div",{staticClass:"no-data"},[r("img",{attrs:{src:a("gtDs")}}),e._v(" "),r("span",[e._v("暂无数据")])])],1)]),e._v(" "),r("el-table-column",{scopedSlots:e._u([{key:"header",fn:function(t){return[r("CustomTableSort",{attrs:{title:"日期",defaultSort:e.dateDefaultSort,prop:"date"},on:{sortChange:e.sortChange}})]}},{key:"default",fn:function(t){return[r("span",{staticClass:"text"},[e._v(e._s(e.formatDate(t.row.createdDate,".")))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"经营主体名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticClass:"text-bold"},[e._v(e._s(t.row.cname))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"所在地"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticClass:"text"},[e._v(e._s(t.row.countyName)+"/"+e._s(t.row.town))])]}}])}),e._v(" "),e.hideColumn.patrolType?e._e():r("el-table-column",{attrs:{label:"类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticClass:"text"},[e._v(e._s(e.checkTypeMap[t.row.patrolType]))])]}}],null,!1,2847835605)}),e._v(" "),r("el-table-column",{attrs:{label:"考核得分"},scopedSlots:e._u([{key:"header",fn:function(t){return[r("CustomTableSort",{attrs:{title:"考核得分",defaultSort:e.patrolValueDefaultSort,prop:"patrolValue"},on:{sortChange:e.sortChange}})]}},{key:"default",fn:function(t){return[r("span",{staticClass:"value-text"},[e._v("\n\t\t\t\t\t\t\t\t\t"+e._s("未知"!==e.checkNameMap[0===t.row.patrolResult?5:t.row.patrolResult].text?t.row.patrolValue:"--")+"\n\t\t\t\t\t\t\t\t")])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"考核结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticClass:"patrol-text",style:{color:e.getColor(t.row.patrolResult)}},[e._v("\n\t\t\t\t\t\t\t\t\t"+e._s(e.checkNameMap[0===t.row.patrolResult?5:t.row.patrolResult].text)+"\n\t\t\t\t\t\t\t\t")])]}}])}),e._v(" "),e.hideColumn.handle?e._e():r("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticClass:"handle",on:{click:function(a){return e.handleEdit(t.row)}}},[r("i",{staticClass:"iconfont icon-xiangqing"}),e._v(" "),r("span",[e._v("详情")])])]}}],null,!1,1162681631)})],2)],1)],2)],1)]),e._v(" "),e.total>e.pageSize&&e.isPageShow?r("div",{staticClass:"page-box"},[r("Page",{attrs:{total:e.total,"page-size":e.pageSize,current:e.currentPage,isPageSizeShow:!0,isJumpShow:!0,isTotalShow:!0,perPage:15},on:{onChange:e.onChange,changePageSize:e.changePageSize}})],1):e._e(),e._v(" "),e.regulatoryVisible?r("lawSuperviseDialog",{attrs:{regulatoryVisible:e.regulatoryVisible,patrolRecordId:e.patrolRecordId,title:e.dialogTitle},on:{"update:regulatoryVisible":function(t){e.regulatoryVisible=t},"update:regulatory-visible":function(t){e.regulatoryVisible=t}}}):e._e(),e._v(" "),r("RunBall",{attrs:{isRunBall:e.isRunBall}}),e._v(" "),r("downloadModal",{attrs:{isShow:e.isModalShow},on:{"update:isShow":function(t){e.isModalShow=t},"update:is-show":function(t){e.isModalShow=t}}})],1)},[],!1,w,"data-v-0ce067e4",null);t.default=b.exports}});
//# sourceMappingURL=18.e9f5a742bc833295d486.js.map