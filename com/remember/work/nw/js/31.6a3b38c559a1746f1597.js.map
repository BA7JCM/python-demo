{"version":3,"file":"static/js/31.6a3b38c559a1746f1597.js","sources":["webpack:///src/components/overview/modules/gov-regulatory-1.vue"],"sourcesContent":["<template>\n\t<div class=\"gov-area-panel\">\n\t\t<area-panel area-title=\"安全监管\" @hand-sub-title=\"handle\">\n\t\t\t<ul class=\"panel-main block-ul\" slot=\"panelMain\">\n\t\t\t\t<li class=\"block-item\" v-for=\"(info, index) in infoData\" :key=\"index\">\n\t\t\t\t\t<div class=\"block-name\">\n\t\t\t\t\t\t<p class=\"b-name\">{{ info.name }}</p>\n\t\t\t\t\t\t<p class=\"s-name\">合格率</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"chart-wrap\">\n\t\t\t\t\t\t<div class=\"echarts-container\" :ref=\"`EContainer${index}`\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"block-info\">\n\t\t\t\t\t\t<p class=\"info-line\" @click=\"handleDetail({startTimeStr: info.startTimeStr, endTimeStr: info.endTimeStr})\">\n\t\t\t\t\t\t\t监管次数：\n\t\t\t\t\t\t\t<span class=\"special-des\">{{ info.totalTimes }}</span>\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p class=\"info-line\" @click=\"handleDetail({patrolResult: '4', startTimeStr: info.startTimeStr, endTimeStr: info.endTimeStr})\">\n\t\t\t\t\t\t\t不合格次数：\n\t\t\t\t\t\t\t<span class=\"special-des\" :class=\"[info.unqualifiedTimes === 0 ? 'normal' : 'warn']\">{{ info.unqualifiedTimes }}</span>\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</area-panel>\n\t</div>\n</template>\n\n<script>\nimport areaPanel from '@/components/overview/area-panel';\nimport {areaLevelCorAreaId, maxDecimalPlaces} from '@/common/fn';\n\n// echarts 超级变量含义 {a} series.name, {b} data.name {c} data.value {d} data%\nconst liquidfillOpt = {\n\tseries: [\n\t\t{\n\t\t\tcenter: ['50%', '50%'],\n\t\t\ttype: 'liquidFill',\n\t\t\tradius: '86%',\n\t\t\tperiod(value, index) {\n\t\t\t\t// This function is called four times, each for a data item in series.\n\t\t\t\t// `value` is 0.6, 0.5, 0.4, 0.3, and `index` is 0, 1, 2, 3.\n\t\t\t\treturn 2000 * index + 2000; // 加的值越大波浪速度越慢\n\t\t\t}, // 可以控制波浪速度\n\t\t\tdata: [0],\n\t\t\tanimationEasing: 'linear',\n\t\t\tanimationEasingUpdate: 'linear',\n\t\t\tanimationDuration: 2000, // 水面升起速度\n\t\t\tanimationDurationUpdate: 1000,\n\t\t\tbackgroundStyle: {\n\t\t\t\tborderWidth: 0,\n\t\t\t\tcolor: '#033250'\n\t\t\t},\n\t\t\toutline: {\n\t\t\t\tshow: true,\n\t\t\t\tborderDistance: 4,\n\t\t\t\titemStyle: {\n\t\t\t\t\tcolor: 'none',\n\t\t\t\t\tborderColor: '#3CC8FF',\n\t\t\t\t\tborderWidth: 1\n\t\t\t\t}\n\t\t\t},\n\t\t\t// color: ['#00F6FF'],\n\t\t\titemStyle: {\n\t\t\t\tcolor: {\n\t\t\t\t\ttype: 'linear',\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0,\n\t\t\t\t\tx2: 0,\n\t\t\t\t\ty2: 1,\n\t\t\t\t\tcolorStops: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\toffset: 0,\n\t\t\t\t\t\t\tcolor: '#00F6FF' // 0% 处的颜色\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\toffset: 1,\n\t\t\t\t\t\t\tcolor: '#01C0FF' // 100% 处的颜色\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tglobal: false // 缺省为 false\n\t\t\t\t},\n\t\t\t\topacity: 1\n\t\t\t},\n\t\t\temphasis: {\n\t\t\t\titemStyle: {\n\t\t\t\t\topacity: 1\n\t\t\t\t}\n\t\t\t},\n\t\t\tlabel: {\n\t\t\t\tinsideColor: '#040E22', // 水面填充后 字的颜色\n\t\t\t\tshadowBlur: 1,\n\t\t\t\tshadowColor: '#00F6FF',\n\t\t\t\tfontSize: 14,\n\t\t\t\tcolor: '#A6CCD0',\n\t\t\t\tfontWeight: 'bold'\n\t\t\t},\n\t\t\tchartsInstance: null\n\t\t}\n\t]\n};\nexport default {\n\tname: 'gov-regulatory-1',\n\tprops: {\n\t\tfarmAreaInfo: {\n\t\t\ttype: Object,\n\t\t\tdefault() {\n\t\t\t\treturn areaLevelCorAreaId();\n\t\t\t}\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\t// 总数据列表\n\t\t\tinfoData: [\n\t\t\t\t{\n\t\t\t\t\tname: '昨日',\n\t\t\t\t\ttotalTimes: 0,\n\t\t\t\t\tunqualifiedTimes: 0,\n\t\t\t\t\tpassRate: 0,\n\t\t\t\t\tstartTimeStr: '',\n\t\t\t\t\tendTimeStr: ''\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: '本月',\n\t\t\t\t\ttotalTimes: 0,\n\t\t\t\t\tunqualifiedTimes: 0,\n\t\t\t\t\tpassRate: 0,\n\t\t\t\t\tstartTimeStr: '',\n\t\t\t\t\tendTimeStr: ''\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: '本年',\n\t\t\t\t\ttotalTimes: 0,\n\t\t\t\t\tunqualifiedTimes: 0,\n\t\t\t\t\tpassRate: 0,\n\t\t\t\t\tstartTimeStr: '',\n\t\t\t\t\tendTimeStr: ''\n\t\t\t\t}\n\t\t\t],\n\t\t\tchartsInstance: null,\n\t\t\tserverTime: null\n\t\t};\n\t},\n\tmounted() {\n\t\tthis.$nextTick(() => {\n\t\t\tthis.initMoudle();\n\t\t});\n\t},\n\tmethods: {\n\t\tinitMoudle() {\n\t\t\tif ($(window).width() > 3000) {\n\t\t\t\tliquidfillOpt.series[0].label.fontSize = 20;\n\t\t\t}\n\t\t\tthis.refreshChart(\n\t\t\t\tthis.infoData.map((info, index) => {\n\t\t\t\t\treturn this._initEcharts(this.$refs[`EContainer${index}`][0], liquidfillOpt);\n\t\t\t\t})\n\t\t\t);\n\t\t},\n\t\trefreshRender() {\n\t\t\tif (this.chartsInstance) {\n\t\t\t\tthis.chartsInstance.forEach(chart => {\n\t\t\t\t\tchart.resize();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t// 执法监管\n\t\tgetPatrolRecordStatisticsByArea() {\n\t\t\treturn this.$ajax\n\t\t\t\t.post(this.$api.overview.getPatrolRecord, {\n\t\t\t\t\tfarmAreaId: [this.farmAreaInfo.farmAreaId],\n\t\t\t\t\tfarmAreaType: this.farmAreaInfo.farmAreaType\n\t\t\t\t})\n\t\t\t\t.then(({data}) => {\n\t\t\t\t\tthis.serverTime = data.curDate;\n\t\t\t\t\tif (data.respCode === 0) {\n\t\t\t\t\t\treturn data.obj;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(e => {\n\t\t\t\t\tconsole.log(new Error('执法监管error'), e);\n\t\t\t\t});\n\t\t},\n\t\t_initEcharts(el, option) {\n\t\t\tconst chart = this.$echarts.init(el);\n\t\t\tchart.setOption(option);\n\t\t\treturn chart;\n\t\t},\n\t\tasync refreshChart(chartsInstance) {\n\t\t\tconst keyMap = ['yesterday', 'month', 'year'];\n\t\t\tconst res = await this.getPatrolRecordStatisticsByArea();\n\t\t\tconst that = this;\n\t\t\tthis.infoData.forEach((info, index) => {\n\t\t\t\tlet sTime = null;\n\t\t\t\tlet eTime = null;\n\t\t\t\tswitch (index) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\tsTime = eTime = new Date(this.serverTime).setDate(new Date(this.serverTime).getDate() - 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tsTime = new Date(this.serverTime).setDate(1);\n\t\t\t\t\t\teTime = new Date(new Date(this.serverTime).setMonth(new Date(this.serverTime).getMonth() + 1)).setDate(0);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tsTime = new Date(this.serverTime).setMonth(0, 1);\n\t\t\t\t\t\teTime = new Date(this.serverTime).setMonth(11, 31);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tinfo.startTimeStr = sTime;\n\t\t\t\tinfo.endTimeStr = eTime;\n\t\t\t\tinfo.totalTimes = res[`${keyMap[index]}PatrolTotalCount`];\n\t\t\t\tinfo.unqualifiedTimes = res[`${keyMap[index]}PatrolUnqualifiedCount`];\n\t\t\t\tinfo.passRate = info.totalTimes === 0 ? 0 : 1 - info.unqualifiedTimes / info.totalTimes;\n\t\t\t});\n\t\t\tchartsInstance.forEach((chart, index) => {\n\t\t\t\tchart.setOption({\n\t\t\t\t\tseries: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: {\n\t\t\t\t\t\t\t\tformatter(info) {\n\t\t\t\t\t\t\t\t\tif (that.infoData[index].totalTimes === 0) return '--';\n\t\t\t\t\t\t\t\t\tconst vStr = String(info.value * 100);\n\t\t\t\t\t\t\t\t\tconst vStrSplit = vStr.split('.');\n\t\t\t\t\t\t\t\t\tif (vStrSplit.length > 1) {\n\t\t\t\t\t\t\t\t\t\tvStrSplit[1] = vStrSplit[1].slice(0, 1);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn `${maxDecimalPlaces({\n\t\t\t\t\t\t\t\t\t\tvalue: Number(vStrSplit.join('.'))\n\t\t\t\t\t\t\t\t\t})}%`;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tdata: [this.infoData[index].passRate]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t});\n\t\t\t});\n\t\t\tthis.chartsInstance = chartsInstance;\n\t\t},\n\t\thandleDetail(query) {\n\t\t\tif (!this.serverTime) return false;\n\t\t\tthis.$router.push({\n\t\t\t\tname: 'lawSuperviseList',\n\t\t\t\tquery\n\t\t\t});\n\t\t},\n\t\thandle() {\n\t\t\tthis.$emit('handleClick', 'lawSuperviseList', '安全监管');\n\t\t}\n\t},\n\tcomponents: {\n\t\tareaPanel\n\t}\n};\n</script>\n\n<style scoped lang=\"less\">\n.gov-area-panel {\n\twidth: 100%;\n\theight: 100%;\n\tbackground-color: fade(#061f36, 34%);\n\t.block-ul {\n\t\tmargin-top: 5px;\n\t\tpadding: 0 10px 15px 30px;\n\t\tbox-sizing: border-box;\n\t\theight: 100%;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\t.block-item {\n\t\t\tbox-sizing: border-box;\n\t\t\t/*height: 80px;*/\n\t\t\twidth: 100%;\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tflex: 1;\n\t\t\tjustify-content: center;\n\t\t\t+ .block-item {\n\t\t\t\tborder-top: 1px solid #0c1f3e;\n\t\t\t}\n\t\t\t.block-name {\n\t\t\t\twidth: 17%;\n\t\t\t\tmin-width: 72px;\n\t\t\t\t/*margin-right: 28px;*/\n\t\t\t\tfont-weight: bold;\n\t\t\t\t.b-name {\n\t\t\t\t\tline-height: 25px;\n\t\t\t\t\tfont-size: 18px;\n\t\t\t\t\tcolor: #00f1fa;\n\t\t\t\t}\n\t\t\t\t.s-name {\n\t\t\t\t\tfont-size: 14px;\n\t\t\t\t\tline-height: 25px;\n\t\t\t\t\tcolor: #6dc1cb;\n\t\t\t\t}\n\t\t\t}\n\t\t\t.chart-wrap {\n\t\t\t\twidth: 24%;\n\t\t\t\tmin-width: 100px;\n\t\t\t\tdisplay: flex;\n\t\t\t\tjustify-content: center;\n\t\t\t\talign-items: center;\n\t\t\t\theight: 100%;\n\t\t\t\t.echarts-container {\n\t\t\t\t\twidth: 95%;\n\t\t\t\t\theight: 95%;\n\t\t\t\t\tmin-width: 70px;\n\t\t\t\t\tmin-height: 70px;\n\t\t\t\t\tmargin-left: -20%;\n\t\t\t\t\t/*margin-right: 30px;*/\n\t\t\t\t}\n\t\t\t}\n\t\t\t.block-info {\n\t\t\t\twidth: 30%;\n\t\t\t\t/*padding-left: 5%;*/\n\t\t\t\tbox-sizing: border-box;\n\t\t\t\tmin-width: 120px;\n\t\t\t\t.info-line {\n\t\t\t\t\tfont-size: 14px;\n\t\t\t\t\tline-height: 25px;\n\t\t\t\t\tcolor: #6dc1cb;\n\t\t\t\t\tfont-weight: 400;\n\t\t\t\t\tcursor: pointer;\n\t\t\t\t\t.special-des {\n\t\t\t\t\t\ttext-decoration-line: underline;\n\t\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\t\t&.normal {\n\t\t\t\t\t\t\tcolor: #39d186;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t&.warn {\n\t\t\t\t\t\t\tcolor: #fed239;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n@media screen and (max-width: 1500px) {\n\t.gov-area-panel .block-ul .block-item .block-name {\n\t\tmin-width: 44px;\n\t}\n\t.gov-area-panel .block-ul .block-item .block-info {\n\t\tmin-width: 117px;\n\t}\n}\n/* 32:9超宽屏幕适配 */\n@media screen and (min-width: 3000px) {\n\t.gov-area-panel .block-ul .block-item .block-name .b-name {\n\t\tline-height: 38px;\n\t\tfont-size: 25px;\n\t}\n\t.gov-area-panel .block-ul .block-item .block-name .s-name {\n\t\tfont-size: 15px;\n\t}\n\t.gov-area-panel .block-ul .block-item .block-info .info-line {\n\t\tfont-size: 20px;\n\t\tline-height: 28px;\n\t}\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/overview/modules/gov-regulatory-1.vue"],"mappings":"AAiCA","sourceRoot":""}