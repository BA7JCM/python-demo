{"version":3,"file":"static/js/24.3ebd30e2426eadecf915.js","sources":["webpack:///src/components/overview/modules/argi-materials-trend-14.vue"],"sourcesContent":["<template>\n\t<div class=\"gov-area-panel\" v-loading=\"loading\" element-loading-spinner=\"iconfont icon-loading1\" element-loading-background=\"rgba(0, 0, 0, 0.2)\">\n\t\t<area-panel area-title=\"农资使用趋势\">\n\t\t\t<div class=\"sub-title head-sub-title\" slot=\"subTitle\">近6个月</div>\n\t\t\t<div slot=\"panelMain\" class=\"echart-container\" ref=\"EContainer\"></div>\n\t\t</area-panel>\n\t</div>\n</template>\n\n<script>\nimport areaPanel from '@/components/overview/area-panel';\nimport {areaLevelCorAreaId, getIntervalTime, unitTranslate} from '@/common/fn';\nimport {getStorage} from '@/utils/storage';\n\nconst xData = [];\nconst govGovernmentSubjectVO = getStorage('govGovernmentSubjectVO');\n// echarts 超级变量含义 {a} series.name, {b} data.name {c} data.value {d} data%\nconst lineOption = {\n\ttitle: {\n\t\tshow: false,\n\t\ttext: '暂无数据',\n\t\ttextStyle: {\n\t\t\tfontSize: 12,\n\t\t\tcolor: '#6DC1CB'\n\t\t},\n\t\tleft: 'center',\n\t\ttop: 'center'\n\t},\n\tgrid: {\n\t\tshow: false,\n\t\tborderColor: '#0D394A',\n\t\tbottom: 40,\n\t\ttop: 40,\n\t\tleft: '13%',\n\t\tright: '13%'\n\t\t// height: '65%'\n\t},\n\ttooltip: {\n\t\tshow: true,\n\t\ttrigger: 'axis',\n\t\tformatter(value) {\n\t\t\tconst s = value.map(item => {\n\t\t\t\tvar u = item.seriesName === '肥料' ? '吨' : '千克';\n\t\t\t\treturn item.value !== null ? `${item.seriesName}：${unitTranslate({value: item.value, unit: '', base: 1, places: 3}).formatter} ${u}` : '';\n\t\t\t});\n\n\t\t\treturn `${value[0].axisValue}<br/>${s.join('<br />')}`;\n\t\t},\n\t\tbackgroundColor: '#043250',\n\t\tpadding: [13, 14, 13, 11],\n\t\ttextStyle: {\n\t\t\tfontSize: 12,\n\t\t\tcolor: '#9ED2D8'\n\t\t}\n\t},\n\tlegend: {\n\t\tshow: true,\n\t\ttype: 'plain',\n\t\ttextStyle: {\n\t\t\tcolor: '#6DC1CB',\n\t\t\tfontSize: 12\n\t\t},\n\t\tbackgroundColor: 'rgba(255, 255, 255, 0)',\n\t\ttop: 6,\n\t\titemWidth: 30,\n\t\titemHeight: 10,\n\t\theight: 20,\n\t\tdata: [\n\t\t\t{\n\t\t\t\tname: '肥料',\n\t\t\t\ticon: `image://${require('images/prevYears.png')}`\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: '农药',\n\t\t\t\ticon: `image://${require('images/curYears.png')}`\n\t\t\t}\n\t\t]\n\t},\n\txAxis: {\n\t\tdata: xData,\n\t\tboundaryGap: false,\n\t\taxisLabel: {\n\t\t\ttextStyle: {\n\t\t\t\tcolor: '#6DC1CB',\n\t\t\t\tfontSize: 12\n\t\t\t},\n\t\t\talign: 'center'\n\t\t},\n\t\taxisTick: {\n\t\t\tshow: false\n\t\t},\n\t\taxisLine: {\n\t\t\tshow: true,\n\t\t\tlineStyle: {\n\t\t\t\t// color: '#0D394A'\n\t\t\t\tcolor: 'rgba(109,193,203,0.2)'\n\t\t\t}\n\t\t},\n\t\tz: 10\n\t},\n\tyAxis: [\n\t\t{\n\t\t\tname: '(吨)',\n\t\t\tposition: 'left',\n\t\t\tmin: 0,\n\t\t\tsplitNumber: 5,\n\t\t\tnameTextStyle: {\n\t\t\t\tfontSize: 12,\n\t\t\t\tcolor: '#6DC1CB',\n\t\t\t\tpadding: [3, 25, 2, 0]\n\t\t\t},\n\t\t\taxisLine: {\n\t\t\t\tshow: false,\n\t\t\t\tlineStyle: {\n\t\t\t\t\tcolor: '#0D394A'\n\t\t\t\t}\n\t\t\t},\n\t\t\taxisTick: {\n\t\t\t\tshow: false\n\t\t\t},\n\t\t\tsplitLine: {\n\t\t\t\tshow: true,\n\t\t\t\tlineStyle: {\n\t\t\t\t\t// color: '#0D394A'\n\t\t\t\t\tcolor: 'rgba(109,193,203,0.2)'\n\t\t\t\t}\n\t\t\t},\n\t\t\taxisLabel: {\n\t\t\t\ttextStyle: {\n\t\t\t\t\tcolor: '#6DC1CB',\n\t\t\t\t\tfontSize: 12\n\t\t\t\t},\n\t\t\t\tformatter: function(value) {\n\t\t\t\t\t// var str = unitTranslate({ value, unit: '', base: 1 }).formatter;\n\t\t\t\t\t// var unit = '';\n\t\t\t\t\t// if (str.indexOf('万') !== -1 || str.indexOf('亿') !== -1) {\n\t\t\t\t\t//   unit = str.slice(-1);\n\t\t\t\t\t// }\n\t\t\t\t\t// return Math.ceil(parseFloat(str)) + unit;\n\t\t\t\t\treturn unitTranslate({value, unit: '', base: 1, places: 1}).formatter;\n\t\t\t\t},\n\t\t\t\tmargin: 2\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tname: '(千克)',\n\t\t\tposition: 'right',\n\t\t\tmin: 0,\n\t\t\tsplitNumber: 5,\n\t\t\tnameTextStyle: {\n\t\t\t\tfontSize: 12,\n\t\t\t\tcolor: '#6DC1CB',\n\t\t\t\tpadding: [3, 0, 2, 10]\n\t\t\t},\n\t\t\taxisLine: {\n\t\t\t\tshow: false,\n\t\t\t\tlineStyle: {\n\t\t\t\t\tcolor: '#0D394A'\n\t\t\t\t}\n\t\t\t},\n\t\t\taxisTick: {\n\t\t\t\tshow: false\n\t\t\t},\n\t\t\tsplitLine: {\n\t\t\t\tshow: true,\n\t\t\t\tlineStyle: {\n\t\t\t\t\t// color: '#0D394A'\n\t\t\t\t\tcolor: 'rgba(109,193,203,0.2)'\n\t\t\t\t}\n\t\t\t},\n\t\t\taxisLabel: {\n\t\t\t\ttextStyle: {\n\t\t\t\t\tcolor: '#6DC1CB',\n\t\t\t\t\tfontSize: 12\n\t\t\t\t},\n\t\t\t\tformatter: function(value) {\n\t\t\t\t\t// var str = unitTranslate({ value, unit: '', base: 1 }).formatter;\n\t\t\t\t\t// var unit = '';\n\t\t\t\t\t// if (str.indexOf('万') !== -1 || str.indexOf('亿') !== -1) {\n\t\t\t\t\t//   unit = str.slice(-1);\n\t\t\t\t\t// }\n\t\t\t\t\t// return Math.ceil(parseFloat(str)) + unit;\n\t\t\t\t\treturn unitTranslate({value, unit: '', base: 1, places: 1}).formatter;\n\t\t\t\t},\n\t\t\t\tmargin: 2\n\t\t\t}\n\t\t}\n\t],\n\tseries: [\n\t\t{\n\t\t\tname: '肥料',\n\t\t\tdata: [],\n\t\t\ttype: 'line',\n\t\t\tyAxisIndex: 0,\n\t\t\tsymbol: 'circle',\n\t\t\tsymbolSize: 5,\n\t\t\tareaStyle: {\n\t\t\t\tcolor: {\n\t\t\t\t\ttype: 'linear',\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0,\n\t\t\t\t\tx2: 0,\n\t\t\t\t\ty2: 1,\n\t\t\t\t\tcolorStops: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\toffset: 0,\n\t\t\t\t\t\t\tcolor: 'rgba(0, 162, 255, 0.5)' // 0% 处的颜色\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\toffset: 1,\n\t\t\t\t\t\t\tcolor: 'rgba(60, 105, 217, 0)' // 100% 处的颜色\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tglobal: false // 缺省为 false\n\t\t\t\t}\n\t\t\t},\n\t\t\tlineStyle: {\n\t\t\t\tcolor: '#32CEBC'\n\t\t\t},\n\t\t\titemStyle: {\n\t\t\t\tcolor: '#32CEBC'\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tname: '农药',\n\t\t\tdata: [],\n\t\t\ttype: 'line',\n\t\t\tyAxisIndex: 1,\n\t\t\tsymbol: 'circle',\n\t\t\tsymbolSize: 5,\n\t\t\tareaStyle: {\n\t\t\t\tcolor: {\n\t\t\t\t\ttype: 'linear',\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0,\n\t\t\t\t\tx2: 0,\n\t\t\t\t\ty2: 1,\n\t\t\t\t\tcolorStops: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\toffset: 0,\n\t\t\t\t\t\t\tcolor: 'rgba(212, 167, 84, 0.5)' // 0% 处的颜色\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\toffset: 1,\n\t\t\t\t\t\t\tcolor: 'rgba(212, 167, 84, 0)' // 100% 处的颜色\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tglobal: false // 缺省为 false\n\t\t\t\t}\n\t\t\t},\n\t\t\tlineStyle: {\n\t\t\t\tcolor: '#D4A452'\n\t\t\t},\n\t\t\titemStyle: {\n\t\t\t\tcolor: '#D4A452'\n\t\t\t}\n\t\t}\n\t]\n};\nexport default {\n\tname: 'argi-materials-trend-14',\n\tprops: {\n\t\tfarmAreaInfo: {\n\t\t\ttype: Object,\n\t\t\tdefault() {\n\t\t\t\treturn areaLevelCorAreaId();\n\t\t\t}\n\t\t},\n\t\tdataTargetFlag: {\n\t\t\ttype: Number,\n\t\t\tdefault() {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\t// 农资走势chart\n\t\t\tchartsInstance: null,\n\t\t\t// loading\n\t\t\tloading: false,\n\t\t\tstartTimeStr: ''\n\t\t};\n\t},\n\tmounted() {\n\t\tthis.initMoudle();\n\t},\n\tmethods: {\n\t\tinitMoudle() {\n\t\t\treturn new Promise(async resolve => {\n\t\t\t\tthis.loading = true;\n\t\t\t\tthis.chartsInstance = this._initEcharts(this.eContainerRef, lineOption);\n\t\t\t\tvar [result, [farmAreaId, farmAreaType]] = await this.getListByAreaAndMonth(this.farmAreaInfo.farmAreaId, this.farmAreaInfo.farmAreaType);\n\t\t\t\tthis.loading = false;\n\t\t\t\tif (!result) return resolve(false);\n\t\t\t\tif (farmAreaId !== this.farmAreaInfo.farmAreaId || farmAreaType !== this.farmAreaInfo.farmAreaType) return resolve(false);\n\t\t\t\tthis.renderChartfn(this.chartsInstance, result);\n\t\t\t\tresolve(true);\n\t\t\t});\n\t\t},\n\t\trefreshRender() {\n\t\t\tif (this.chartsInstance) {\n\t\t\t\tthis.chartsInstance.resize();\n\t\t\t}\n\t\t},\n\t\t_initEcharts(el, option) {\n\t\t\tconst chart = this.$echarts.init(el);\n\t\t\tchart.setOption(option);\n\t\t\treturn chart;\n\t\t},\n\t\t// 获取农资使用情况\n\t\tgetListByAreaAndMonth(farmAreaId, farmAreaType) {\n\t\t\tthis.startTimeStr = this._beforeSixMonthStart();\n\t\t\tconst dateList = getIntervalTime({\n\t\t\t\tstartTime: this.startTimeStr,\n\t\t\t\thowMonth: 6\n\t\t\t});\n\t\t\tvar args = arguments;\n\t\t\treturn this.$ajax\n\t\t\t\t.post(this.$api.overview.getListByAreaAndMonth, {\n\t\t\t\t\tfarmAreaId: [farmAreaId],\n\t\t\t\t\tfarmAreaType: farmAreaType,\n\t\t\t\t\tdateListStr: dateList,\n\t\t\t\t\tdataTargetFlag: this.dataTargetFlag\n\t\t\t\t})\n\t\t\t\t.then(({data}) => {\n\t\t\t\t\tif (data.respCode === 0) {\n\t\t\t\t\t\treturn [data.obj, [...args]];\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn [null, [...args]];\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(e => {\n\t\t\t\t\tconsole.log('农资使用趋势数据 error: ', e);\n\t\t\t\t});\n\t\t},\n\t\trenderChartfn(chartsInstance, dataList) {\n\t\t\t// x 轴月份数据\n\t\t\tvar xData = this._getxAxisData(this.startTimeStr);\n\t\t\t//  肥料数据\n\t\t\tvar leftData = dataList.fertList.map(item => {\n\t\t\t\treturn item.totalAmount;\n\t\t\t});\n\t\t\tvar leftMax = Math.max(...leftData) || 1;\n\t\t\t// 农药数据\n\t\t\tvar rightData = dataList.pestList.map(item => {\n\t\t\t\treturn item.totalAmount;\n\t\t\t});\n\t\t\tvar rightMax = Math.max(...rightData) || 1;\n\t\t\tchartsInstance.setOption({\n\t\t\t\txAxis: {\n\t\t\t\t\tdata: xData.map(item => String(item) + '月')\n\t\t\t\t},\n\t\t\t\tyAxis: [\n\t\t\t\t\t{\n\t\t\t\t\t\tmax: leftMax,\n\t\t\t\t\t\tinterval: leftMax / 5\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tmax: rightMax,\n\t\t\t\t\t\tinterval: rightMax / 5\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tseries: [\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: leftData\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: rightData\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t});\n\t\t},\n\t\t// 获取6个月前的开始日期 yyyy-MM-dd（不包含当前月）\n\t\t_beforeSixMonthStart() {\n\t\t\tvar curYear = new Date().getFullYear();\n\t\t\tvar curMonth = new Date().getMonth() + 1;\n\t\t\tvar startYear, startMonth;\n\t\t\tif (curMonth < 6) {\n\t\t\t\tstartYear = curYear - 1;\n\t\t\t\tstartMonth = 6 + curMonth;\n\t\t\t} else {\n\t\t\t\tstartYear = curYear;\n\t\t\t\tstartMonth = curMonth - 6;\n\t\t\t}\n\t\t\treturn `${startYear}-${startMonth}-01`;\n\t\t},\n\t\t// 根据开始时间字符，生成 x 轴月份数组\n\t\t_getxAxisData(startTimeStr) {\n\t\t\tvar xData = [];\n\t\t\tvar startMonth = startTimeStr.split('-')[1];\n\t\t\t// '05' => 5\n\t\t\tstartMonth = startMonth.indexOf('0') === 0 ? parseInt(startMonth.slice(1)) : parseInt(startMonth);\n\t\t\tfor (let i = 0; i < 6; i++) {\n\t\t\t\txData.push(startMonth + i);\n\t\t\t}\n\t\t\treturn xData;\n\t\t}\n\t},\n\tcomputed: {\n\t\teContainerRef() {\n\t\t\treturn this.$refs.EContainer;\n\t\t}\n\t},\n\tcomponents: {\n\t\tareaPanel\n\t}\n};\n</script>\n\n<style scoped lang=\"scss\">\n@import '~styles/selectSkin_default';\n\n.gov-area-panel {\n\twidth: 100%;\n\theight: 100%;\n\tbackground-color: rgba(6, 31, 54, 0.34);\n\t/deep/ .el-loading-spinner {\n\t\toverflow: hidden;\n\t\t.iconfont {\n\t\t\tdisplay: block;\n\t\t\tline-height: 60px;\n\t\t\tfont-size: 40px;\n\t\t\tcolor: #00f6ff;\n\t\t\tanimation: loading 1.25s linear infinite;\n\t\t\tmargin-top: 5px;\n\t\t\tmargin-left: 8px;\n\t\t}\n\t}\n\t.echart-container {\n\t\theight: 100%;\n\t}\n\t.sub-title {\n\t\tcolor: #02a2ad;\n\t\tfont-size: 14px;\n\t}\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/overview/modules/argi-materials-trend-14.vue"],"mappings":"AAeA","sourceRoot":""}