{"version":3,"file":"static/js/38.455b5b765fe39e864b8a.js","sources":["webpack:///src/components/overview/modules/operators-num-13.vue"],"sourcesContent":["<template>\n\t<div class=\"gov-area-panel\">\n\t\t<area-panel area-title=\"经营主体统计\" @hand-sub-title=\"handlePage\">\n\t\t\t<div class=\"panel-main\" slot=\"panelMain\" ref=\"panel\">\n\t\t\t\t<div class=\"top-container\">\n\t\t\t\t\t<div class=\"title\" :style=\"{fontSize: smallFont + 'px'}\">经营主体总数</div>\n\t\t\t\t\t<div class=\"all-nums\">\n\t\t\t\t\t\t<count-to :iSize=\"iSize\" :startVal=\"0\" :endVal=\"count\" :multiLen=\"0\" :duration=\"1000\" noBgStyle></count-to>\n\t\t\t\t\t\t<span :style=\"{fontSize: smallFont + 'px'}\" class=\"unit\">家</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"echart-container\">\n\t\t\t\t\t<div v-for=\"(info, index) in infoData\" :key=\"index\" :class=\"'box' + index\">\n\t\t\t\t\t\t<div class=\"echart-item\" :ref=\"'EContainer' + index\"></div>\n\t\t\t\t\t\t<div class=\"label\">\n\t\t\t\t\t\t\t<div class=\"item-num\">\n\t\t\t\t\t\t\t\t<span :style=\"{fontSize: bigFont + 'px'}\">{{ info.sysValue }}</span>\n\t\t\t\t\t\t\t\t<span :style=\"{fontSize: smallFont + 'px'}\" class=\"unit\">家</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div :style=\"{fontSize: smallFont + 'px'}\" class=\"item-desc\">占比 {{ info.percentage }}%</div>\n\t\t\t\t\t\t\t<div :style=\"{fontSize: smallFont + 'px'}\" class=\"item-type\">{{ info.sysName }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</area-panel>\n\t</div>\n</template>\n\n<script>\nimport areaPanel from '@/components/overview/area-panel';\nimport countTo from '@/components/common/countTo';\nimport {areaLevelCorAreaId, maxDecimalPlaces} from '@/common/fn';\nimport {getStorage} from '@/utils/storage';\nconst govGovernmentSubjectVO = getStorage('govGovernmentSubjectVO');\nvar options = {\n\tangleAxis: {\n\t\tshow: false,\n\t\tmax: (100 * 360) / 230,\n\t\ttype: 'value',\n\t\tstartAngle: 205, // 极坐标初始角度\n\t\tsplitLine: {\n\t\t\tshow: false\n\t\t}\n\t},\n\tradiusAxis: {\n\t\tshow: false,\n\t\ttype: 'category'\n\t},\n\t// 圆环位置和大小\n\tpolar: {\n\t\tcenter: ['50%', '50%'],\n\t\tradius: '162%'\n\t},\n\ttooltip: {\n\t\tshow: true,\n\t\ttrigger: 'item'\n\t},\n\tseries: [\n\t\t{\n\t\t\ttype: 'bar',\n\t\t\tdata: [\n\t\t\t\t{\n\t\t\t\t\t// 上层圆环，显示数据\n\t\t\t\t\tvalue: 0.1,\n\t\t\t\t\titemStyle: {\n\t\t\t\t\t\tcolor: {\n\t\t\t\t\t\t\ttype: 'linear',\n\t\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\t\ty: 0,\n\t\t\t\t\t\t\tx2: 0,\n\t\t\t\t\t\t\ty2: 1,\n\t\t\t\t\t\t\tcolorStops: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\toffset: 0,\n\t\t\t\t\t\t\t\t\tcolor: '#3AC468' // 0% 处的颜色\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\toffset: 1,\n\t\t\t\t\t\t\t\t\tcolor: '#43FDAC' // 100% 处的颜色\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t],\n\t\t\tbarWidth: 8,\n\t\t\tbarGap: '-100%', // 柱间距离,上下两层圆环重合\n\t\t\tcoordinateSystem: 'polar',\n\t\t\troundCap: true, // 顶端圆角\n\t\t\ttooltip: {\n\t\t\t\tshow: false,\n\t\t\t\tposition: 'right'\n\t\t\t},\n\t\t\tz: 2\n\t\t},\n\t\t{\n\t\t\t// 下层圆环，显示最大值\n\t\t\ttype: 'bar',\n\t\t\tdata: [\n\t\t\t\t{\n\t\t\t\t\tvalue: 100,\n\t\t\t\t\titemStyle: {\n\t\t\t\t\t\tcolor: '#033250'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t],\n\t\t\tbarWidth: 8,\n\t\t\tbarGap: '-100%',\n\t\t\tcoordinateSystem: 'polar',\n\t\t\troundCap: true,\n\t\t\tz: 1,\n\t\t\ttooltip: {\n\t\t\t\tshow: false,\n\t\t\t\tposition: 'bottom'\n\t\t\t}\n\t\t}\n\t]\n};\nexport default {\n\tname: 'operators-num-13',\n\tprops: {\n\t\tfarmAreaInfo: {\n\t\t\ttype: Object,\n\t\t\tdefault() {\n\t\t\t\treturn areaLevelCorAreaId();\n\t\t\t}\n\t\t},\n\t\tdataTargetFlag: {\n\t\t\ttype: Number,\n\t\t\tdefault() {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t},\n\tcomponents: {\n\t\tareaPanel,\n\t\tcountTo\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tcount: 0, // 总数\n\t\t\tiSize: 32,\n\t\t\tsmallFont: 14,\n\t\t\tbigFont: 25,\n\t\t\tinfoData: [\n\t\t\t\t{\n\t\t\t\t\tsysName: '神农口袋',\n\t\t\t\t\tsysValue: 0,\n\t\t\t\t\tpercentage: 0\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tsysName: '种植业管理系统',\n\t\t\t\t\tsysValue: 0,\n\t\t\t\t\tpercentage: 0\n\t\t\t\t}\n\t\t\t],\n\t\t\tchartsInstances: null //echart 实例数组\n\t\t};\n\t},\n\tmounted() {\n\t\tthis.$nextTick(() => {\n\t\t\tthis.initMoudle();\n\t\t});\n\t},\n\tmethods: {\n\t\tasync initMoudle() {\n\t\t\tthis.chartsInstances = this.infoData.map((info, index) => {\n\t\t\t\treturn this._initEcharts(this.$refs[`EContainer${index}`][0], options);\n\t\t\t});\n\t\t\tvar [result, [farmAreaId, farmAreaType]] = await this.getFarmCount(this.farmAreaInfo.farmAreaId, this.farmAreaInfo.farmAreaType);\n\t\t\tif (!result) return;\n\t\t\tif (farmAreaId !== this.farmAreaInfo.farmAreaId || farmAreaType !== this.farmAreaInfo.farmAreaType) return;\n\t\t\t//数据处理\n\t\t\tvar {count, vos} = result;\n\t\t\tthis.count = count;\n\t\t\tvos.forEach((item, index) => {\n\t\t\t\tvar val = item.sysValue === 0 ? 0 : item.sysValue / count;\n\t\t\t\tvar percentage = maxDecimalPlaces({value: val * 100, places: 1});\n\t\t\t\tvar currentInfo = Object.assign({}, item, {percentage});\n\t\t\t\tthis.infoData[index] = currentInfo;\n\t\t\t});\n\t\t\t//更新echart\n\t\t\tthis.setChartfn(this.chartsInstances, this.infoData, this.count);\n\t\t\tthis.adaptationChart();\n\t\t},\n\t\trefreshRender() {\n\t\t\tif (this.chartsInstances) {\n\t\t\t\tthis.chartsInstances.forEach(chart => {\n\t\t\t\t\tchart.resize();\n\t\t\t\t});\n\t\t\t\tthis.adaptationChart();\n\t\t\t}\n\t\t},\n\t\thandlePage() {\n\t\t\t// this.$router.push({path: '/operateSubjectList'});\n\t\t\tthis.$emit('handleClick', 'operateSubjectList', '经营主体统计');\n\t\t},\n\t\t_initEcharts(el, option) {\n\t\t\tconst chart = this.$echarts.init(el);\n\t\t\tchart.setOption(option);\n\t\t\treturn chart;\n\t\t},\n\t\tasync setChartfn(chartsInstances, dataObj, count) {\n\t\t\tchartsInstances.forEach((chart, idx) => {\n\t\t\t\tchartsInstances[idx].setOption({\n\t\t\t\t\tangleAxis: {\n\t\t\t\t\t\tmax: count === 0 ? (100 * 360) / 230 : (count * 360) / 230\n\t\t\t\t\t},\n\t\t\t\t\tseries: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: dataObj[idx].sysName,\n\t\t\t\t\t\t\tdata: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tvalue: dataObj[idx].sysValue,\n\t\t\t\t\t\t\t\t\titemStyle: {\n\t\t\t\t\t\t\t\t\t\tcolor: {\n\t\t\t\t\t\t\t\t\t\t\ttype: 'linear',\n\t\t\t\t\t\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\t\t\t\t\t\ty: 0,\n\t\t\t\t\t\t\t\t\t\t\tx2: 0,\n\t\t\t\t\t\t\t\t\t\t\ty2: 1,\n\t\t\t\t\t\t\t\t\t\t\tcolorStops: [\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\toffset: 0,\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor: '#3AC468' // 0% 处的颜色\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\toffset: 1,\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor: '#43FDAC' // 100% 处的颜色\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdata: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tvalue: count === 0 ? 100 : count\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tgetFarmCount(farmAreaId, farmAreaType) {\n\t\t\tlet args = arguments;\n\t\t\treturn this.$ajax\n\t\t\t\t.post(this.$api.overview.getFarmCount, {\n\t\t\t\t\tdataTargetFlag: govGovernmentSubjectVO.dataTargetFlag,\n\t\t\t\t\tfarmAreaId: [farmAreaId],\n\t\t\t\t\tfarmAreaType: farmAreaType\n\t\t\t\t})\n\t\t\t\t.then(({data}) => {\n\t\t\t\t\tif (data.respCode === 0) {\n\t\t\t\t\t\treturn [data.obj, [...args]];\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn [null, [...args]];\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(e => {\n\t\t\t\t\tconsole.log(new Error('经营主体统计error'), e);\n\t\t\t\t});\n\t\t},\n\t\tadaptationChart() {\n\t\t\tconst containerH = this.$refs.panel.clientHeight;\n\t\t\tthis.iSize = maxDecimalPlaces({\n\t\t\t\tvalue: containerH * 0.149,\n\t\t\t\tplaces: 0\n\t\t\t});\n\t\t\tthis.bigFont = maxDecimalPlaces({\n\t\t\t\tvalue: containerH * 0.1168,\n\t\t\t\tplaces: 0\n\t\t\t});\n\t\t\tthis.smallFont = maxDecimalPlaces({\n\t\t\t\tvalue: containerH * 0.0654,\n\t\t\t\tplaces: 0\n\t\t\t});\n\t\t}\n\t}\n};\n</script>\n\n<style scoped lang=\"less\">\n.gov-area-panel {\n\twidth: 100%;\n\theight: 100%;\n\tbackground-color: fade(#061f36, 34%);\n\t.panel-main {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\t.top-container {\n\t\t\twidth: 100%;\n\t\t\theight: 30%;\n\t\t}\n\t}\n\t.title {\n\t\twidth: 100%;\n\t\tfont-size: 14px;\n\t\tcolor: #6ec2cb;\n\t\ttext-align: center;\n\t\tmargin-bottom: 10px;\n\t}\n\t.all-nums {\n\t\tposition: relative;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: flex-end;\n\t\t/deep/ .count-to {\n\t\t\t.octagon {\n\t\t\t\twidth: 100%;\n\t\t\t\tmin-height: 35px;\n\t\t\t\theight: auto;\n\t\t\t\tpadding: 0;\n\t\t\t\t&.single {\n\t\t\t\t\t._octagon {\n\t\t\t\t\t\tline-height: normal;\n\t\t\t\t\t\t.iconfont {\n\t\t\t\t\t\t\t// height: 35px;\n\t\t\t\t\t\t\tfont-size: 32px;\n\t\t\t\t\t\t\tfont-weight: 400;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t.unit {\n\t\t\tmargin-bottom: 3px;\n\t\t\tfont-size: 14px;\n\t\t\tcolor: #00f6ff;\n\t\t}\n\t}\n\t.echart-container {\n\t\tposition: relative;\n\t\twidth: 100%;\n\t\theight: 65%;\n\t\tmargin-top: 5px;\n\t\t// border: 1px solid green;\n\t\tdisplay: flex;\n\t\t> div {\n\t\t\tposition: relative;\n\t\t\twidth: 50%;\n\t\t\theight: 100%;\n\t\t\t// border: 1px solid blue;\n\t\t\t&.box0 {\n\t\t\t\tposition: absolute;\n\t\t\t\tleft: 0;\n\t\t\t}\n\t\t\t&.box1 {\n\t\t\t\tposition: absolute;\n\t\t\t\tright: 0;\n\t\t\t}\n\t\t\t.echart-item {\n\t\t\t\tposition: relative;\n\t\t\t\twidth: 100%;\n\t\t\t\theight: 100%;\n\t\t\t\tmargin: 0 auto;\n\t\t\t}\n\t\t\t.label {\n\t\t\t\twidth: 100%;\n\t\t\t\tposition: absolute;\n\t\t\t\ttop: 50%;\n\t\t\t\tleft: 50%;\n\t\t\t\ttransform: translate(-50%, -50%);\n\t\t\t}\n\t\t}\n\t\t.item-num {\n\t\t\t// position: absolute;\n\t\t\t// top: 22%;\n\t\t\twidth: 100%;\n\t\t\tmargin-top: 15px;\n\t\t\tmargin-bottom: 5px;\n\t\t\tcolor: rgba(47, 228, 125, 1);\n\t\t\ttext-align: center;\n\t\t\tfont-size: 0;\n\t\t\tspan {\n\t\t\t\tfont-size: 25px;\n\t\t\t\t&.unit {\n\t\t\t\t\tfont-size: 14px;\n\t\t\t\t\tmargin-left: 4px;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t.item-desc {\n\t\t\t// position: absolute;\n\t\t\t// top: 50%;\n\t\t\twidth: 100%;\n\t\t\tfont-size: 14px;\n\t\t\tcolor: #108e92;\n\t\t\ttext-align: center;\n\t\t}\n\t\t.item-type {\n\t\t\t// position: absolute;\n\t\t\t// top: 75%;\n\t\t\twidth: 100%;\n\t\t\tmargin-top: 20px;\n\t\t\tfont-size: 14px;\n\t\t\ttext-align: center;\n\t\t\tcolor: #6ec2cb;\n\t\t}\n\t}\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/overview/modules/operators-num-13.vue"],"mappings":"AAkCA","sourceRoot":""}